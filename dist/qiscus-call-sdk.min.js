(function(e){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=e()}else if(typeof define==="function"&&define.amd){define([],e)}else{var t;if(typeof window!=="undefined"){t=window}else if(typeof global!=="undefined"){t=global}else if(typeof self!=="undefined"){t=self}else{t=this}t.QiscusCall=e()}})(function(){var T,e,t;return function(){function u(o,a,s){function c(r,e){if(!a[r]){if(!o[r]){var t="function"==typeof require&&require;if(!e&&t)return t(r,!0);if(f)return f(r,!0);var n=new Error("Cannot find module '"+r+"'");throw n.code="MODULE_NOT_FOUND",n}var i=a[r]={exports:{}};o[r][0].call(i.exports,function(e){var t=o[r][1][e];return c(t||e)},i,i.exports,u,o,a,s)}return a[r].exports}for(var f="function"==typeof require&&require,e=0;e<s.length;e++)c(s[e]);return c}return u}()({1:[function(e,t,r){t.exports=n;function n(e,r,n){var i=false;n=n||a;o.count=e;return e===0?r():o;function o(e,t){if(o.count<=0){throw new Error("after called too many times")}--o.count;if(e){i=true;r(e);r=n}else if(o.count===0&&!i){r(null,t)}}}function a(){}},{}],2:[function(e,t,r){t.exports=function(e,t,r){var n=e.byteLength;t=t||0;r=r||n;if(e.slice){return e.slice(t,r)}if(t<0){t+=n}if(r<0){r+=n}if(r>n){r=n}if(t>=n||t>=r||n===0){return new ArrayBuffer(0)}var i=new Uint8Array(e);var o=new Uint8Array(r-t);for(var a=t,s=0;a<r;a++,s++){o[s]=i[a]}return o.buffer}},{}],3:[function(e,t,r){t.exports=n;function n(e){e=e||{};this.ms=e.min||100;this.max=e.max||1e4;this.factor=e.factor||2;this.jitter=e.jitter>0&&e.jitter<=1?e.jitter:0;this.attempts=0}n.prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random();var r=Math.floor(t*this.jitter*e);e=(Math.floor(t*10)&1)==0?e-r:e+r}return Math.min(e,this.max)|0};n.prototype.reset=function(){this.attempts=0};n.prototype.setMin=function(e){this.ms=e};n.prototype.setMax=function(e){this.max=e};n.prototype.setJitter=function(e){this.jitter=e}},{}],4:[function(e,t,r){(function(){"use strict";var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var l=new Uint8Array(256);for(var e=0;e<o.length;e++){l[o.charCodeAt(e)]=e}r.encode=function(e){var t=new Uint8Array(e),r,n=t.length,i="";for(r=0;r<n;r+=3){i+=o[t[r]>>2];i+=o[(t[r]&3)<<4|t[r+1]>>4];i+=o[(t[r+1]&15)<<2|t[r+2]>>6];i+=o[t[r+2]&63]}if(n%3===2){i=i.substring(0,i.length-1)+"="}else if(n%3===1){i=i.substring(0,i.length-2)+"=="}return i};r.decode=function(e){var t=e.length*.75,r=e.length,n,i=0,o,a,s,c;if(e[e.length-1]==="="){t--;if(e[e.length-2]==="="){t--}}var f=new ArrayBuffer(t),u=new Uint8Array(f);for(n=0;n<r;n+=4){o=l[e.charCodeAt(n)];a=l[e.charCodeAt(n+1)];s=l[e.charCodeAt(n+2)];c=l[e.charCodeAt(n+3)];u[i++]=o<<2|a>>4;u[i++]=(a&15)<<4|s>>2;u[i++]=(s&3)<<6|c&63}return f}})()},{}],5:[function(e,t,r){"use strict";r.byteLength=a;r.toByteArray=s;r.fromByteArray=v;var c=[];var f=[];var u=typeof Uint8Array!=="undefined"?Uint8Array:Array;var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var i=0,o=n.length;i<o;++i){c[i]=n[i];f[n.charCodeAt(i)]=i}f["-".charCodeAt(0)]=62;f["_".charCodeAt(0)]=63;function l(e){var t=e.length;if(t%4>0){throw new Error("Invalid string. Length must be a multiple of 4")}var r=e.indexOf("=");if(r===-1)r=t;var n=r===t?0:4-r%4;return[r,n]}function a(e){var t=l(e);var r=t[0];var n=t[1];return(r+n)*3/4-n}function d(e,t,r){return(t+r)*3/4-r}function s(e){var t;var r=l(e);var n=r[0];var i=r[1];var o=new u(d(e,n,i));var a=0;var s=i>0?n-4:n;for(var c=0;c<s;c+=4){t=f[e.charCodeAt(c)]<<18|f[e.charCodeAt(c+1)]<<12|f[e.charCodeAt(c+2)]<<6|f[e.charCodeAt(c+3)];o[a++]=t>>16&255;o[a++]=t>>8&255;o[a++]=t&255}if(i===2){t=f[e.charCodeAt(c)]<<2|f[e.charCodeAt(c+1)]>>4;o[a++]=t&255}if(i===1){t=f[e.charCodeAt(c)]<<10|f[e.charCodeAt(c+1)]<<4|f[e.charCodeAt(c+2)]>>2;o[a++]=t>>8&255;o[a++]=t&255}return o}function p(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[e&63]}function h(e,t,r){var n;var i=[];for(var o=t;o<r;o+=3){n=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(e[o+2]&255);i.push(p(n))}return i.join("")}function v(e){var t;var r=e.length;var n=r%3;var i=[];var o=16383;for(var a=0,s=r-n;a<s;a+=o){i.push(h(e,a,a+o>s?s:a+o))}if(n===1){t=e[r-1];i.push(c[t>>2]+c[t<<4&63]+"==")}else if(n===2){t=(e[r-2]<<8)+e[r-1];i.push(c[t>>10]+c[t>>4&63]+c[t<<2&63]+"=")}return i.join("")}},{}],6:[function(e,c,t){(function(e){var i=e.BlobBuilder||e.WebKitBlobBuilder||e.MSBlobBuilder||e.MozBlobBuilder;var t=function(){try{var e=new Blob(["hi"]);return e.size===2}catch(e){return false}}();var r=t&&function(){try{var e=new Blob([new Uint8Array([1,2])]);return e.size===2}catch(e){return false}}();var n=i&&i.prototype.append&&i.prototype.getBlob;function o(e){for(var t=0;t<e.length;t++){var r=e[t];if(r.buffer instanceof ArrayBuffer){var n=r.buffer;if(r.byteLength!==n.byteLength){var i=new Uint8Array(r.byteLength);i.set(new Uint8Array(n,r.byteOffset,r.byteLength));n=i.buffer}e[t]=n}}}function a(e,t){t=t||{};var r=new i;o(e);for(var n=0;n<e.length;n++){r.append(e[n])}return t.type?r.getBlob(t.type):r.getBlob()}function s(e,t){o(e);return new Blob(e,t||{})}c.exports=function(){if(t){return r?e.Blob:s}else if(n){return a}else{return undefined}}()}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],7:[function(e,t,r){},{}],8:[function(e,t,n){"use strict";var i=e("base64-js");var o=e("ieee754");n.Buffer=d;n.SlowBuffer=y;n.INSPECT_MAX_BYTES=50;var r=2147483647;n.kMaxLength=r;d.TYPED_ARRAY_SUPPORT=a();if(!d.TYPED_ARRAY_SUPPORT&&typeof console!=="undefined"&&typeof console.error==="function"){console.error("This browser lacks typed array (Uint8Array) support which is required by "+"`buffer` v5.x. Use `buffer` v4.x if you require old browser support.")}function a(){try{var e=new Uint8Array(1);e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}};return e.foo()===42}catch(e){return false}}Object.defineProperty(d.prototype,"parent",{get:function(){if(!(this instanceof d)){return undefined}return this.buffer}});Object.defineProperty(d.prototype,"offset",{get:function(){if(!(this instanceof d)){return undefined}return this.byteOffset}});function s(e){if(e>r){throw new RangeError("Invalid typed array length")}var t=new Uint8Array(e);t.__proto__=d.prototype;return t}function d(e,t,r){if(typeof e==="number"){if(typeof t==="string"){throw new Error("If encoding is specified then the first argument must be a string")}return l(e)}return c(e,t,r)}if(typeof Symbol!=="undefined"&&Symbol.species&&d[Symbol.species]===d){Object.defineProperty(d,Symbol.species,{value:null,configurable:true,enumerable:false,writable:false})}d.poolSize=8192;function c(e,t,r){if(typeof e==="number"){throw new TypeError('"value" argument must not be a number')}if($(e)||e&&$(e.buffer)){return v(e,t,r)}if(typeof e==="string"){return p(e,t)}return m(e)}d.from=function(e,t,r){return c(e,t,r)};d.prototype.__proto__=Uint8Array.prototype;d.__proto__=Uint8Array;function f(e){if(typeof e!=="number"){throw new TypeError('"size" argument must be of type number')}else if(e<0){throw new RangeError('"size" argument must not be negative')}}function u(e,t,r){f(e);if(e<=0){return s(e)}if(t!==undefined){return typeof r==="string"?s(e).fill(t,r):s(e).fill(t)}return s(e)}d.alloc=function(e,t,r){return u(e,t,r)};function l(e){f(e);return s(e<0?0:g(e)|0)}d.allocUnsafe=function(e){return l(e)};d.allocUnsafeSlow=function(e){return l(e)};function p(e,t){if(typeof t!=="string"||t===""){t="utf8"}if(!d.isEncoding(t)){throw new TypeError("Unknown encoding: "+t)}var r=b(e,t)|0;var n=s(r);var i=n.write(e,t);if(i!==r){n=n.slice(0,i)}return n}function h(e){var t=e.length<0?0:g(e.length)|0;var r=s(t);for(var n=0;n<t;n+=1){r[n]=e[n]&255}return r}function v(e,t,r){if(t<0||e.byteLength<t){throw new RangeError('"offset" is outside of buffer bounds')}if(e.byteLength<t+(r||0)){throw new RangeError('"length" is outside of buffer bounds')}var n;if(t===undefined&&r===undefined){n=new Uint8Array(e)}else if(r===undefined){n=new Uint8Array(e,t)}else{n=new Uint8Array(e,t,r)}n.__proto__=d.prototype;return n}function m(e){if(d.isBuffer(e)){var t=g(e.length)|0;var r=s(t);if(r.length===0){return r}e.copy(r,0,0,t);return r}if(e){if(ArrayBuffer.isView(e)||"length"in e){if(typeof e.length!=="number"||Q(e.length)){return s(0)}return h(e)}if(e.type==="Buffer"&&Array.isArray(e.data)){return h(e.data)}}throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object.")}function g(e){if(e>=r){throw new RangeError("Attempt to allocate Buffer larger than maximum "+"size: 0x"+r.toString(16)+" bytes")}return e|0}function y(e){if(+e!=e){e=0}return d.alloc(+e)}d.isBuffer=function e(t){return t!=null&&t._isBuffer===true};d.compare=function e(t,r){if(!d.isBuffer(t)||!d.isBuffer(r)){throw new TypeError("Arguments must be Buffers")}if(t===r)return 0;var n=t.length;var i=r.length;for(var o=0,a=Math.min(n,i);o<a;++o){if(t[o]!==r[o]){n=t[o];i=r[o];break}}if(n<i)return-1;if(i<n)return 1;return 0};d.isEncoding=function e(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return true;default:return false}};d.concat=function e(t,r){if(!Array.isArray(t)){throw new TypeError('"list" argument must be an Array of Buffers')}if(t.length===0){return d.alloc(0)}var n;if(r===undefined){r=0;for(n=0;n<t.length;++n){r+=t[n].length}}var i=d.allocUnsafe(r);var o=0;for(n=0;n<t.length;++n){var a=t[n];if(ArrayBuffer.isView(a)){a=d.from(a)}if(!d.isBuffer(a)){throw new TypeError('"list" argument must be an Array of Buffers')}a.copy(i,o);o+=a.length}return i};function b(e,t){if(d.isBuffer(e)){return e.length}if(ArrayBuffer.isView(e)||$(e)){return e.byteLength}if(typeof e!=="string"){e=""+e}var r=e.length;if(r===0)return 0;var n=false;for(;;){switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case undefined:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(n)return J(e).length;t=(""+t).toLowerCase();n=true}}}d.byteLength=b;function w(e,t,r){var n=false;if(t===undefined||t<0){t=0}if(t>this.length){return""}if(r===undefined||r>this.length){r=this.length}if(r<=0){return""}r>>>=0;t>>>=0;if(r<=t){return""}if(!e)e="utf8";while(true){switch(e){case"hex":return j(this,t,r);case"utf8":case"utf-8":return O(this,t,r);case"ascii":return D(this,t,r);case"latin1":case"binary":return I(this,t,r);case"base64":return A(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase();n=true}}}d.prototype._isBuffer=true;function C(e,t,r){var n=e[t];e[t]=e[r];e[r]=n}d.prototype.swap16=function e(){var t=this.length;if(t%2!==0){throw new RangeError("Buffer size must be a multiple of 16-bits")}for(var r=0;r<t;r+=2){C(this,r,r+1)}return this};d.prototype.swap32=function e(){var t=this.length;if(t%4!==0){throw new RangeError("Buffer size must be a multiple of 32-bits")}for(var r=0;r<t;r+=4){C(this,r,r+3);C(this,r+1,r+2)}return this};d.prototype.swap64=function e(){var t=this.length;if(t%8!==0){throw new RangeError("Buffer size must be a multiple of 64-bits")}for(var r=0;r<t;r+=8){C(this,r,r+7);C(this,r+1,r+6);C(this,r+2,r+5);C(this,r+3,r+4)}return this};d.prototype.toString=function e(){var t=this.length;if(t===0)return"";if(arguments.length===0)return O(this,0,t);return w.apply(this,arguments)};d.prototype.toLocaleString=d.prototype.toString;d.prototype.equals=function e(t){if(!d.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(this===t)return true;return d.compare(this,t)===0};d.prototype.inspect=function e(){var t="";var r=n.INSPECT_MAX_BYTES;if(this.length>0){t=this.toString("hex",0,r).match(/.{2}/g).join(" ");if(this.length>r)t+=" ... "}return"<Buffer "+t+">"};d.prototype.compare=function e(t,r,n,i,o){if(!d.isBuffer(t)){throw new TypeError("Argument must be a Buffer")}if(r===undefined){r=0}if(n===undefined){n=t?t.length:0}if(i===undefined){i=0}if(o===undefined){o=this.length}if(r<0||n>t.length||i<0||o>this.length){throw new RangeError("out of range index")}if(i>=o&&r>=n){return 0}if(i>=o){return-1}if(r>=n){return 1}r>>>=0;n>>>=0;i>>>=0;o>>>=0;if(this===t)return 0;var a=o-i;var s=n-r;var c=Math.min(a,s);var f=this.slice(i,o);var u=t.slice(r,n);for(var l=0;l<c;++l){if(f[l]!==u[l]){a=f[l];s=u[l];break}}if(a<s)return-1;if(s<a)return 1;return 0};function _(e,t,r,n,i){if(e.length===0)return-1;if(typeof r==="string"){n=r;r=0}else if(r>2147483647){r=2147483647}else if(r<-2147483648){r=-2147483648}r=+r;if(Q(r)){r=i?0:e.length-1}if(r<0)r=e.length+r;if(r>=e.length){if(i)return-1;else r=e.length-1}else if(r<0){if(i)r=0;else return-1}if(typeof t==="string"){t=d.from(t,n)}if(d.isBuffer(t)){if(t.length===0){return-1}return S(e,t,r,n,i)}else if(typeof t==="number"){t=t&255;if(typeof Uint8Array.prototype.indexOf==="function"){if(i){return Uint8Array.prototype.indexOf.call(e,t,r)}else{return Uint8Array.prototype.lastIndexOf.call(e,t,r)}}return S(e,[t],r,n,i)}throw new TypeError("val must be string, number or Buffer")}function S(e,t,r,n,i){var o=1;var a=e.length;var s=t.length;if(n!==undefined){n=String(n).toLowerCase();if(n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le"){if(e.length<2||t.length<2){return-1}o=2;a/=2;s/=2;r/=2}}function c(e,t){if(o===1){return e[t]}else{return e.readUInt16BE(t*o)}}var f;if(i){var u=-1;for(f=r;f<a;f++){if(c(e,f)===c(t,u===-1?0:f-u)){if(u===-1)u=f;if(f-u+1===s)return u*o}else{if(u!==-1)f-=f-u;u=-1}}}else{if(r+s>a)r=a-s;for(f=r;f>=0;f--){var l=true;for(var d=0;d<s;d++){if(c(e,f+d)!==c(t,d)){l=false;break}}if(l)return f}}return-1}d.prototype.includes=function e(t,r,n){return this.indexOf(t,r,n)!==-1};d.prototype.indexOf=function e(t,r,n){return _(this,t,r,n,true)};d.prototype.lastIndexOf=function e(t,r,n){return _(this,t,r,n,false)};function T(e,t,r,n){r=Number(r)||0;var i=e.length-r;if(!n){n=i}else{n=Number(n);if(n>i){n=i}}var o=t.length;if(n>o/2){n=o/2}for(var a=0;a<n;++a){var s=parseInt(t.substr(a*2,2),16);if(Q(s))return a;e[r+a]=s}return a}function k(e,t,r,n){return K(J(t,e.length-r),e,r,n)}function E(e,t,r,n){return K(V(t),e,r,n)}function R(e,t,r,n){return E(e,t,r,n)}function x(e,t,r,n){return K(Y(t),e,r,n)}function P(e,t,r,n){return K(X(t,e.length-r),e,r,n)}d.prototype.write=function e(t,r,n,i){if(r===undefined){i="utf8";n=this.length;r=0}else if(n===undefined&&typeof r==="string"){i=r;n=this.length;r=0}else if(isFinite(r)){r=r>>>0;if(isFinite(n)){n=n>>>0;if(i===undefined)i="utf8"}else{i=n;n=undefined}}else{throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported")}var o=this.length-r;if(n===undefined||n>o)n=o;if(t.length>0&&(n<0||r<0)||r>this.length){throw new RangeError("Attempt to write outside buffer bounds")}if(!i)i="utf8";var a=false;for(;;){switch(i){case"hex":return T(this,t,r,n);case"utf8":case"utf-8":return k(this,t,r,n);case"ascii":return E(this,t,r,n);case"latin1":case"binary":return R(this,t,r,n);case"base64":return x(this,t,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,t,r,n);default:if(a)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase();a=true}}};d.prototype.toJSON=function e(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function A(e,t,r){if(t===0&&r===e.length){return i.fromByteArray(e)}else{return i.fromByteArray(e.slice(t,r))}}function O(e,t,r){r=Math.min(e.length,r);var n=[];var i=t;while(i<r){var o=e[i];var a=null;var s=o>239?4:o>223?3:o>191?2:1;if(i+s<=r){var c,f,u,l;switch(s){case 1:if(o<128){a=o}break;case 2:c=e[i+1];if((c&192)===128){l=(o&31)<<6|c&63;if(l>127){a=l}}break;case 3:c=e[i+1];f=e[i+2];if((c&192)===128&&(f&192)===128){l=(o&15)<<12|(c&63)<<6|f&63;if(l>2047&&(l<55296||l>57343)){a=l}}break;case 4:c=e[i+1];f=e[i+2];u=e[i+3];if((c&192)===128&&(f&192)===128&&(u&192)===128){l=(o&15)<<18|(c&63)<<12|(f&63)<<6|u&63;if(l>65535&&l<1114112){a=l}}}}if(a===null){a=65533;s=1}else if(a>65535){a-=65536;n.push(a>>>10&1023|55296);a=56320|a&1023}n.push(a);i+=s}return L(n)}var M=4096;function L(e){var t=e.length;if(t<=M){return String.fromCharCode.apply(String,e)}var r="";var n=0;while(n<t){r+=String.fromCharCode.apply(String,e.slice(n,n+=M))}return r}function D(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i]&127)}return n}function I(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i){n+=String.fromCharCode(e[i])}return n}function j(e,t,r){var n=e.length;if(!t||t<0)t=0;if(!r||r<0||r>n)r=n;var i="";for(var o=t;o<r;++o){i+=H(e[o])}return i}function N(e,t,r){var n=e.slice(t,r);var i="";for(var o=0;o<n.length;o+=2){i+=String.fromCharCode(n[o]+n[o+1]*256)}return i}d.prototype.slice=function e(t,r){var n=this.length;t=~~t;r=r===undefined?n:~~r;if(t<0){t+=n;if(t<0)t=0}else if(t>n){t=n}if(r<0){r+=n;if(r<0)r=0}else if(r>n){r=n}if(r<t)r=t;var i=this.subarray(t,r);i.__proto__=d.prototype;return i};function B(e,t,r){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}d.prototype.readUIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)B(t,r,this.length);var i=this[t];var o=1;var a=0;while(++a<r&&(o*=256)){i+=this[t+a]*o}return i};d.prototype.readUIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n){B(t,r,this.length)}var i=this[t+--r];var o=1;while(r>0&&(o*=256)){i+=this[t+--r]*o}return i};d.prototype.readUInt8=function e(t,r){t=t>>>0;if(!r)B(t,1,this.length);return this[t]};d.prototype.readUInt16LE=function e(t,r){t=t>>>0;if(!r)B(t,2,this.length);return this[t]|this[t+1]<<8};d.prototype.readUInt16BE=function e(t,r){t=t>>>0;if(!r)B(t,2,this.length);return this[t]<<8|this[t+1]};d.prototype.readUInt32LE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return(this[t]|this[t+1]<<8|this[t+2]<<16)+this[t+3]*16777216};d.prototype.readUInt32BE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return this[t]*16777216+(this[t+1]<<16|this[t+2]<<8|this[t+3])};d.prototype.readIntLE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)B(t,r,this.length);var i=this[t];var o=1;var a=0;while(++a<r&&(o*=256)){i+=this[t+a]*o}o*=128;if(i>=o)i-=Math.pow(2,8*r);return i};d.prototype.readIntBE=function e(t,r,n){t=t>>>0;r=r>>>0;if(!n)B(t,r,this.length);var i=r;var o=1;var a=this[t+--i];while(i>0&&(o*=256)){a+=this[t+--i]*o}o*=128;if(a>=o)a-=Math.pow(2,8*r);return a};d.prototype.readInt8=function e(t,r){t=t>>>0;if(!r)B(t,1,this.length);if(!(this[t]&128))return this[t];return(255-this[t]+1)*-1};d.prototype.readInt16LE=function e(t,r){t=t>>>0;if(!r)B(t,2,this.length);var n=this[t]|this[t+1]<<8;return n&32768?n|4294901760:n};d.prototype.readInt16BE=function e(t,r){t=t>>>0;if(!r)B(t,2,this.length);var n=this[t+1]|this[t]<<8;return n&32768?n|4294901760:n};d.prototype.readInt32LE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24};d.prototype.readInt32BE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]};d.prototype.readFloatLE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return o.read(this,t,true,23,4)};d.prototype.readFloatBE=function e(t,r){t=t>>>0;if(!r)B(t,4,this.length);return o.read(this,t,false,23,4)};d.prototype.readDoubleLE=function e(t,r){t=t>>>0;if(!r)B(t,8,this.length);return o.read(this,t,true,52,8)};d.prototype.readDoubleBE=function e(t,r){t=t>>>0;if(!r)B(t,8,this.length);return o.read(this,t,false,52,8)};function F(e,t,r,n,i,o){if(!d.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}d.prototype.writeUIntLE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;F(this,t,r,n,o,0)}var a=1;var s=0;this[r]=t&255;while(++s<n&&(a*=256)){this[r+s]=t/a&255}return r+n};d.prototype.writeUIntBE=function e(t,r,n,i){t=+t;r=r>>>0;n=n>>>0;if(!i){var o=Math.pow(2,8*n)-1;F(this,t,r,n,o,0)}var a=n-1;var s=1;this[r+a]=t&255;while(--a>=0&&(s*=256)){this[r+a]=t/s&255}return r+n};d.prototype.writeUInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,1,255,0);this[r]=t&255;return r+1};d.prototype.writeUInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,65535,0);this[r]=t&255;this[r+1]=t>>>8;return r+2};d.prototype.writeUInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,65535,0);this[r]=t>>>8;this[r+1]=t&255;return r+2};d.prototype.writeUInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,4294967295,0);this[r+3]=t>>>24;this[r+2]=t>>>16;this[r+1]=t>>>8;this[r]=t&255;return r+4};d.prototype.writeUInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,4294967295,0);this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};d.prototype.writeIntLE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);F(this,t,r,n,o-1,-o)}var a=0;var s=1;var c=0;this[r]=t&255;while(++a<n&&(s*=256)){if(t<0&&c===0&&this[r+a-1]!==0){c=1}this[r+a]=(t/s>>0)-c&255}return r+n};d.prototype.writeIntBE=function e(t,r,n,i){t=+t;r=r>>>0;if(!i){var o=Math.pow(2,8*n-1);F(this,t,r,n,o-1,-o)}var a=n-1;var s=1;var c=0;this[r+a]=t&255;while(--a>=0&&(s*=256)){if(t<0&&c===0&&this[r+a+1]!==0){c=1}this[r+a]=(t/s>>0)-c&255}return r+n};d.prototype.writeInt8=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,1,127,-128);if(t<0)t=255+t+1;this[r]=t&255;return r+1};d.prototype.writeInt16LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,32767,-32768);this[r]=t&255;this[r+1]=t>>>8;return r+2};d.prototype.writeInt16BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,2,32767,-32768);this[r]=t>>>8;this[r+1]=t&255;return r+2};d.prototype.writeInt32LE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,2147483647,-2147483648);this[r]=t&255;this[r+1]=t>>>8;this[r+2]=t>>>16;this[r+3]=t>>>24;return r+4};d.prototype.writeInt32BE=function e(t,r,n){t=+t;r=r>>>0;if(!n)F(this,t,r,4,2147483647,-2147483648);if(t<0)t=4294967295+t+1;this[r]=t>>>24;this[r+1]=t>>>16;this[r+2]=t>>>8;this[r+3]=t&255;return r+4};function U(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function q(e,t,r,n,i){t=+t;r=r>>>0;if(!i){U(e,t,r,4,34028234663852886e22,-34028234663852886e22)}o.write(e,t,r,n,23,4);return r+4}d.prototype.writeFloatLE=function e(t,r,n){return q(this,t,r,true,n)};d.prototype.writeFloatBE=function e(t,r,n){return q(this,t,r,false,n)};function z(e,t,r,n,i){t=+t;r=r>>>0;if(!i){U(e,t,r,8,17976931348623157e292,-17976931348623157e292)}o.write(e,t,r,n,52,8);return r+8}d.prototype.writeDoubleLE=function e(t,r,n){return z(this,t,r,true,n)};d.prototype.writeDoubleBE=function e(t,r,n){return z(this,t,r,false,n)};d.prototype.copy=function e(t,r,n,i){if(!d.isBuffer(t))throw new TypeError("argument should be a Buffer");if(!n)n=0;if(!i&&i!==0)i=this.length;if(r>=t.length)r=t.length;if(!r)r=0;if(i>0&&i<n)i=n;if(i===n)return 0;if(t.length===0||this.length===0)return 0;if(r<0){throw new RangeError("targetStart out of bounds")}if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");if(i>this.length)i=this.length;if(t.length-r<i-n){i=t.length-r+n}var o=i-n;if(this===t&&typeof Uint8Array.prototype.copyWithin==="function"){this.copyWithin(r,n,i)}else if(this===t&&n<r&&r<i){for(var a=o-1;a>=0;--a){t[a+r]=this[a+n]}}else{Uint8Array.prototype.set.call(t,this.subarray(n,i),r)}return o};d.prototype.fill=function e(t,r,n,i){if(typeof t==="string"){if(typeof r==="string"){i=r;r=0;n=this.length}else if(typeof n==="string"){i=n;n=this.length}if(i!==undefined&&typeof i!=="string"){throw new TypeError("encoding must be a string")}if(typeof i==="string"&&!d.isEncoding(i)){throw new TypeError("Unknown encoding: "+i)}if(t.length===1){var o=t.charCodeAt(0);if(i==="utf8"&&o<128||i==="latin1"){t=o}}}else if(typeof t==="number"){t=t&255}if(r<0||this.length<r||this.length<n){throw new RangeError("Out of range index")}if(n<=r){return this}r=r>>>0;n=n===undefined?this.length:n>>>0;if(!t)t=0;var a;if(typeof t==="number"){for(a=r;a<n;++a){this[a]=t}}else{var s=d.isBuffer(t)?t:new d(t,i);var c=s.length;if(c===0){throw new TypeError('The value "'+t+'" is invalid for argument "value"')}for(a=0;a<n-r;++a){this[a+r]=s[a%c]}}return this};var W=/[^+/0-9A-Za-z-_]/g;function G(e){e=e.split("=")[0];e=e.trim().replace(W,"");if(e.length<2)return"";while(e.length%4!==0){e=e+"="}return e}function H(e){if(e<16)return"0"+e.toString(16);return e.toString(16)}function J(e,t){t=t||Infinity;var r;var n=e.length;var i=null;var o=[];for(var a=0;a<n;++a){r=e.charCodeAt(a);if(r>55295&&r<57344){if(!i){if(r>56319){if((t-=3)>-1)o.push(239,191,189);continue}else if(a+1===n){if((t-=3)>-1)o.push(239,191,189);continue}i=r;continue}if(r<56320){if((t-=3)>-1)o.push(239,191,189);i=r;continue}r=(i-55296<<10|r-56320)+65536}else if(i){if((t-=3)>-1)o.push(239,191,189)}i=null;if(r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else{throw new Error("Invalid code point")}}return o}function V(e){var t=[];for(var r=0;r<e.length;++r){t.push(e.charCodeAt(r)&255)}return t}function X(e,t){var r,n,i;var o=[];for(var a=0;a<e.length;++a){if((t-=2)<0)break;r=e.charCodeAt(a);n=r>>8;i=r%256;o.push(i);o.push(n)}return o}function Y(e){return i.toByteArray(G(e))}function K(e,t,r,n){for(var i=0;i<n;++i){if(i+r>=t.length||i>=e.length)break;t[i+r]=e[i]}return i}function $(e){return e instanceof ArrayBuffer||e!=null&&e.constructor!=null&&e.constructor.name==="ArrayBuffer"&&typeof e.byteLength==="number"}function Q(e){return e!==e}},{"base64-js":5,ieee754:32}],9:[function(e,t,r){var n=[].slice;t.exports=function(e,t){if("string"==typeof t)t=e[t];if("function"!=typeof t)throw new Error("bind() requires a function");var r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}},{}],10:[function(e,t,r){if(typeof t!=="undefined"){t.exports=n}function n(e){if(e)return i(e)}function i(e){for(var t in n.prototype){e[t]=n.prototype[t]}return e}n.prototype.on=n.prototype.addEventListener=function(e,t){this._callbacks=this._callbacks||{};(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t);return this};n.prototype.once=function(e,t){function r(){this.off(e,r);t.apply(this,arguments)}r.fn=t;this.on(e,r);return this};n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(e,t){this._callbacks=this._callbacks||{};if(0==arguments.length){this._callbacks={};return this}var r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length){delete this._callbacks["$"+e];return this}var n;for(var i=0;i<r.length;i++){n=r[i];if(n===t||n.fn===t){r.splice(i,1);break}}return this};n.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks["$"+e];if(r){r=r.slice(0);for(var n=0,i=r.length;n<i;++n){r[n].apply(this,t)}}return this};n.prototype.listeners=function(e){this._callbacks=this._callbacks||{};return this._callbacks["$"+e]||[]};n.prototype.hasListeners=function(e){return!!this.listeners(e).length}},{}],11:[function(e,t,r){t.exports=function(e,t){var r=function(){};r.prototype=t.prototype;e.prototype=new r;e.prototype.constructor=e}},{}],12:[function(e,t,m){(function(e){function t(e){if(Array.isArray){return Array.isArray(e)}return v(e)==="[object Array]"}m.isArray=t;function r(e){return typeof e==="boolean"}m.isBoolean=r;function n(e){return e===null}m.isNull=n;function i(e){return e==null}m.isNullOrUndefined=i;function o(e){return typeof e==="number"}m.isNumber=o;function a(e){return typeof e==="string"}m.isString=a;function s(e){return typeof e==="symbol"}m.isSymbol=s;function c(e){return e===void 0}m.isUndefined=c;function f(e){return v(e)==="[object RegExp]"}m.isRegExp=f;function u(e){return typeof e==="object"&&e!==null}m.isObject=u;function l(e){return v(e)==="[object Date]"}m.isDate=l;function d(e){return v(e)==="[object Error]"||e instanceof Error}m.isError=d;function p(e){return typeof e==="function"}m.isFunction=p;function h(e){return e===null||typeof e==="boolean"||typeof e==="number"||typeof e==="string"||typeof e==="symbol"||typeof e==="undefined"}m.isPrimitive=h;m.isBuffer=e.isBuffer;function v(e){return Object.prototype.toString.call(e)}}).call(this,{isBuffer:e("../../is-buffer/index.js")})},{"../../is-buffer/index.js":35}],13:[function(s,c,f){(function(t){f=c.exports=s("./debug");f.log=n;f.formatArgs=r;f.save=i;f.load=o;f.useColors=e;f.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:a();f.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"];function e(){if(typeof window!=="undefined"&&window.process&&window.process.type==="renderer"){return true}if(typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)){return false}return typeof document!=="undefined"&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||typeof window!=="undefined"&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||typeof navigator!=="undefined"&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)}f.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}};function r(e){var t=this.useColors;e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+f.humanize(this.diff);if(!t)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var n=0;var i=0;e[0].replace(/%[a-zA-Z%]/g,function(e){if("%%"===e)return;n++;if("%c"===e){i=n}});e.splice(i,0,r)}function n(){return"object"===typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function i(e){try{if(null==e){f.storage.removeItem("debug")}else{f.storage.debug=e}}catch(e){}}function o(){var e;try{e=f.storage.debug}catch(e){}if(!e&&typeof t!=="undefined"&&"env"in t){e=t.env.DEBUG}return e}f.enable(o());function a(){try{return window.localStorage}catch(e){}}}).call(this,s("_process"))},{"./debug":14,_process:41}],14:[function(e,t,f){f=t.exports=n.debug=n["default"]=n;f.coerce=c;f.disable=a;f.enable=o;f.enabled=s;f.humanize=e("ms");f.instances=[];f.names=[];f.skips=[];f.formatters={};function r(e){var t=0,r;for(r in e){t=(t<<5)-t+e.charCodeAt(r);t|=0}return f.colors[Math.abs(t)%f.colors.length]}function n(e){var s;function c(){if(!c.enabled)return;var i=c;var e=+new Date;var t=e-(s||e);i.diff=t;i.prev=s;i.curr=e;s=e;var o=new Array(arguments.length);for(var r=0;r<o.length;r++){o[r]=arguments[r]}o[0]=f.coerce(o[0]);if("string"!==typeof o[0]){o.unshift("%O")}var a=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if(e==="%%")return e;a++;var r=f.formatters[t];if("function"===typeof r){var n=o[a];e=r.call(i,n);o.splice(a,1);a--}return e});f.formatArgs.call(i,o);var n=c.log||f.log||console.log.bind(console);n.apply(i,o)}c.namespace=e;c.enabled=f.enabled(e);c.useColors=f.useColors();c.color=r(e);c.destroy=i;if("function"===typeof f.init){f.init(c)}f.instances.push(c);return c}function i(){var e=f.instances.indexOf(this);if(e!==-1){f.instances.splice(e,1);return true}else{return false}}function o(e){f.save(e);f.names=[];f.skips=[];var t;var r=(typeof e==="string"?e:"").split(/[\s,]+/);var n=r.length;for(t=0;t<n;t++){if(!r[t])continue;e=r[t].replace(/\*/g,".*?");if(e[0]==="-"){f.skips.push(new RegExp("^"+e.substr(1)+"$"))}else{f.names.push(new RegExp("^"+e+"$"))}}for(t=0;t<f.instances.length;t++){var i=f.instances[t];i.enabled=f.enabled(i.namespace)}}function a(){f.enable("")}function s(e){if(e[e.length-1]==="*"){return true}var t,r;for(t=0,r=f.skips.length;t<r;t++){if(f.skips[t].test(e)){return false}}for(t=0,r=f.names.length;t<r;t++){if(f.names[t].test(e)){return true}}return false}function c(e){if(e instanceof Error)return e.stack||e.message;return e}},{ms:37}],15:[function(e,t,r){t.exports=e("./socket");t.exports.parser=e("engine.io-parser")},{"./socket":16,"engine.io-parser":24}],16:[function(t,r,e){(function(n){var i=t("./transports/index");var e=t("component-emitter");var l=t("debug")("engine.io-client:socket");var o=t("indexof");var a=t("engine.io-parser");var s=t("parseuri");var c=t("parseqs");r.exports=d;function d(e,t){if(!(this instanceof d))return new d(e,t);t=t||{};if(e&&"object"===typeof e){t=e;e=null}if(e){e=s(e);t.hostname=e.host;t.secure=e.protocol==="https"||e.protocol==="wss";t.port=e.port;if(e.query)t.query=e.query}else if(t.host){t.hostname=s(t.host).host}this.secure=null!=t.secure?t.secure:n.location&&"https:"===location.protocol;if(t.hostname&&!t.port){t.port=this.secure?"443":"80"}this.agent=t.agent||false;this.hostname=t.hostname||(n.location?location.hostname:"localhost");this.port=t.port||(n.location&&location.port?location.port:this.secure?443:80);this.query=t.query||{};if("string"===typeof this.query)this.query=c.decode(this.query);this.upgrade=false!==t.upgrade;this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/";this.forceJSONP=!!t.forceJSONP;this.jsonp=false!==t.jsonp;this.forceBase64=!!t.forceBase64;this.enablesXDR=!!t.enablesXDR;this.timestampParam=t.timestampParam||"t";this.timestampRequests=t.timestampRequests;this.transports=t.transports||["polling","websocket"];this.transportOptions=t.transportOptions||{};this.readyState="";this.writeBuffer=[];this.prevBufferLen=0;this.policyPort=t.policyPort||843;this.rememberUpgrade=t.rememberUpgrade||false;this.binaryType=null;this.onlyBinaryUpgrades=t.onlyBinaryUpgrades;this.perMessageDeflate=false!==t.perMessageDeflate?t.perMessageDeflate||{}:false;if(true===this.perMessageDeflate)this.perMessageDeflate={};if(this.perMessageDeflate&&null==this.perMessageDeflate.threshold){this.perMessageDeflate.threshold=1024}this.pfx=t.pfx||null;this.key=t.key||null;this.passphrase=t.passphrase||null;this.cert=t.cert||null;this.ca=t.ca||null;this.ciphers=t.ciphers||null;this.rejectUnauthorized=t.rejectUnauthorized===undefined?true:t.rejectUnauthorized;this.forceNode=!!t.forceNode;var r=typeof n==="object"&&n;if(r.global===r){if(t.extraHeaders&&Object.keys(t.extraHeaders).length>0){this.extraHeaders=t.extraHeaders}if(t.localAddress){this.localAddress=t.localAddress}}this.id=null;this.upgrades=null;this.pingInterval=null;this.pingTimeout=null;this.pingIntervalTimer=null;this.pingTimeoutTimer=null;this.open()}d.priorWebsocketSuccess=false;e(d.prototype);d.protocol=a.protocol;d.Socket=d;d.Transport=t("./transport");d.transports=t("./transports/index");d.parser=t("engine.io-parser");d.prototype.createTransport=function(e){l('creating transport "%s"',e);var t=f(this.query);t.EIO=a.protocol;t.transport=e;var r=this.transportOptions[e]||{};if(this.id)t.sid=this.id;var n=new i[e]({query:t,socket:this,agent:r.agent||this.agent,hostname:r.hostname||this.hostname,port:r.port||this.port,secure:r.secure||this.secure,path:r.path||this.path,forceJSONP:r.forceJSONP||this.forceJSONP,jsonp:r.jsonp||this.jsonp,forceBase64:r.forceBase64||this.forceBase64,enablesXDR:r.enablesXDR||this.enablesXDR,timestampRequests:r.timestampRequests||this.timestampRequests,timestampParam:r.timestampParam||this.timestampParam,policyPort:r.policyPort||this.policyPort,pfx:r.pfx||this.pfx,key:r.key||this.key,passphrase:r.passphrase||this.passphrase,cert:r.cert||this.cert,ca:r.ca||this.ca,ciphers:r.ciphers||this.ciphers,rejectUnauthorized:r.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:r.perMessageDeflate||this.perMessageDeflate,extraHeaders:r.extraHeaders||this.extraHeaders,forceNode:r.forceNode||this.forceNode,localAddress:r.localAddress||this.localAddress,requestTimeout:r.requestTimeout||this.requestTimeout,protocols:r.protocols||void 0});return n};function f(e){var t={};for(var r in e){if(e.hasOwnProperty(r)){t[r]=e[r]}}return t}d.prototype.open=function(){var e;if(this.rememberUpgrade&&d.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1){e="websocket"}else if(0===this.transports.length){var t=this;setTimeout(function(){t.emit("error","No transports available")},0);return}else{e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){this.transports.shift();this.open();return}e.open();this.setTransport(e)};d.prototype.setTransport=function(e){l("setting transport %s",e.name);var t=this;if(this.transport){l("clearing existing transport %s",this.transport.name);this.transport.removeAllListeners()}this.transport=e;e.on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})};d.prototype.probe=function(r){l('probing transport "%s"',r);var n=this.createTransport(r,{probe:1});var i=false;var o=this;d.priorWebsocketSuccess=false;function e(){if(o.onlyBinaryUpgrades){var e=!this.supportsBinary&&o.transport.supportsBinary;i=i||e}if(i)return;l('probe transport "%s" opened',r);n.send([{type:"ping",data:"probe"}]);n.once("packet",function(e){if(i)return;if("pong"===e.type&&"probe"===e.data){l('probe transport "%s" pong',r);o.upgrading=true;o.emit("upgrading",n);if(!n)return;d.priorWebsocketSuccess="websocket"===n.name;l('pausing current transport "%s"',o.transport.name);o.transport.pause(function(){if(i)return;if("closed"===o.readyState)return;l("changing transport and sending upgrade packet");u();o.setTransport(n);n.send([{type:"upgrade"}]);o.emit("upgrade",n);n=null;o.upgrading=false;o.flush()})}else{l('probe transport "%s" failed',r);var t=new Error("probe error");t.transport=n.name;o.emit("upgradeError",t)}})}function a(){if(i)return;i=true;u();n.close();n=null}function t(e){var t=new Error("probe error: "+e);t.transport=n.name;a();l('probe transport "%s" failed because of error: %s',r,e);o.emit("upgradeError",t)}function s(){t("transport closed")}function c(){t("socket closed")}function f(e){if(n&&e.name!==n.name){l('"%s" works - aborting "%s"',e.name,n.name);a()}}function u(){n.removeListener("open",e);n.removeListener("error",t);n.removeListener("close",s);o.removeListener("close",c);o.removeListener("upgrading",f)}n.once("open",e);n.once("error",t);n.once("close",s);this.once("close",c);this.once("upgrading",f);n.open()};d.prototype.onOpen=function(){l("socket open");this.readyState="open";d.priorWebsocketSuccess="websocket"===this.transport.name;this.emit("open");this.flush();if("open"===this.readyState&&this.upgrade&&this.transport.pause){l("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++){this.probe(this.upgrades[e])}}};d.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){l('socket receive: type "%s", data "%s"',e.type,e.data);this.emit("packet",e);this.emit("heartbeat");switch(e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing();this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data;this.onError(t);break;case"message":this.emit("data",e.data);this.emit("message",e.data);break}}else{l('packet received with socket readyState "%s"',this.readyState)}};d.prototype.onHandshake=function(e){this.emit("handshake",e);this.id=e.sid;this.transport.query.sid=e.sid;this.upgrades=this.filterUpgrades(e.upgrades);this.pingInterval=e.pingInterval;this.pingTimeout=e.pingTimeout;this.onOpen();if("closed"===this.readyState)return;this.setPing();this.removeListener("heartbeat",this.onHeartbeat);this.on("heartbeat",this.onHeartbeat)};d.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){if("closed"===t.readyState)return;t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)};d.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer);e.pingIntervalTimer=setTimeout(function(){l("writing ping packet - expecting pong within %sms",e.pingTimeout);e.ping();e.onHeartbeat(e.pingTimeout)},e.pingInterval)};d.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})};d.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen);this.prevBufferLen=0;if(0===this.writeBuffer.length){this.emit("drain")}else{this.flush()}};d.prototype.flush=function(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){l("flushing %d packets in socket",this.writeBuffer.length);this.transport.send(this.writeBuffer);this.prevBufferLen=this.writeBuffer.length;this.emit("flush")}};d.prototype.write=d.prototype.send=function(e,t,r){this.sendPacket("message",e,t,r);return this};d.prototype.sendPacket=function(e,t,r,n){if("function"===typeof t){n=t;t=undefined}if("function"===typeof r){n=r;r=null}if("closing"===this.readyState||"closed"===this.readyState){return}r=r||{};r.compress=false!==r.compress;var i={type:e,data:t,options:r};this.emit("packetCreate",i);this.writeBuffer.push(i);if(n)this.once("flush",n);this.flush()};d.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;if(this.writeBuffer.length){this.once("drain",function(){if(this.upgrading){n()}else{t()}})}else if(this.upgrading){n()}else{t()}}function t(){e.onClose("forced close");l("socket closing - telling transport to close");e.transport.close()}function r(){e.removeListener("upgrade",r);e.removeListener("upgradeError",r);t()}function n(){e.once("upgrade",r);e.once("upgradeError",r)}return this};d.prototype.onError=function(e){l("socket error %j",e);d.priorWebsocketSuccess=false;this.emit("error",e);this.onClose("transport error",e)};d.prototype.onClose=function(e,t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){l('socket close with reason: "%s"',e);var r=this;clearTimeout(this.pingIntervalTimer);clearTimeout(this.pingTimeoutTimer);this.transport.removeAllListeners("close");this.transport.close();this.transport.removeAllListeners();this.readyState="closed";this.id=null;this.emit("close",e,t);r.writeBuffer=[];r.prevBufferLen=0}};d.prototype.filterUpgrades=function(e){var t=[];for(var r=0,n=e.length;r<n;r++){if(~o(this.transports,e[r]))t.push(e[r])}return t}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./transport":17,"./transports/index":18,"component-emitter":10,debug:13,"engine.io-parser":24,indexof:33,parseqs:38,parseuri:39}],17:[function(e,t,r){var n=e("engine.io-parser");var i=e("component-emitter");t.exports=o;function o(e){this.path=e.path;this.hostname=e.hostname;this.port=e.port;this.secure=e.secure;this.query=e.query;this.timestampParam=e.timestampParam;this.timestampRequests=e.timestampRequests;this.readyState="";this.agent=e.agent||false;this.socket=e.socket;this.enablesXDR=e.enablesXDR;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.forceNode=e.forceNode;this.extraHeaders=e.extraHeaders;this.localAddress=e.localAddress}i(o.prototype);o.prototype.onError=function(e,t){var r=new Error(e);r.type="TransportError";r.description=t;this.emit("error",r);return this};o.prototype.open=function(){if("closed"===this.readyState||""===this.readyState){this.readyState="opening";this.doOpen()}return this};o.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.doClose();this.onClose()}return this};o.prototype.send=function(e){if("open"===this.readyState){this.write(e)}else{throw new Error("Transport not open")}};o.prototype.onOpen=function(){this.readyState="open";this.writable=true;this.emit("open")};o.prototype.onData=function(e){var t=n.decodePacket(e,this.socket.binaryType);this.onPacket(t)};o.prototype.onPacket=function(e){this.emit("packet",e)};o.prototype.onClose=function(){this.readyState="closed";this.emit("close")}},{"component-emitter":10,"engine.io-parser":24}],18:[function(r,e,n){(function(s){var c=r("xmlhttprequest-ssl");var f=r("./polling-xhr");var u=r("./polling-jsonp");var e=r("./websocket");n.polling=t;n.websocket=e;function t(e){var t;var r=false;var n=false;var i=false!==e.jsonp;if(s.location){var o="https:"===location.protocol;var a=location.port;if(!a){a=o?443:80}r=e.hostname!==location.hostname||a!==e.port;n=e.secure!==o}e.xdomain=r;e.xscheme=n;t=new c(e);if("open"in t&&!e.forceJSONP){return new f(e)}else{if(!i)throw new Error("JSONP disabled");return new u(e)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling-jsonp":19,"./polling-xhr":20,"./websocket":22,"xmlhttprequest-ssl":23}],19:[function(a,s,e){(function(r){var n=a("./polling");var e=a("component-inherit");s.exports=t;var f=/\n/g;var u=/\\n/g;var i;function o(){}function t(e){n.call(this,e);this.query=this.query||{};if(!i){if(!r.___eio)r.___eio=[];i=r.___eio}this.index=i.length;var t=this;i.push(function(e){t.onData(e)});this.query.j=this.index;if(r.document&&r.addEventListener){r.addEventListener("beforeunload",function(){if(t.script)t.script.onerror=o},false)}}e(t,n);t.prototype.supportsBinary=false;t.prototype.doClose=function(){if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}if(this.form){this.form.parentNode.removeChild(this.form);this.form=null;this.iframe=null}n.prototype.doClose.call(this)};t.prototype.doPoll=function(){var t=this;var e=document.createElement("script");if(this.script){this.script.parentNode.removeChild(this.script);this.script=null}e.async=true;e.src=this.uri();e.onerror=function(e){t.onError("jsonp poll error",e)};var r=document.getElementsByTagName("script")[0];if(r){r.parentNode.insertBefore(e,r)}else{(document.head||document.body).appendChild(e)}this.script=e;var n="undefined"!==typeof navigator&&/gecko/i.test(navigator.userAgent);if(n){setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e);document.body.removeChild(e)},100)}};t.prototype.doWrite=function(e,t){var r=this;if(!this.form){var n=document.createElement("form");var i=document.createElement("textarea");var o=this.iframeId="eio_iframe_"+this.index;var a;n.className="socketio";n.style.position="absolute";n.style.top="-1000px";n.style.left="-1000px";n.target=o;n.method="POST";n.setAttribute("accept-charset","utf-8");i.name="d";n.appendChild(i);document.body.appendChild(n);this.form=n;this.area=i}this.form.action=this.uri();function s(){c();t()}function c(){if(r.iframe){try{r.form.removeChild(r.iframe)}catch(e){r.onError("jsonp polling iframe removal error",e)}}try{var e='<iframe src="javascript:0" name="'+r.iframeId+'">';a=document.createElement(e)}catch(e){a=document.createElement("iframe");a.name=r.iframeId;a.src="javascript:0"}a.id=r.iframeId;r.form.appendChild(a);r.iframe=a}c();e=e.replace(u,"\\\n");this.area.value=e.replace(f,"\\n");try{this.form.submit()}catch(e){}if(this.iframe.attachEvent){this.iframe.onreadystatechange=function(){if(r.iframe.readyState==="complete"){s()}}}else{this.iframe.onload=s}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling":21,"component-inherit":11}],20:[function(u,l,e){(function(i){var o=u("xmlhttprequest-ssl");var n=u("./polling");var e=u("component-emitter");var t=u("component-inherit");var a=u("debug")("engine.io-client:polling-xhr");l.exports=s;l.exports.Request=c;function r(){}function s(e){n.call(this,e);this.requestTimeout=e.requestTimeout;this.extraHeaders=e.extraHeaders;if(i.location){var t="https:"===location.protocol;var r=location.port;if(!r){r=t?443:80}this.xd=e.hostname!==i.location.hostname||r!==e.port;this.xs=e.secure!==t}}t(s,n);s.prototype.supportsBinary=true;s.prototype.request=function(e){e=e||{};e.uri=this.uri();e.xd=this.xd;e.xs=this.xs;e.agent=this.agent||false;e.supportsBinary=this.supportsBinary;e.enablesXDR=this.enablesXDR;e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;e.requestTimeout=this.requestTimeout;e.extraHeaders=this.extraHeaders;return new c(e)};s.prototype.doWrite=function(e,t){var r=typeof e!=="string"&&e!==undefined;var n=this.request({method:"POST",data:e,isBinary:r});var i=this;n.on("success",t);n.on("error",function(e){i.onError("xhr post error",e)});this.sendXhr=n};s.prototype.doPoll=function(){a("xhr poll");var e=this.request();var t=this;e.on("data",function(e){t.onData(e)});e.on("error",function(e){t.onError("xhr poll error",e)});this.pollXhr=e};function c(e){this.method=e.method||"GET";this.uri=e.uri;this.xd=!!e.xd;this.xs=!!e.xs;this.async=false!==e.async;this.data=undefined!==e.data?e.data:null;this.agent=e.agent;this.isBinary=e.isBinary;this.supportsBinary=e.supportsBinary;this.enablesXDR=e.enablesXDR;this.requestTimeout=e.requestTimeout;this.pfx=e.pfx;this.key=e.key;this.passphrase=e.passphrase;this.cert=e.cert;this.ca=e.ca;this.ciphers=e.ciphers;this.rejectUnauthorized=e.rejectUnauthorized;this.extraHeaders=e.extraHeaders;this.create()}e(c.prototype);c.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx;e.key=this.key;e.passphrase=this.passphrase;e.cert=this.cert;e.ca=this.ca;e.ciphers=this.ciphers;e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new o(e);var r=this;try{a("xhr open %s: %s",this.method,this.uri);t.open(this.method,this.uri,this.async);try{if(this.extraHeaders){t.setDisableHeaderCheck&&t.setDisableHeaderCheck(true);for(var n in this.extraHeaders){if(this.extraHeaders.hasOwnProperty(n)){t.setRequestHeader(n,this.extraHeaders[n])}}}}catch(e){}if("POST"===this.method){try{if(this.isBinary){t.setRequestHeader("Content-type","application/octet-stream")}else{t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}}catch(e){}}try{t.setRequestHeader("Accept","*/*")}catch(e){}if("withCredentials"in t){t.withCredentials=true}if(this.requestTimeout){t.timeout=this.requestTimeout}if(this.hasXDR()){t.onload=function(){r.onLoad()};t.onerror=function(){r.onError(t.responseText)}}else{t.onreadystatechange=function(){if(t.readyState===2){try{var e=t.getResponseHeader("Content-Type");if(r.supportsBinary&&e==="application/octet-stream"){t.responseType="arraybuffer"}}catch(e){}}if(4!==t.readyState)return;if(200===t.status||1223===t.status){r.onLoad()}else{setTimeout(function(){r.onError(t.status)},0)}}}a("xhr data %s",this.data);t.send(this.data)}catch(e){setTimeout(function(){r.onError(e)},0);return}if(i.document){this.index=c.requestsCount++;c.requests[this.index]=this}};c.prototype.onSuccess=function(){this.emit("success");this.cleanup()};c.prototype.onData=function(e){this.emit("data",e);this.onSuccess()};c.prototype.onError=function(e){this.emit("error",e);this.cleanup(true)};c.prototype.cleanup=function(e){if("undefined"===typeof this.xhr||null===this.xhr){return}if(this.hasXDR()){this.xhr.onload=this.xhr.onerror=r}else{this.xhr.onreadystatechange=r}if(e){try{this.xhr.abort()}catch(e){}}if(i.document){delete c.requests[this.index]}this.xhr=null};c.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}if(t==="application/octet-stream"){e=this.xhr.response||this.xhr.responseText}else{e=this.xhr.responseText}}catch(e){this.onError(e)}if(null!=e){this.onData(e)}};c.prototype.hasXDR=function(){return"undefined"!==typeof i.XDomainRequest&&!this.xs&&this.enablesXDR};c.prototype.abort=function(){this.cleanup()};c.requestsCount=0;c.requests={};if(i.document){if(i.attachEvent){i.attachEvent("onunload",f)}else if(i.addEventListener){i.addEventListener("beforeunload",f,false)}}function f(){for(var e in c.requests){if(c.requests.hasOwnProperty(e)){c.requests[e].abort()}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./polling":21,"component-emitter":10,"component-inherit":11,debug:13,"xmlhttprequest-ssl":23}],21:[function(r,e,t){var n=r("../transport");var i=r("parseqs");var o=r("engine.io-parser");var a=r("component-inherit");var s=r("yeast");var c=r("debug")("engine.io-client:polling");e.exports=u;var f=function(){var e=r("xmlhttprequest-ssl");var t=new e({xdomain:false});return null!=t.responseType}();function u(e){var t=e&&e.forceBase64;if(!f||t){this.supportsBinary=false}n.call(this,e)}a(u,n);u.prototype.name="polling";u.prototype.doOpen=function(){this.poll()};u.prototype.pause=function(e){var t=this;this.readyState="pausing";function r(){c("paused");t.readyState="paused";e()}if(this.polling||!this.writable){var n=0;if(this.polling){c("we are currently polling - waiting to pause");n++;this.once("pollComplete",function(){c("pre-pause polling complete");--n||r()})}if(!this.writable){c("we are currently writing - waiting to pause");n++;this.once("drain",function(){c("pre-pause writing complete");--n||r()})}}else{r()}};u.prototype.poll=function(){c("polling");this.polling=true;this.doPoll();this.emit("poll")};u.prototype.onData=function(e){var n=this;c("polling got data %s",e);var t=function(e,t,r){if("opening"===n.readyState){n.onOpen()}if("close"===e.type){n.onClose();return false}n.onPacket(e)};o.decodePayload(e,this.socket.binaryType,t);if("closed"!==this.readyState){this.polling=false;this.emit("pollComplete");if("open"===this.readyState){this.poll()}else{c('ignoring poll - transport state "%s"',this.readyState)}}};u.prototype.doClose=function(){var e=this;function t(){c("writing close packet");e.write([{type:"close"}])}if("open"===this.readyState){c("transport open - closing");t()}else{c("transport not open - deferring close");this.once("open",t)}};u.prototype.write=function(e){var t=this;this.writable=false;var r=function(){t.writable=true;t.emit("drain")};o.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,r)})};u.prototype.uri=function(){var e=this.query||{};var t=this.secure?"https":"http";var r="";if(false!==this.timestampRequests){e[this.timestampParam]=s()}if(!this.supportsBinary&&!e.sid){e.b64=1}e=i.encode(e);if(this.port&&("https"===t&&Number(this.port)!==443||"http"===t&&Number(this.port)!==80)){r=":"+this.port}if(e.length){e="?"+e}var n=this.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+e}},{"../transport":17,"component-inherit":11,debug:13,"engine.io-parser":24,parseqs:38,"xmlhttprequest-ssl":23,yeast:79}],22:[function(l,d,e){(function(s){var r=l("../transport");var c=l("engine.io-parser");var i=l("parseqs");var e=l("component-inherit");var o=l("yeast");var f=l("debug")("engine.io-client:websocket");var n=s.WebSocket||s.MozWebSocket;var a;if(typeof window==="undefined"){try{a=l("ws")}catch(e){}}var u=n;if(!u&&typeof window==="undefined"){u=a}d.exports=t;function t(e){var t=e&&e.forceBase64;if(t){this.supportsBinary=false}this.perMessageDeflate=e.perMessageDeflate;this.usingBrowserWebSocket=n&&!e.forceNode;this.protocols=e.protocols;if(!this.usingBrowserWebSocket){u=a}r.call(this,e)}e(t,r);t.prototype.name="websocket";t.prototype.supportsBinary=true;t.prototype.doOpen=function(){if(!this.check()){return}var e=this.uri();var t=this.protocols;var r={agent:this.agent,perMessageDeflate:this.perMessageDeflate};r.pfx=this.pfx;r.key=this.key;r.passphrase=this.passphrase;r.cert=this.cert;r.ca=this.ca;r.ciphers=this.ciphers;r.rejectUnauthorized=this.rejectUnauthorized;if(this.extraHeaders){r.headers=this.extraHeaders}if(this.localAddress){r.localAddress=this.localAddress}try{this.ws=this.usingBrowserWebSocket?t?new u(e,t):new u(e):new u(e,t,r)}catch(e){return this.emit("error",e)}if(this.ws.binaryType===undefined){this.supportsBinary=false}if(this.ws.supports&&this.ws.supports.binary){this.supportsBinary=true;this.ws.binaryType="nodebuffer"}else{this.ws.binaryType="arraybuffer"}this.addEventListeners()};t.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()};this.ws.onclose=function(){t.onClose()};this.ws.onmessage=function(e){t.onData(e.data)};this.ws.onerror=function(e){t.onError("websocket error",e)}};t.prototype.write=function(e){var i=this;this.writable=false;var o=e.length;for(var t=0,r=o;t<r;t++){(function(n){c.encodePacket(n,i.supportsBinary,function(e){if(!i.usingBrowserWebSocket){var t={};if(n.options){t.compress=n.options.compress}if(i.perMessageDeflate){var r="string"===typeof e?s.Buffer.byteLength(e):e.length;if(r<i.perMessageDeflate.threshold){t.compress=false}}}try{if(i.usingBrowserWebSocket){i.ws.send(e)}else{i.ws.send(e,t)}}catch(e){f("websocket closed before onclose event")}--o||a()})})(e[t])}function a(){i.emit("flush");setTimeout(function(){i.writable=true;i.emit("drain")},0)}};t.prototype.onClose=function(){r.prototype.onClose.call(this)};t.prototype.doClose=function(){if(typeof this.ws!=="undefined"){this.ws.close()}};t.prototype.uri=function(){var e=this.query||{};var t=this.secure?"wss":"ws";var r="";if(this.port&&("wss"===t&&Number(this.port)!==443||"ws"===t&&Number(this.port)!==80)){r=":"+this.port}if(this.timestampRequests){e[this.timestampParam]=o()}if(!this.supportsBinary){e.b64=1}e=i.encode(e);if(e.length){e="?"+e}var n=this.hostname.indexOf(":")!==-1;return t+"://"+(n?"["+this.hostname+"]":this.hostname)+r+this.path+e};t.prototype.check=function(){return!!u&&!("__initialize"in u&&this.name===t.prototype.name)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"../transport":17,"component-inherit":11,debug:13,"engine.io-parser":24,parseqs:38,ws:7,yeast:79}],23:[function(e,t,r){(function(i){var o=e("has-cors");t.exports=function(e){var t=e.xdomain;var r=e.xscheme;var n=e.enablesXDR;try{if("undefined"!==typeof XMLHttpRequest&&(!t||o)){return new XMLHttpRequest}}catch(e){}try{if("undefined"!==typeof XDomainRequest&&!r&&n){return new XDomainRequest}}catch(e){}if(!t){try{return new(i[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"has-cors":31}],24:[function(n,e,C){(function(f){var e=n("./keys");var a=n("has-binary2");var d=n("arraybuffer.slice");var s=n("after");var c=n("./utf8");var i;if(f&&f.ArrayBuffer){i=n("base64-arraybuffer")}var t=typeof navigator!=="undefined"&&/Android/i.test(navigator.userAgent);var r=typeof navigator!=="undefined"&&/PhantomJS/i.test(navigator.userAgent);var u=t||r;C.protocol=3;var l=C.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6};var p=e(l);var h={type:"error",data:"parser error"};var v=n("blob");C.encodePacket=function(e,t,r,n){if(typeof t==="function"){n=t;t=false}if(typeof r==="function"){n=r;r=null}var i=e.data===undefined?undefined:e.data.buffer||e.data;if(f.ArrayBuffer&&i instanceof ArrayBuffer){return g(e,t,n)}else if(v&&i instanceof f.Blob){return y(e,t,n)}if(i&&i.base64){return m(e,n)}var o=l[e.type];if(undefined!==e.data){o+=r?c.encode(String(e.data),{strict:false}):String(e.data)}return n(""+o)};function m(e,t){var r="b"+C.packets[e.type]+e.data.data;return t(r)}function g(e,t,r){if(!t){return C.encodeBase64Packet(e,r)}var n=e.data;var i=new Uint8Array(n);var o=new Uint8Array(1+n.byteLength);o[0]=l[e.type];for(var a=0;a<i.length;a++){o[a+1]=i[a]}return r(o.buffer)}function o(e,t,r){if(!t){return C.encodeBase64Packet(e,r)}var n=new FileReader;n.onload=function(){e.data=n.result;C.encodePacket(e,t,true,r)};return n.readAsArrayBuffer(e.data)}function y(e,t,r){if(!t){return C.encodeBase64Packet(e,r)}if(u){return o(e,t,r)}var n=new Uint8Array(1);n[0]=l[e.type];var i=new v([n.buffer,e.data]);return r(i)}C.encodeBase64Packet=function(t,r){var n="b"+C.packets[t.type];if(v&&t.data instanceof f.Blob){var i=new FileReader;i.onload=function(){var e=i.result.split(",")[1];r(n+e)};return i.readAsDataURL(t.data)}var o;try{o=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){var a=new Uint8Array(t.data);var s=new Array(a.length);for(var c=0;c<a.length;c++){s[c]=a[c]}o=String.fromCharCode.apply(null,s)}n+=f.btoa(o);return r(n)};C.decodePacket=function(e,t,r){if(e===undefined){return h}if(typeof e==="string"){if(e.charAt(0)==="b"){return C.decodeBase64Packet(e.substr(1),t)}if(r){e=b(e);if(e===false){return h}}var n=e.charAt(0);if(Number(n)!=n||!p[n]){return h}if(e.length>1){return{type:p[n],data:e.substring(1)}}else{return{type:p[n]}}}var i=new Uint8Array(e);var n=i[0];var o=d(e,1);if(v&&t==="blob"){o=new v([o])}return{type:p[n],data:o}};function b(e){try{e=c.decode(e,{strict:false})}catch(e){return false}return e}C.decodeBase64Packet=function(e,t){var r=p[e.charAt(0)];if(!i){return{type:r,data:{base64:true,data:e.substr(1)}}}var n=i.decode(e.substr(1));if(t==="blob"&&v){n=new v([n])}return{type:r,data:n}};C.encodePayload=function(e,r,n){if(typeof r==="function"){n=r;r=null}var i=a(e);if(r&&i){if(v&&!u){return C.encodePayloadAsBlob(e,n)}return C.encodePayloadAsArrayBuffer(e,n)}if(!e.length){return n("0:")}function o(e){return e.length+":"+e}function t(e,t){C.encodePacket(e,!i?false:r,false,function(e){t(null,o(e))})}w(e,t,function(e,t){return n(t.join(""))})};function w(e,t,r){var i=new Array(e.length);var n=s(e.length,r);var o=function(r,e,n){t(e,function(e,t){i[r]=t;n(e,i)})};for(var a=0;a<e.length;a++){o(a,e[a],n)}}C.decodePayload=function(e,t,r){if(typeof e!=="string"){return C.decodePayloadAsBinary(e,t,r)}if(typeof t==="function"){r=t;t=null}var n;if(e===""){return r(h,0,1)}var i="",o,a;for(var s=0,c=e.length;s<c;s++){var f=e.charAt(s);if(f!==":"){i+=f;continue}if(i===""||i!=(o=Number(i))){return r(h,0,1)}a=e.substr(s+1,o);if(i!=a.length){return r(h,0,1)}if(a.length){n=C.decodePacket(a,t,false);if(h.type===n.type&&h.data===n.data){return r(h,0,1)}var u=r(n,s+o,c);if(false===u)return}s+=o;i=""}if(i!==""){return r(h,0,1)}};C.encodePayloadAsArrayBuffer=function(e,n){if(!e.length){return n(new ArrayBuffer(0))}function t(e,t){C.encodePacket(e,true,true,function(e){return t(null,e)})}w(e,t,function(e,t){var r=t.reduce(function(e,t){var r;if(typeof t==="string"){r=t.length}else{r=t.byteLength}return e+r.toString().length+r+2},0);var a=new Uint8Array(r);var s=0;t.forEach(function(e){var t=typeof e==="string";var r=e;if(t){var n=new Uint8Array(e.length);for(var i=0;i<e.length;i++){n[i]=e.charCodeAt(i)}r=n.buffer}if(t){a[s++]=0}else{a[s++]=1}var o=r.byteLength.toString();for(var i=0;i<o.length;i++){a[s++]=parseInt(o[i])}a[s++]=255;var n=new Uint8Array(r);for(var i=0;i<n.length;i++){a[s++]=n[i]}});return n(a.buffer)})};C.encodePayloadAsBlob=function(e,r){function t(e,c){C.encodePacket(e,true,true,function(e){var t=new Uint8Array(1);t[0]=1;if(typeof e==="string"){var r=new Uint8Array(e.length);for(var n=0;n<e.length;n++){r[n]=e.charCodeAt(n)}e=r.buffer;t[0]=0}var i=e instanceof ArrayBuffer?e.byteLength:e.size;var o=i.toString();var a=new Uint8Array(o.length+1);for(var n=0;n<o.length;n++){a[n]=parseInt(o[n])}a[o.length]=255;if(v){var s=new v([t.buffer,a.buffer,e]);c(null,s)}})}w(e,t,function(e,t){return r(new v(t))})};C.decodePayloadAsBinary=function(e,r,n){if(typeof r==="function"){n=r;r=null}var t=e;var i=[];while(t.byteLength>0){var o=new Uint8Array(t);var a=o[0]===0;var s="";for(var c=1;;c++){if(o[c]===255)break;if(s.length>310){return n(h,0,1)}s+=o[c]}t=d(t,2+s.length);s=parseInt(s);var f=d(t,0,s);if(a){try{f=String.fromCharCode.apply(null,new Uint8Array(f))}catch(e){var u=new Uint8Array(f);f="";for(var c=0;c<u.length;c++){f+=String.fromCharCode(u[c])}}}i.push(f);t=d(t,s)}var l=i.length;i.forEach(function(e,t){n(C.decodePacket(e,r,true),t,l)})}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./keys":25,"./utf8":26,after:1,"arraybuffer.slice":2,"base64-arraybuffer":4,blob:6,"has-binary2":29}],25:[function(e,t,r){t.exports=Object.keys||function e(t){var r=[];var n=Object.prototype.hasOwnProperty;for(var i in t){if(n.call(t,i)){r.push(i)}}return r}},{}],26:[function(e,_,S){(function(C){(function(e){var t=typeof S=="object"&&S;var r=typeof _=="object"&&_&&_.exports==t&&_;var n=typeof C=="object"&&C;if(n.global===n||n.window===n){e=n}var o=String.fromCharCode;function c(e){var t=[];var r=0;var n=e.length;var i;var o;while(r<n){i=e.charCodeAt(r++);if(i>=55296&&i<=56319&&r<n){o=e.charCodeAt(r++);if((o&64512)==56320){t.push(((i&1023)<<10)+(o&1023)+65536)}else{t.push(i);r--}}else{t.push(i)}}return t}function a(e){var t=e.length;var r=-1;var n;var i="";while(++r<t){n=e[r];if(n>65535){n-=65536;i+=o(n>>>10&1023|55296);n=56320|n&1023}i+=o(n)}return i}function s(e,t){if(e>=55296&&e<=57343){if(t){throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value")}return false}return true}function i(e,t){return o(e>>t&63|128)}function f(e,t){if((e&4294967168)==0){return o(e)}var r="";if((e&4294965248)==0){r=o(e>>6&31|192)}else if((e&4294901760)==0){if(!s(e,t)){e=65533}r=o(e>>12&15|224);r+=i(e,6)}else if((e&4292870144)==0){r=o(e>>18&7|240);r+=i(e,12);r+=i(e,6)}r+=o(e&63|128);return r}function u(e,t){t=t||{};var r=false!==t.strict;var n=c(e);var i=n.length;var o=-1;var a;var s="";while(++o<i){a=n[o];s+=f(a,r)}return s}function l(){if(v>=h){throw Error("Invalid byte index")}var e=p[v]&255;v++;if((e&192)==128){return e&63}throw Error("Invalid continuation byte")}function d(e){var t;var r;var n;var i;var o;if(v>h){throw Error("Invalid byte index")}if(v==h){return false}t=p[v]&255;v++;if((t&128)==0){return t}if((t&224)==192){r=l();o=(t&31)<<6|r;if(o>=128){return o}else{throw Error("Invalid continuation byte")}}if((t&240)==224){r=l();n=l();o=(t&15)<<12|r<<6|n;if(o>=2048){return s(o,e)?o:65533}else{throw Error("Invalid continuation byte")}}if((t&248)==240){r=l();n=l();i=l();o=(t&7)<<18|r<<12|n<<6|i;if(o>=65536&&o<=1114111){return o}}throw Error("Invalid UTF-8 detected")}var p;var h;var v;function m(e,t){t=t||{};var r=false!==t.strict;p=c(e);h=p.length;v=0;var n=[];var i;while((i=d(r))!==false){n.push(i)}return a(n)}var g={version:"2.1.2",encode:u,decode:m};if(typeof T=="function"&&typeof T.amd=="object"&&T.amd){T(function(){return g})}else if(t&&!t.nodeType){if(r){r.exports=g}else{var y={};var b=y.hasOwnProperty;for(var w in g){b.call(g,w)&&(t[w]=g[w])}}}else{e.utf8=g}})(this)}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],27:[function(e,t,r){var c=Object.create||S;var s=Object.keys||T;var o=Function.prototype.bind||k;function n(){if(!this._events||!Object.prototype.hasOwnProperty.call(this,"_events")){this._events=c(null);this._eventsCount=0}this._maxListeners=this._maxListeners||undefined}t.exports=n;n.EventEmitter=n;n.prototype._events=undefined;n.prototype._maxListeners=undefined;var i=10;var a;try{var f={};if(Object.defineProperty)Object.defineProperty(f,"x",{value:0});a=f.x===0}catch(e){a=false}if(a){Object.defineProperty(n,"defaultMaxListeners",{enumerable:true,get:function(){return i},set:function(e){if(typeof e!=="number"||e<0||e!==e)throw new TypeError('"defaultMaxListeners" must be a positive number');i=e}})}else{n.defaultMaxListeners=i}n.prototype.setMaxListeners=function e(t){if(typeof t!=="number"||t<0||isNaN(t))throw new TypeError('"n" argument must be a positive number');this._maxListeners=t;return this};function u(e){if(e._maxListeners===undefined)return n.defaultMaxListeners;return e._maxListeners}n.prototype.getMaxListeners=function e(){return u(this)};function l(e,t,r){if(t)e.call(r);else{var n=e.length;var i=C(e,n);for(var o=0;o<n;++o)i[o].call(r)}}function d(e,t,r,n){if(t)e.call(r,n);else{var i=e.length;var o=C(e,i);for(var a=0;a<i;++a)o[a].call(r,n)}}function p(e,t,r,n,i){if(t)e.call(r,n,i);else{var o=e.length;var a=C(e,o);for(var s=0;s<o;++s)a[s].call(r,n,i)}}function h(e,t,r,n,i,o){if(t)e.call(r,n,i,o);else{var a=e.length;var s=C(e,a);for(var c=0;c<a;++c)s[c].call(r,n,i,o)}}function v(e,t,r,n){if(t)e.apply(r,n);else{var i=e.length;var o=C(e,i);for(var a=0;a<i;++a)o[a].apply(r,n)}}n.prototype.emit=function e(t){var r,n,i,o,a,s;var c=t==="error";s=this._events;if(s)c=c&&s.error==null;else if(!c)return false;if(c){if(arguments.length>1)r=arguments[1];if(r instanceof Error){throw r}else{var f=new Error('Unhandled "error" event. ('+r+")");f.context=r;throw f}return false}n=s[t];if(!n)return false;var u=typeof n==="function";i=arguments.length;switch(i){case 1:l(n,u,this);break;case 2:d(n,u,this,arguments[1]);break;case 3:p(n,u,this,arguments[1],arguments[2]);break;case 4:h(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:o=new Array(i-1);for(a=1;a<i;a++)o[a-1]=arguments[a];v(n,u,this,o)}return true};function m(e,t,r,n){var i;var o;var a;if(typeof r!=="function")throw new TypeError('"listener" argument must be a function');o=e._events;if(!o){o=e._events=c(null);e._eventsCount=0}else{if(o.newListener){e.emit("newListener",t,r.listener?r.listener:r);o=e._events}a=o[t]}if(!a){a=o[t]=r;++e._eventsCount}else{if(typeof a==="function"){a=o[t]=n?[r,a]:[a,r]}else{if(n){a.unshift(r)}else{a.push(r)}}if(!a.warned){i=u(e);if(i&&i>0&&a.length>i){a.warned=true;var s=new Error("Possible EventEmitter memory leak detected. "+a.length+' "'+String(t)+'" listeners '+"added. Use emitter.setMaxListeners() to "+"increase limit.");s.name="MaxListenersExceededWarning";s.emitter=e;s.type=t;s.count=a.length;if(typeof console==="object"&&console.warn){console.warn("%s: %s",s.name,s.message)}}}}return e}n.prototype.addListener=function e(t,r){return m(this,t,r,false)};n.prototype.on=n.prototype.addListener;n.prototype.prependListener=function e(t,r){return m(this,t,r,true)};function g(){if(!this.fired){this.target.removeListener(this.type,this.wrapFn);this.fired=true;switch(arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:var e=new Array(arguments.length);for(var t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}}function y(e,t,r){var n={fired:false,wrapFn:undefined,target:e,type:t,listener:r};var i=o.call(g,n);i.listener=r;n.wrapFn=i;return i}n.prototype.once=function e(t,r){if(typeof r!=="function")throw new TypeError('"listener" argument must be a function');this.on(t,y(this,t,r));return this};n.prototype.prependOnceListener=function e(t,r){if(typeof r!=="function")throw new TypeError('"listener" argument must be a function');this.prependListener(t,y(this,t,r));return this};n.prototype.removeListener=function e(t,r){var n,i,o,a,s;if(typeof r!=="function")throw new TypeError('"listener" argument must be a function');i=this._events;if(!i)return this;n=i[t];if(!n)return this;if(n===r||n.listener===r){if(--this._eventsCount===0)this._events=c(null);else{delete i[t];if(i.removeListener)this.emit("removeListener",t,n.listener||r)}}else if(typeof n!=="function"){o=-1;for(a=n.length-1;a>=0;a--){if(n[a]===r||n[a].listener===r){s=n[a].listener;o=a;break}}if(o<0)return this;if(o===0)n.shift();else w(n,o);if(n.length===1)i[t]=n[0];if(i.removeListener)this.emit("removeListener",t,s||r)}return this};n.prototype.removeAllListeners=function e(t){var r,n,i;n=this._events;if(!n)return this;if(!n.removeListener){if(arguments.length===0){this._events=c(null);this._eventsCount=0}else if(n[t]){if(--this._eventsCount===0)this._events=c(null);else delete n[t]}return this}if(arguments.length===0){var o=s(n);var a;for(i=0;i<o.length;++i){a=o[i];if(a==="removeListener")continue;this.removeAllListeners(a)}this.removeAllListeners("removeListener");this._events=c(null);this._eventsCount=0;return this}r=n[t];if(typeof r==="function"){this.removeListener(t,r)}else if(r){for(i=r.length-1;i>=0;i--){this.removeListener(t,r[i])}}return this};n.prototype.listeners=function e(t){var r;var n;var i=this._events;if(!i)n=[];else{r=i[t];if(!r)n=[];else if(typeof r==="function")n=[r.listener||r];else n=_(r)}return n};n.listenerCount=function(e,t){if(typeof e.listenerCount==="function"){return e.listenerCount(t)}else{return b.call(e,t)}};n.prototype.listenerCount=b;function b(e){var t=this._events;if(t){var r=t[e];if(typeof r==="function"){return 1}else if(r){return r.length}}return 0}n.prototype.eventNames=function e(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};function w(e,t){for(var r=t,n=r+1,i=e.length;n<i;r+=1,n+=1)e[r]=e[n];e.pop()}function C(e,t){var r=new Array(t);for(var n=0;n<t;++n)r[n]=e[n];return r}function _(e){var t=new Array(e.length);for(var r=0;r<t.length;++r){t[r]=e[r].listener||e[r]}return t}function S(e){var t=function(){};t.prototype=e;return new t}function T(e){var t=[];for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){t.push(r)}return r}function k(e){var t=this;return function(){return t.apply(e,arguments)}}},{}],28:[function(e,t,r){t.exports=function e(){if(typeof window==="undefined")return null;var t={RTCPeerConnection:window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection,RTCSessionDescription:window.RTCSessionDescription||window.mozRTCSessionDescription||window.webkitRTCSessionDescription,RTCIceCandidate:window.RTCIceCandidate||window.mozRTCIceCandidate||window.webkitRTCIceCandidate};if(!t.RTCPeerConnection)return null;return t}},{}],29:[function(t,r,e){(function(i){var o=t("isarray");var e=Object.prototype.toString;var a=typeof Blob==="function"||typeof Blob!=="undefined"&&e.call(Blob)==="[object BlobConstructor]";var s=typeof File==="function"||typeof File!=="undefined"&&e.call(File)==="[object FileConstructor]";r.exports=c;function c(e){if(!e||typeof e!=="object"){return false}if(o(e)){for(var t=0,r=e.length;t<r;t++){if(c(e[t])){return true}}return false}if(typeof i==="function"&&i.isBuffer&&i.isBuffer(e)||typeof ArrayBuffer==="function"&&e instanceof ArrayBuffer||a&&e instanceof Blob||s&&e instanceof File){return true}if(e.toJSON&&typeof e.toJSON==="function"&&arguments.length===1){return c(e.toJSON(),true)}for(var n in e){if(Object.prototype.hasOwnProperty.call(e,n)&&c(e[n])){return true}}return false}}).call(this,t("buffer").Buffer)},{buffer:8,isarray:30}],30:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return n.call(e)=="[object Array]"}},{}],31:[function(e,t,r){try{t.exports=typeof XMLHttpRequest!=="undefined"&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=false}},{}],32:[function(e,t,r){r.read=function(e,t,r,n,i){var o,a;var s=i*8-n-1;var c=(1<<s)-1;var f=c>>1;var u=-7;var l=r?i-1:0;var d=r?-1:1;var p=e[t+l];l+=d;o=p&(1<<-u)-1;p>>=-u;u+=s;for(;u>0;o=o*256+e[t+l],l+=d,u-=8){}a=o&(1<<-u)-1;o>>=-u;u+=n;for(;u>0;a=a*256+e[t+l],l+=d,u-=8){}if(o===0){o=1-f}else if(o===c){return a?NaN:(p?-1:1)*Infinity}else{a=a+Math.pow(2,n);o=o-f}return(p?-1:1)*a*Math.pow(2,o-n)};r.write=function(e,t,r,n,i,o){var a,s,c;var f=o*8-i-1;var u=(1<<f)-1;var l=u>>1;var d=i===23?Math.pow(2,-24)-Math.pow(2,-77):0;var p=n?0:o-1;var h=n?1:-1;var v=t<0||t===0&&1/t<0?1:0;t=Math.abs(t);if(isNaN(t)||t===Infinity){s=isNaN(t)?1:0;a=u}else{a=Math.floor(Math.log(t)/Math.LN2);if(t*(c=Math.pow(2,-a))<1){a--;c*=2}if(a+l>=1){t+=d/c}else{t+=d*Math.pow(2,1-l)}if(t*c>=2){a++;c/=2}if(a+l>=u){s=0;a=u}else if(a+l>=1){s=(t*c-1)*Math.pow(2,i);a=a+l}else{s=t*Math.pow(2,l-1)*Math.pow(2,i);a=0}}for(;i>=8;e[r+p]=s&255,p+=h,s/=256,i-=8){}a=a<<i|s;f+=i;for(;f>0;e[r+p]=a&255,p+=h,a/=256,f-=8){}e[r+p-h]|=v*128}},{}],33:[function(e,t,r){var n=[].indexOf;t.exports=function(e,t){if(n)return e.indexOf(t);for(var r=0;r<e.length;++r){if(e[r]===t)return r}return-1}},{}],34:[function(e,t,r){if(typeof Object.create==="function"){t.exports=function e(t,r){t.super_=r;t.prototype=Object.create(r.prototype,{constructor:{value:t,enumerable:false,writable:true,configurable:true}})}}else{t.exports=function e(t,r){t.super_=r;var n=function(){};n.prototype=r.prototype;t.prototype=new n;t.prototype.constructor=t}}},{}],35:[function(e,t,r){t.exports=function(e){return e!=null&&(n(e)||i(e)||!!e._isBuffer)};function n(e){return!!e.constructor&&typeof e.constructor.isBuffer==="function"&&e.constructor.isBuffer(e)}function i(e){return typeof e.readFloatLE==="function"&&typeof e.slice==="function"&&n(e.slice(0,0))}},{}],36:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{dup:30}],37:[function(e,t,r){var i=1e3;var o=i*60;var a=o*60;var s=a*24;var c=s*365.25;t.exports=function(e,t){t=t||{};var r=typeof e;if(r==="string"&&e.length>0){return n(e)}else if(r==="number"&&isNaN(e)===false){return t.long?u(e):f(e)}throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))};function n(e){e=String(e);if(e.length>100){return}var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t){return}var r=parseFloat(t[1]);var n=(t[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*c;case"days":case"day":case"d":return r*s;case"hours":case"hour":case"hrs":case"hr":case"h":return r*a;case"minutes":case"minute":case"mins":case"min":case"m":return r*o;case"seconds":case"second":case"secs":case"sec":case"s":return r*i;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return undefined}}function f(e){if(e>=s){return Math.round(e/s)+"d"}if(e>=a){return Math.round(e/a)+"h"}if(e>=o){return Math.round(e/o)+"m"}if(e>=i){return Math.round(e/i)+"s"}return e+"ms"}function u(e){return l(e,s,"day")||l(e,a,"hour")||l(e,o,"minute")||l(e,i,"second")||e+" ms"}function l(e,t,r){if(e<t){return}if(e<t*1.5){return Math.floor(e/t)+" "+r}return Math.ceil(e/t)+" "+r+"s"}},{}],38:[function(e,t,r){r.encode=function(e){var t="";for(var r in e){if(e.hasOwnProperty(r)){if(t.length)t+="&";t+=encodeURIComponent(r)+"="+encodeURIComponent(e[r])}}return t};r.decode=function(e){var t={};var r=e.split("&");for(var n=0,i=r.length;n<i;n++){var o=r[n].split("=");t[decodeURIComponent(o[0])]=decodeURIComponent(o[1])}return t}},{}],39:[function(e,t,r){var c=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;var f=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function e(t){var r=t,n=t.indexOf("["),i=t.indexOf("]");if(n!=-1&&i!=-1){t=t.substring(0,n)+t.substring(n,i).replace(/:/g,";")+t.substring(i,t.length)}var o=c.exec(t||""),a={},s=14;while(s--){a[f[s]]=o[s]||""}if(n!=-1&&i!=-1){a.source=r;a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":");a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":");a.ipv6uri=true}return a}},{}],40:[function(e,t,r){(function(s){"use strict";if(!s.version||s.version.indexOf("v0.")===0||s.version.indexOf("v1.")===0&&s.version.indexOf("v1.8.")!==0){t.exports={nextTick:e}}else{t.exports=s}function e(t,r,n,i){if(typeof t!=="function"){throw new TypeError('"callback" argument must be a function')}var e=arguments.length;var o,a;switch(e){case 0:case 1:return s.nextTick(t);case 2:return s.nextTick(function e(){t.call(null,r)});case 3:return s.nextTick(function e(){t.call(null,r,n)});case 4:return s.nextTick(function e(){t.call(null,r,n,i)});default:o=new Array(e-1);a=0;while(a<o.length){o[a++]=arguments[a]}return s.nextTick(function e(){t.apply(null,o)})}}}).call(this,e("_process"))},{_process:41}],41:[function(e,t,r){var n=t.exports={};var i;var o;function a(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}(function(){try{if(typeof setTimeout==="function"){i=setTimeout}else{i=a}}catch(e){i=a}try{if(typeof clearTimeout==="function"){o=clearTimeout}else{o=s}}catch(e){o=s}})();function c(t){if(i===setTimeout){return setTimeout(t,0)}if((i===a||!i)&&setTimeout){i=setTimeout;return setTimeout(t,0)}try{return i(t,0)}catch(e){try{return i.call(null,t,0)}catch(e){return i.call(this,t,0)}}}function f(t){if(o===clearTimeout){return clearTimeout(t)}if((o===s||!o)&&clearTimeout){o=clearTimeout;return clearTimeout(t)}try{return o(t)}catch(e){try{return o.call(null,t)}catch(e){return o.call(this,t)}}}var u=[];var l=false;var d;var p=-1;function h(){if(!l||!d){return}l=false;if(d.length){u=d.concat(u)}else{p=-1}if(u.length){v()}}function v(){if(l){return}var e=c(h);l=true;var t=u.length;while(t){d=u;u=[];while(++p<t){if(d){d[p].run()}}p=-1;t=u.length}d=null;l=false;f(e)}n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1){for(var r=1;r<arguments.length;r++){t[r-1]=arguments[r]}}u.push(new m(e,t));if(u.length===1&&!l){c(v)}};function m(e,t){this.fun=e;this.array=t}m.prototype.run=function(){this.fun.apply(null,this.array)};n.title="browser";n.browser=true;n.env={};n.argv=[];n.version="";n.versions={};function g(){}n.on=g;n.addListener=g;n.once=g;n.off=g;n.removeListener=g;n.removeAllListeners=g;n.emit=g;n.prependListener=g;n.prependOnceListener=g;n.listeners=function(e){return[]};n.binding=function(e){throw new Error("process.binding is not supported")};n.cwd=function(){return"/"};n.chdir=function(e){throw new Error("process.chdir is not supported")};n.umask=function(){return 0}},{}],42:[function(r,n,e){(function(i,o){"use strict";function e(){throw new Error("Secure random number generation is not supported by this browser.\nUse Chrome, Firefox or Internet Explorer 11")}var a=r("safe-buffer").Buffer;var s=o.crypto||o.msCrypto;if(s&&s.getRandomValues){n.exports=t}else{n.exports=e}function t(e,t){if(e>65536)throw new Error("requested too many random bytes");var r=new o.Uint8Array(e);if(e>0){s.getRandomValues(r)}var n=a.from(r.buffer);if(typeof t==="function"){return i.nextTick(function(){t(null,n)})}return n}}).call(this,r("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{_process:41,"safe-buffer":53}],43:[function(e,t,r){"use strict";var n=e("process-nextick-args");var i=Object.keys||function(e){var t=[];for(var r in e){t.push(r)}return t};t.exports=l;var o=e("core-util-is");o.inherits=e("inherits");var a=e("./_stream_readable");var s=e("./_stream_writable");o.inherits(l,a);{var c=i(s.prototype);for(var f=0;f<c.length;f++){var u=c[f];if(!l.prototype[u])l.prototype[u]=s.prototype[u]}}function l(e){if(!(this instanceof l))return new l(e);a.call(this,e);s.call(this,e);if(e&&e.readable===false)this.readable=false;if(e&&e.writable===false)this.writable=false;this.allowHalfOpen=true;if(e&&e.allowHalfOpen===false)this.allowHalfOpen=false;this.once("end",d)}Object.defineProperty(l.prototype,"writableHighWaterMark",{enumerable:false,get:function(){return this._writableState.highWaterMark}});function d(){if(this.allowHalfOpen||this._writableState.ended)return;n.nextTick(p,this)}function p(e){e.end()}Object.defineProperty(l.prototype,"destroyed",{get:function(){if(this._readableState===undefined||this._writableState===undefined){return false}return this._readableState.destroyed&&this._writableState.destroyed},set:function(e){if(this._readableState===undefined||this._writableState===undefined){return}this._readableState.destroyed=e;this._writableState.destroyed=e}});l.prototype._destroy=function(e,t){this.push(null);this.end();n.nextTick(t,e)}},{"./_stream_readable":45,"./_stream_writable":47,"core-util-is":12,inherits:34,"process-nextick-args":40}],44:[function(e,t,r){"use strict";t.exports=o;var n=e("./_stream_transform");var i=e("core-util-is");i.inherits=e("inherits");i.inherits(o,n);function o(e){if(!(this instanceof o))return new o(e);n.call(this,e)}o.prototype._transform=function(e,t,r){r(null,e)}},{"./_stream_transform":46,"core-util-is":12,inherits:34}],45:[function(J,V,e){(function(g,e){"use strict";var y=J("process-nextick-args");V.exports=m;var n=J("isarray");var a;m.ReadableState=v;var t=J("events").EventEmitter;var b=function(e,t){return e.listeners(t).length};var i=J("./internal/streams/stream");var s=J("safe-buffer").Buffer;var r=e.Uint8Array||function(){};function c(e){return s.from(e)}function o(e){return s.isBuffer(e)||e instanceof r}var f=J("core-util-is");f.inherits=J("inherits");var u=J("util");var w=void 0;if(u&&u.debuglog){w=u.debuglog("stream")}else{w=function(){}}var l=J("./internal/streams/BufferList");var d=J("./internal/streams/destroy");var p;f.inherits(m,i);var h=["error","close","destroy","pause","resume"];function C(e,t,r){if(typeof e.prependListener==="function")return e.prependListener(t,r);if(!e._events||!e._events[t])e.on(t,r);else if(n(e._events[t]))e._events[t].unshift(r);else e._events[t]=[r,e._events[t]]}function v(e,t){a=a||J("./_stream_duplex");e=e||{};var r=t instanceof a;this.objectMode=!!e.objectMode;if(r)this.objectMode=this.objectMode||!!e.readableObjectMode;var n=e.highWaterMark;var i=e.readableHighWaterMark;var o=this.objectMode?16:16*1024;if(n||n===0)this.highWaterMark=n;else if(r&&(i||i===0))this.highWaterMark=i;else this.highWaterMark=o;this.highWaterMark=Math.floor(this.highWaterMark);this.buffer=new l;this.length=0;this.pipes=null;this.pipesCount=0;this.flowing=null;this.ended=false;this.endEmitted=false;this.reading=false;this.sync=true;this.needReadable=false;this.emittedReadable=false;this.readableListening=false;this.resumeScheduled=false;this.destroyed=false;this.defaultEncoding=e.defaultEncoding||"utf8";this.awaitDrain=0;this.readingMore=false;this.decoder=null;this.encoding=null;if(e.encoding){if(!p)p=J("string_decoder/").StringDecoder;this.decoder=new p(e.encoding);this.encoding=e.encoding}}function m(e){a=a||J("./_stream_duplex");if(!(this instanceof m))return new m(e);this._readableState=new v(e,this);this.readable=true;if(e){if(typeof e.read==="function")this._read=e.read;if(typeof e.destroy==="function")this._destroy=e.destroy}i.call(this)}Object.defineProperty(m.prototype,"destroyed",{get:function(){if(this._readableState===undefined){return false}return this._readableState.destroyed},set:function(e){if(!this._readableState){return}this._readableState.destroyed=e}});m.prototype.destroy=d.destroy;m.prototype._undestroy=d.undestroy;m.prototype._destroy=function(e,t){this.push(null);t(e)};m.prototype.push=function(e,t){var r=this._readableState;var n;if(!r.objectMode){if(typeof e==="string"){t=t||r.defaultEncoding;if(t!==r.encoding){e=s.from(e,t);t=""}n=true}}else{n=true}return _(this,e,t,false,n)};m.prototype.unshift=function(e){return _(this,e,null,true,false)};function _(e,t,r,n,i){var o=e._readableState;if(t===null){o.reading=false;P(e,o)}else{var a;if(!i)a=T(o,t);if(a){e.emit("error",a)}else if(o.objectMode||t&&t.length>0){if(typeof t!=="string"&&!o.objectMode&&Object.getPrototypeOf(t)!==s.prototype){t=c(t)}if(n){if(o.endEmitted)e.emit("error",new Error("stream.unshift() after end event"));else S(e,o,t,true)}else if(o.ended){e.emit("error",new Error("stream.push() after EOF"))}else{o.reading=false;if(o.decoder&&!r){t=o.decoder.write(t);if(o.objectMode||t.length!==0)S(e,o,t,false);else M(e,o)}else{S(e,o,t,false)}}}else if(!n){o.reading=false}}return k(o)}function S(e,t,r,n){if(t.flowing&&t.length===0&&!t.sync){e.emit("data",r);e.read(0)}else{t.length+=t.objectMode?1:r.length;if(n)t.buffer.unshift(r);else t.buffer.push(r);if(t.needReadable)A(e)}M(e,t)}function T(e,t){var r;if(!o(t)&&typeof t!=="string"&&t!==undefined&&!e.objectMode){r=new TypeError("Invalid non-string/buffer chunk")}return r}function k(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||e.length===0)}m.prototype.isPaused=function(){return this._readableState.flowing===false};m.prototype.setEncoding=function(e){if(!p)p=J("string_decoder/").StringDecoder;this._readableState.decoder=new p(e);this._readableState.encoding=e;return this};var E=8388608;function R(e){if(e>=E){e=E}else{e--;e|=e>>>1;e|=e>>>2;e|=e>>>4;e|=e>>>8;e|=e>>>16;e++}return e}function x(e,t){if(e<=0||t.length===0&&t.ended)return 0;if(t.objectMode)return 1;if(e!==e){if(t.flowing&&t.length)return t.buffer.head.data.length;else return t.length}if(e>t.highWaterMark)t.highWaterMark=R(e);if(e<=t.length)return e;if(!t.ended){t.needReadable=true;return 0}return t.length}m.prototype.read=function(e){w("read",e);e=parseInt(e,10);var t=this._readableState;var r=e;if(e!==0)t.emittedReadable=false;if(e===0&&t.needReadable&&(t.length>=t.highWaterMark||t.ended)){w("read: emitReadable",t.length,t.ended);if(t.length===0&&t.ended)W(this);else A(this);return null}e=x(e,t);if(e===0&&t.ended){if(t.length===0)W(this);return null}var n=t.needReadable;w("need readable",n);if(t.length===0||t.length-e<t.highWaterMark){n=true;w("length less than watermark",n)}if(t.ended||t.reading){n=false;w("reading or ended",n)}else if(n){w("do read");t.reading=true;t.sync=true;if(t.length===0)t.needReadable=true;this._read(t.highWaterMark);t.sync=false;if(!t.reading)e=x(r,t)}var i;if(e>0)i=F(e,t);else i=null;if(i===null){t.needReadable=true;e=0}else{t.length-=e}if(t.length===0){if(!t.ended)t.needReadable=true;if(r!==e&&t.ended)W(this)}if(i!==null)this.emit("data",i);return i};function P(e,t){if(t.ended)return;if(t.decoder){var r=t.decoder.end();if(r&&r.length){t.buffer.push(r);t.length+=t.objectMode?1:r.length}}t.ended=true;A(e)}function A(e){var t=e._readableState;t.needReadable=false;if(!t.emittedReadable){w("emitReadable",t.flowing);t.emittedReadable=true;if(t.sync)y.nextTick(O,e);else O(e)}}function O(e){w("emit readable");e.emit("readable");B(e)}function M(e,t){if(!t.readingMore){t.readingMore=true;y.nextTick(L,e,t)}}function L(e,t){var r=t.length;while(!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark){w("maybeReadMore read 0");e.read(0);if(r===t.length)break;else r=t.length}t.readingMore=false}m.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))};m.prototype.pipe=function(r,e){var n=this;var i=this._readableState;switch(i.pipesCount){case 0:i.pipes=r;break;case 1:i.pipes=[i.pipes,r];break;default:i.pipes.push(r);break}i.pipesCount+=1;w("pipe count=%d opts=%j",i.pipesCount,e);var t=(!e||e.end!==false)&&r!==g.stdout&&r!==g.stderr;var o=t?s:m;if(i.endEmitted)y.nextTick(o);else n.once("end",o);r.on("unpipe",a);function a(e,t){w("onunpipe");if(e===n){if(t&&t.hasUnpiped===false){t.hasUnpiped=true;u()}}}function s(){w("onend");r.end()}var c=D(n);r.on("drain",c);var f=false;function u(){w("cleanup");r.removeListener("close",h);r.removeListener("finish",v);r.removeListener("drain",c);r.removeListener("error",p);r.removeListener("unpipe",a);n.removeListener("end",s);n.removeListener("end",m);n.removeListener("data",d);f=true;if(i.awaitDrain&&(!r._writableState||r._writableState.needDrain))c()}var l=false;n.on("data",d);function d(e){w("ondata");l=false;var t=r.write(e);if(false===t&&!l){if((i.pipesCount===1&&i.pipes===r||i.pipesCount>1&&H(i.pipes,r)!==-1)&&!f){w("false write response, pause",n._readableState.awaitDrain);n._readableState.awaitDrain++;l=true}n.pause()}}function p(e){w("onerror",e);m();r.removeListener("error",p);if(b(r,"error")===0)r.emit("error",e)}C(r,"error",p);function h(){r.removeListener("finish",v);m()}r.once("close",h);function v(){w("onfinish");r.removeListener("close",h);m()}r.once("finish",v);function m(){w("unpipe");n.unpipe(r)}r.emit("pipe",n);if(!i.flowing){w("pipe resume");n.resume()}return r};function D(t){return function(){var e=t._readableState;w("pipeOnDrain",e.awaitDrain);if(e.awaitDrain)e.awaitDrain--;if(e.awaitDrain===0&&b(t,"data")){e.flowing=true;B(t)}}}m.prototype.unpipe=function(e){var t=this._readableState;var r={hasUnpiped:false};if(t.pipesCount===0)return this;if(t.pipesCount===1){if(e&&e!==t.pipes)return this;if(!e)e=t.pipes;t.pipes=null;t.pipesCount=0;t.flowing=false;if(e)e.emit("unpipe",this,r);return this}if(!e){var n=t.pipes;var i=t.pipesCount;t.pipes=null;t.pipesCount=0;t.flowing=false;for(var o=0;o<i;o++){n[o].emit("unpipe",this,r)}return this}var a=H(t.pipes,e);if(a===-1)return this;t.pipes.splice(a,1);t.pipesCount-=1;if(t.pipesCount===1)t.pipes=t.pipes[0];e.emit("unpipe",this,r);return this};m.prototype.on=function(e,t){var r=i.prototype.on.call(this,e,t);if(e==="data"){if(this._readableState.flowing!==false)this.resume()}else if(e==="readable"){var n=this._readableState;if(!n.endEmitted&&!n.readableListening){n.readableListening=n.needReadable=true;n.emittedReadable=false;if(!n.reading){y.nextTick(I,this)}else if(n.length){A(this)}}}return r};m.prototype.addListener=m.prototype.on;function I(e){w("readable nexttick read 0");e.read(0)}m.prototype.resume=function(){var e=this._readableState;if(!e.flowing){w("resume");e.flowing=true;j(this,e)}return this};function j(e,t){if(!t.resumeScheduled){t.resumeScheduled=true;y.nextTick(N,e,t)}}function N(e,t){if(!t.reading){w("resume read 0");e.read(0)}t.resumeScheduled=false;t.awaitDrain=0;e.emit("resume");B(e);if(t.flowing&&!t.reading)e.read(0)}m.prototype.pause=function(){w("call pause flowing=%j",this._readableState.flowing);if(false!==this._readableState.flowing){w("pause");this._readableState.flowing=false;this.emit("pause")}return this};function B(e){var t=e._readableState;w("flow",t.flowing);while(t.flowing&&e.read()!==null){}}m.prototype.wrap=function(r){var n=this;var i=this._readableState;var o=false;r.on("end",function(){w("wrapped end");if(i.decoder&&!i.ended){var e=i.decoder.end();if(e&&e.length)n.push(e)}n.push(null)});r.on("data",function(e){w("wrapped data");if(i.decoder)e=i.decoder.write(e);if(i.objectMode&&(e===null||e===undefined))return;else if(!i.objectMode&&(!e||!e.length))return;var t=n.push(e);if(!t){o=true;r.pause()}});for(var e in r){if(this[e]===undefined&&typeof r[e]==="function"){this[e]=function(e){return function(){return r[e].apply(r,arguments)}}(e)}}for(var t=0;t<h.length;t++){r.on(h[t],this.emit.bind(this,h[t]))}this._read=function(e){w("wrapped _read",e);if(o){o=false;r.resume()}};return this};Object.defineProperty(m.prototype,"readableHighWaterMark",{enumerable:false,get:function(){return this._readableState.highWaterMark}});m._fromList=F;function F(e,t){if(t.length===0)return null;var r;if(t.objectMode)r=t.buffer.shift();else if(!e||e>=t.length){if(t.decoder)r=t.buffer.join("");else if(t.buffer.length===1)r=t.buffer.head.data;else r=t.buffer.concat(t.length);t.buffer.clear()}else{r=U(e,t.buffer,t.decoder)}return r}function U(e,t,r){var n;if(e<t.head.data.length){n=t.head.data.slice(0,e);t.head.data=t.head.data.slice(e)}else if(e===t.head.data.length){n=t.shift()}else{n=r?q(e,t):z(e,t)}return n}function q(e,t){var r=t.head;var n=1;var i=r.data;e-=i.length;while(r=r.next){var o=r.data;var a=e>o.length?o.length:e;if(a===o.length)i+=o;else i+=o.slice(0,e);e-=a;if(e===0){if(a===o.length){++n;if(r.next)t.head=r.next;else t.head=t.tail=null}else{t.head=r;r.data=o.slice(a)}break}++n}t.length-=n;return i}function z(e,t){var r=s.allocUnsafe(e);var n=t.head;var i=1;n.data.copy(r);e-=n.data.length;while(n=n.next){var o=n.data;var a=e>o.length?o.length:e;o.copy(r,r.length-e,0,a);e-=a;if(e===0){if(a===o.length){++i;if(n.next)t.head=n.next;else t.head=t.tail=null}else{t.head=n;n.data=o.slice(a)}break}++i}t.length-=i;return r}function W(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');if(!t.endEmitted){t.ended=true;y.nextTick(G,t,e)}}function G(e,t){if(!e.endEmitted&&e.length===0){e.endEmitted=true;t.readable=false;t.emit("end")}}function H(e,t){for(var r=0,n=e.length;r<n;r++){if(e[r]===t)return r}return-1}}).call(this,J("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./_stream_duplex":43,"./internal/streams/BufferList":48,"./internal/streams/destroy":49,"./internal/streams/stream":50,_process:41,"core-util-is":12,events:27,inherits:34,isarray:36,"process-nextick-args":40,"safe-buffer":53,"string_decoder/":65,util:7}],46:[function(e,t,r){"use strict";t.exports=a;var n=e("./_stream_duplex");var i=e("core-util-is");i.inherits=e("inherits");i.inherits(a,n);function o(e,t){var r=this._transformState;r.transforming=false;var n=r.writecb;if(!n){return this.emit("error",new Error("write callback called multiple times"))}r.writechunk=null;r.writecb=null;if(t!=null)this.push(t);n(e);var i=this._readableState;i.reading=false;if(i.needReadable||i.length<i.highWaterMark){this._read(i.highWaterMark)}}function a(e){if(!(this instanceof a))return new a(e);n.call(this,e);this._transformState={afterTransform:o.bind(this),needTransform:false,transforming:false,writecb:null,writechunk:null,writeencoding:null};this._readableState.needReadable=true;this._readableState.sync=false;if(e){if(typeof e.transform==="function")this._transform=e.transform;if(typeof e.flush==="function")this._flush=e.flush}this.on("prefinish",s)}function s(){var r=this;if(typeof this._flush==="function"){this._flush(function(e,t){c(r,e,t)})}else{c(this,null,null)}}a.prototype.push=function(e,t){this._transformState.needTransform=false;return n.prototype.push.call(this,e,t)};a.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")};a.prototype._write=function(e,t,r){var n=this._transformState;n.writecb=r;n.writechunk=e;n.writeencoding=t;if(!n.transforming){var i=this._readableState;if(n.needTransform||i.needReadable||i.length<i.highWaterMark)this._read(i.highWaterMark)}};a.prototype._read=function(e){var t=this._transformState;if(t.writechunk!==null&&t.writecb&&!t.transforming){t.transforming=true;this._transform(t.writechunk,t.writeencoding,t.afterTransform)}else{t.needTransform=true}};a.prototype._destroy=function(e,t){var r=this;n.prototype._destroy.call(this,e,function(e){t(e);r.emit("close")})};function c(e,t,r){if(t)return e.emit("error",t);if(r!=null)e.push(r);if(e._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(e._transformState.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}},{"./_stream_duplex":43,"core-util-is":12,inherits:34}],47:[function(j,N,e){(function(e,t){"use strict";var a=j("process-nextick-args");N.exports=y;function r(e,t,r){this.chunk=e;this.encoding=t;this.callback=r;this.next=null}function d(e){var t=this;this.next=null;this.entry=null;this.finish=function(){I(t,e)}}var s=!e.browser&&["v0.10","v0.9."].indexOf(e.version.slice(0,5))>-1?setImmediate:a.nextTick;var c;y.WritableState=m;var n=j("core-util-is");n.inherits=j("inherits");var i={deprecate:j("util-deprecate")};var o=j("./internal/streams/stream");var f=j("safe-buffer").Buffer;var u=t.Uint8Array||function(){};function l(e){return f.from(e)}function p(e){return f.isBuffer(e)||e instanceof u}var h=j("./internal/streams/destroy");n.inherits(y,o);function v(){}function m(e,t){c=c||j("./_stream_duplex");e=e||{};var r=t instanceof c;this.objectMode=!!e.objectMode;if(r)this.objectMode=this.objectMode||!!e.writableObjectMode;var n=e.highWaterMark;var i=e.writableHighWaterMark;var o=this.objectMode?16:16*1024;if(n||n===0)this.highWaterMark=n;else if(r&&(i||i===0))this.highWaterMark=i;else this.highWaterMark=o;this.highWaterMark=Math.floor(this.highWaterMark);this.finalCalled=false;this.needDrain=false;this.ending=false;this.ended=false;this.finished=false;this.destroyed=false;var a=e.decodeStrings===false;this.decodeStrings=!a;this.defaultEncoding=e.defaultEncoding||"utf8";this.length=0;this.writing=false;this.corked=0;this.sync=true;this.bufferProcessing=false;this.onwrite=function(e){E(t,e)};this.writecb=null;this.writelen=0;this.bufferedRequest=null;this.lastBufferedRequest=null;this.pendingcb=0;this.prefinished=false;this.errorEmitted=false;this.bufferedRequestCount=0;this.corkedRequestsFree=new d(this)}m.prototype.getBuffer=function e(){var t=this.bufferedRequest;var r=[];while(t){r.push(t);t=t.next}return r};(function(){try{Object.defineProperty(m.prototype,"buffer",{get:i.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer "+"instead.","DEP0003")})}catch(e){}})();var g;if(typeof Symbol==="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]==="function"){g=Function.prototype[Symbol.hasInstance];Object.defineProperty(y,Symbol.hasInstance,{value:function(e){if(g.call(this,e))return true;if(this!==y)return false;return e&&e._writableState instanceof m}})}else{g=function(e){return e instanceof this}}function y(e){c=c||j("./_stream_duplex");if(!g.call(y,this)&&!(this instanceof c)){return new y(e)}this._writableState=new m(e,this);this.writable=true;if(e){if(typeof e.write==="function")this._write=e.write;if(typeof e.writev==="function")this._writev=e.writev;if(typeof e.destroy==="function")this._destroy=e.destroy;if(typeof e.final==="function")this._final=e.final}o.call(this)}y.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function b(e,t){var r=new Error("write after end");e.emit("error",r);a.nextTick(t,r)}function w(e,t,r,n){var i=true;var o=false;if(r===null){o=new TypeError("May not write null values to stream")}else if(typeof r!=="string"&&r!==undefined&&!t.objectMode){o=new TypeError("Invalid non-string/buffer chunk")}if(o){e.emit("error",o);a.nextTick(n,o);i=false}return i}y.prototype.write=function(e,t,r){var n=this._writableState;var i=false;var o=!n.objectMode&&p(e);if(o&&!f.isBuffer(e)){e=l(e)}if(typeof t==="function"){r=t;t=null}if(o)t="buffer";else if(!t)t=n.defaultEncoding;if(typeof r!=="function")r=v;if(n.ended)b(this,r);else if(o||w(this,n,e,r)){n.pendingcb++;i=_(this,n,o,e,t,r)}return i};y.prototype.cork=function(){var e=this._writableState;e.corked++};y.prototype.uncork=function(){var e=this._writableState;if(e.corked){e.corked--;if(!e.writing&&!e.corked&&!e.finished&&!e.bufferProcessing&&e.bufferedRequest)P(this,e)}};y.prototype.setDefaultEncoding=function e(t){if(typeof t==="string")t=t.toLowerCase();if(!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+t);this._writableState.defaultEncoding=t;return this};function C(e,t,r){if(!e.objectMode&&e.decodeStrings!==false&&typeof t==="string"){t=f.from(t,r)}return t}Object.defineProperty(y.prototype,"writableHighWaterMark",{enumerable:false,get:function(){return this._writableState.highWaterMark}});function _(e,t,r,n,i,o){if(!r){var a=C(t,n,i);if(n!==a){r=true;i="buffer";n=a}}var s=t.objectMode?1:n.length;t.length+=s;var c=t.length<t.highWaterMark;if(!c)t.needDrain=true;if(t.writing||t.corked){var f=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null};if(f){f.next=t.lastBufferedRequest}else{t.bufferedRequest=t.lastBufferedRequest}t.bufferedRequestCount+=1}else{S(e,t,false,s,n,i,o)}return c}function S(e,t,r,n,i,o,a){t.writelen=n;t.writecb=a;t.writing=true;t.sync=true;if(r)e._writev(i,t.onwrite);else e._write(i,o,t.onwrite);t.sync=false}function T(e,t,r,n,i){--t.pendingcb;if(r){a.nextTick(i,n);a.nextTick(L,e,t);e._writableState.errorEmitted=true;e.emit("error",n)}else{i(n);e._writableState.errorEmitted=true;e.emit("error",n);L(e,t)}}function k(e){e.writing=false;e.writecb=null;e.length-=e.writelen;e.writelen=0}function E(e,t){var r=e._writableState;var n=r.sync;var i=r.writecb;k(r);if(t)T(e,r,n,t,i);else{var o=A(r);if(!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest){P(e,r)}if(n){s(R,e,r,o,i)}else{R(e,r,o,i)}}}function R(e,t,r,n){if(!r)x(e,t);t.pendingcb--;n();L(e,t)}function x(e,t){if(t.length===0&&t.needDrain){t.needDrain=false;e.emit("drain")}}function P(e,t){t.bufferProcessing=true;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount;var i=new Array(n);var o=t.corkedRequestsFree;o.entry=r;var a=0;var s=true;while(r){i[a]=r;if(!r.isBuf)s=false;r=r.next;a+=1}i.allBuffers=s;S(e,t,true,t.length,i,"",o.finish);t.pendingcb++;t.lastBufferedRequest=null;if(o.next){t.corkedRequestsFree=o.next;o.next=null}else{t.corkedRequestsFree=new d(t)}t.bufferedRequestCount=0}else{while(r){var c=r.chunk;var f=r.encoding;var u=r.callback;var l=t.objectMode?1:c.length;S(e,t,false,l,c,f,u);r=r.next;t.bufferedRequestCount--;if(t.writing){break}}if(r===null)t.lastBufferedRequest=null}t.bufferedRequest=r;t.bufferProcessing=false}y.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))};y.prototype._writev=null;y.prototype.end=function(e,t,r){var n=this._writableState;if(typeof e==="function"){r=e;e=null;t=null}else if(typeof t==="function"){r=t;t=null}if(e!==null&&e!==undefined)this.write(e,t);if(n.corked){n.corked=1;this.uncork()}if(!n.ending&&!n.finished)D(this,n,r)};function A(e){return e.ending&&e.length===0&&e.bufferedRequest===null&&!e.finished&&!e.writing}function O(t,r){t._final(function(e){r.pendingcb--;if(e){t.emit("error",e)}r.prefinished=true;t.emit("prefinish");L(t,r)})}function M(e,t){if(!t.prefinished&&!t.finalCalled){if(typeof e._final==="function"){t.pendingcb++;t.finalCalled=true;a.nextTick(O,e,t)}else{t.prefinished=true;e.emit("prefinish")}}}function L(e,t){var r=A(t);if(r){M(e,t);if(t.pendingcb===0){t.finished=true;e.emit("finish")}}return r}function D(e,t,r){t.ending=true;L(e,t);if(r){if(t.finished)a.nextTick(r);else e.once("finish",r)}t.ended=true;e.writable=false}function I(e,t,r){var n=e.entry;e.entry=null;while(n){var i=n.callback;t.pendingcb--;i(r);n=n.next}if(t.corkedRequestsFree){t.corkedRequestsFree.next=e}else{t.corkedRequestsFree=e}}Object.defineProperty(y.prototype,"destroyed",{get:function(){if(this._writableState===undefined){return false}return this._writableState.destroyed},set:function(e){if(!this._writableState){return}this._writableState.destroyed=e}});y.prototype.destroy=h.destroy;y.prototype._undestroy=h.undestroy;y.prototype._destroy=function(e,t){this.end();t(e)}}).call(this,j("_process"),typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./_stream_duplex":43,"./internal/streams/destroy":49,"./internal/streams/stream":50,_process:41,"core-util-is":12,inherits:34,"process-nextick-args":40,"safe-buffer":53,"util-deprecate":67}],48:[function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}var o=e("safe-buffer").Buffer;var i=e("util");function a(e,t,r){e.copy(t,r)}t.exports=function(){function e(){n(this,e);this.head=null;this.tail=null;this.length=0}e.prototype.push=function e(t){var r={data:t,next:null};if(this.length>0)this.tail.next=r;else this.head=r;this.tail=r;++this.length};e.prototype.unshift=function e(t){var r={data:t,next:this.head};if(this.length===0)this.tail=r;this.head=r;++this.length};e.prototype.shift=function e(){if(this.length===0)return;var t=this.head.data;if(this.length===1)this.head=this.tail=null;else this.head=this.head.next;--this.length;return t};e.prototype.clear=function e(){this.head=this.tail=null;this.length=0};e.prototype.join=function e(t){if(this.length===0)return"";var r=this.head;var n=""+r.data;while(r=r.next){n+=t+r.data}return n};e.prototype.concat=function e(t){if(this.length===0)return o.alloc(0);if(this.length===1)return this.head.data;var r=o.allocUnsafe(t>>>0);var n=this.head;var i=0;while(n){a(n.data,r,i);i+=n.data.length;n=n.next}return r};return e}();if(i&&i.inspect&&i.inspect.custom){t.exports.prototype[i.inspect.custom]=function(){var e=i.inspect({length:this.length});return this.constructor.name+" "+e}}},{"safe-buffer":53,util:7}],49:[function(e,t,r){"use strict";var o=e("process-nextick-args");function n(e,t){var r=this;var n=this._readableState&&this._readableState.destroyed;var i=this._writableState&&this._writableState.destroyed;if(n||i){if(t){t(e)}else if(e&&(!this._writableState||!this._writableState.errorEmitted)){o.nextTick(a,this,e)}return this}if(this._readableState){this._readableState.destroyed=true}if(this._writableState){this._writableState.destroyed=true}this._destroy(e||null,function(e){if(!t&&e){o.nextTick(a,r,e);if(r._writableState){r._writableState.errorEmitted=true}}else if(t){t(e)}});return this}function i(){if(this._readableState){this._readableState.destroyed=false;this._readableState.reading=false;this._readableState.ended=false;this._readableState.endEmitted=false}if(this._writableState){this._writableState.destroyed=false;this._writableState.ended=false;this._writableState.ending=false;this._writableState.finished=false;this._writableState.errorEmitted=false}}function a(e,t){e.emit("error",t)}t.exports={destroy:n,undestroy:i}},{"process-nextick-args":40}],50:[function(e,t,r){t.exports=e("events").EventEmitter},{events:27}],51:[function(e,t,r){r=t.exports=e("./lib/_stream_readable.js");r.Stream=r;r.Readable=r;r.Writable=e("./lib/_stream_writable.js");r.Duplex=e("./lib/_stream_duplex.js");r.Transform=e("./lib/_stream_transform.js");r.PassThrough=e("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":43,"./lib/_stream_passthrough.js":44,"./lib/_stream_readable.js":45,"./lib/_stream_transform.js":46,"./lib/_stream_writable.js":47}],52:[function(e,t,r){"use strict";var N=e("sdp");function o(e){return{inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type}function c(e,t,r,n,i){var o=N.writeRtpDescription(e.kind,t);o+=N.writeIceParameters(e.iceGatherer.getLocalParameters());o+=N.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":i||"active");o+="a=mid:"+e.mid+"\r\n";if(e.rtpSender&&e.rtpReceiver){o+="a=sendrecv\r\n"}else if(e.rtpSender){o+="a=sendonly\r\n"}else if(e.rtpReceiver){o+="a=recvonly\r\n"}else{o+="a=inactive\r\n"}if(e.rtpSender){var a=e.rtpSender._initialTrackId||e.rtpSender.track.id;e.rtpSender._initialTrackId=a;var s="msid:"+(n?n.id:"-")+" "+a+"\r\n";o+="a="+s;o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+s;if(e.sendEncodingParameters[0].rtx){o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+s;o+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}o+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+N.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){o+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+N.localCName+"\r\n"}return o}function a(e,n){var i=false;e=JSON.parse(JSON.stringify(e));return e.filter(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;if(e.url&&!e.urls){console.warn("RTCIceServer.url is deprecated! Use urls instead.")}var r=typeof t==="string";if(r){t=[t]}t=t.filter(function(e){var t=e.indexOf("turn:")===0&&e.indexOf("transport=udp")!==-1&&e.indexOf("turn:[")===-1&&!i;if(t){i=true;return true}return e.indexOf("stun:")===0&&n>=14393&&e.indexOf("?transport=udp")===-1});delete e.url;e.urls=r?t[0]:t;return!!t.length}})}function v(n,i){var o={codecs:[],headerExtensions:[],fecMechanisms:[]};var a=function(e,t){e=parseInt(e,10);for(var r=0;r<t.length;r++){if(t[r].payloadType===e||t[r].preferredPayloadType===e){return t[r]}}};var s=function(e,t,r,n){var i=a(e.parameters.apt,r);var o=a(t.parameters.apt,n);return i&&o&&i.name.toLowerCase()===o.name.toLowerCase()};n.codecs.forEach(function(r){for(var e=0;e<i.codecs.length;e++){var t=i.codecs[e];if(r.name.toLowerCase()===t.name.toLowerCase()&&r.clockRate===t.clockRate){if(r.name.toLowerCase()==="rtx"&&r.parameters&&t.parameters.apt){if(!s(r,t,n.codecs,i.codecs)){continue}}t=JSON.parse(JSON.stringify(t));t.numChannels=Math.min(r.numChannels,t.numChannels);o.codecs.push(t);t.rtcpFeedback=t.rtcpFeedback.filter(function(e){for(var t=0;t<r.rtcpFeedback.length;t++){if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter){return true}}return false});break}}});n.headerExtensions.forEach(function(e){for(var t=0;t<i.headerExtensions.length;t++){var r=i.headerExtensions[t];if(e.uri===r.uri){o.headerExtensions.push(r);break}}});return o}function s(e,t,r){return{offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(r)!==-1}function B(e,t){var r=e.getRemoteCandidates().find(function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type});if(!r){e.addRemoteCandidate(t)}return!r}function l(e,t){var r=new Error(t);r.name=e;r.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:undefined,OperationError:undefined}[e];return r}t.exports=function(L,D){function I(e,t){t.addTrack(e);t.dispatchEvent(new L.MediaStreamTrackEvent("addtrack",{track:e}))}function j(e,t){t.removeTrack(e);t.dispatchEvent(new L.MediaStreamTrackEvent("removetrack",{track:e}))}function i(e,t,r,n){var i=new Event("track");i.track=t;i.receiver=r;i.transceiver={receiver:r};i.streams=n;L.setTimeout(function(){e._dispatchEvent("track",i)})}var n=function(e){var t=this;var r=document.createDocumentFragment();["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){t[e]=r[e].bind(r)});this.canTrickleIceCandidates=null;this.needNegotiation=false;this.localStreams=[];this.remoteStreams=[];this.localDescription=null;this.remoteDescription=null;this.signalingState="stable";this.iceConnectionState="new";this.connectionState="new";this.iceGatheringState="new";e=JSON.parse(JSON.stringify(e||{}));this.usingBundle=e.bundlePolicy==="max-bundle";if(e.rtcpMuxPolicy==="negotiate"){throw l("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported")}else if(!e.rtcpMuxPolicy){e.rtcpMuxPolicy="require"}switch(e.iceTransportPolicy){case"all":case"relay":break;default:e.iceTransportPolicy="all";break}switch(e.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:e.bundlePolicy="balanced";break}e.iceServers=a(e.iceServers||[],D);this._iceGatherers=[];if(e.iceCandidatePoolSize){for(var n=e.iceCandidatePoolSize;n>0;n--){this._iceGatherers.push(new L.RTCIceGatherer({iceServers:e.iceServers,gatherPolicy:e.iceTransportPolicy}))}}else{e.iceCandidatePoolSize=0}this._config=e;this.transceivers=[];this._sdpSessionId=N.generateSessionId();this._sdpSessionVersion=0;this._dtlsRole=undefined;this._isClosed=false};n.prototype.onicecandidate=null;n.prototype.onaddstream=null;n.prototype.ontrack=null;n.prototype.onremovestream=null;n.prototype.onsignalingstatechange=null;n.prototype.oniceconnectionstatechange=null;n.prototype.onconnectionstatechange=null;n.prototype.onicegatheringstatechange=null;n.prototype.onnegotiationneeded=null;n.prototype.ondatachannel=null;n.prototype._dispatchEvent=function(e,t){if(this._isClosed){return}this.dispatchEvent(t);if(typeof this["on"+e]==="function"){this["on"+e](t)}};n.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)};n.prototype.getConfiguration=function(){return this._config};n.prototype.getLocalStreams=function(){return this.localStreams};n.prototype.getRemoteStreams=function(){return this.remoteStreams};n.prototype._createTransceiver=function(e,t){var r=this.transceivers.length>0;var n={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:true};if(this.usingBundle&&r){n.iceTransport=this.transceivers[0].iceTransport;n.dtlsTransport=this.transceivers[0].dtlsTransport}else{var i=this._createIceAndDtlsTransports();n.iceTransport=i.iceTransport;n.dtlsTransport=i.dtlsTransport}if(!t){this.transceivers.push(n)}return n};n.prototype.addTrack=function(t,e){if(this._isClosed){throw l("InvalidStateError","Attempted to call addTrack on a closed peerconnection.")}var r=this.transceivers.find(function(e){return e.track===t});if(r){throw l("InvalidAccessError","Track already exists.")}var n;for(var i=0;i<this.transceivers.length;i++){if(!this.transceivers[i].track&&this.transceivers[i].kind===t.kind){n=this.transceivers[i]}}if(!n){n=this._createTransceiver(t.kind)}this._maybeFireNegotiationNeeded();if(this.localStreams.indexOf(e)===-1){this.localStreams.push(e)}n.track=t;n.stream=e;n.rtpSender=new L.RTCRtpSender(t,n.dtlsTransport);return n.rtpSender};n.prototype.addStream=function(t){var r=this;if(D>=15025){t.getTracks().forEach(function(e){r.addTrack(e,t)})}else{var n=t.clone();t.getTracks().forEach(function(e,t){var r=n.getTracks()[t];e.addEventListener("enabled",function(e){r.enabled=e.enabled})});n.getTracks().forEach(function(e){r.addTrack(e,n)})}};n.prototype.removeTrack=function(t){if(this._isClosed){throw l("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.")}if(!(t instanceof L.RTCRtpSender)){throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack "+"does not implement interface RTCRtpSender.")}var e=this.transceivers.find(function(e){return e.rtpSender===t});if(!e){throw l("InvalidAccessError","Sender was not created by this connection.")}var r=e.stream;e.rtpSender.stop();e.rtpSender=null;e.track=null;e.stream=null;var n=this.transceivers.map(function(e){return e.stream});if(n.indexOf(r)===-1&&this.localStreams.indexOf(r)>-1){this.localStreams.splice(this.localStreams.indexOf(r),1)}this._maybeFireNegotiationNeeded()};n.prototype.removeStream=function(e){var r=this;e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){r.removeTrack(e)}})};n.prototype.getSenders=function(){return this.transceivers.filter(function(e){return!!e.rtpSender}).map(function(e){return e.rtpSender})};n.prototype.getReceivers=function(){return this.transceivers.filter(function(e){return!!e.rtpReceiver}).map(function(e){return e.rtpReceiver})};n.prototype._createIceGatherer=function(r,e){var n=this;if(e&&r>0){return this.transceivers[0].iceGatherer}else if(this._iceGatherers.length){return this._iceGatherers.shift()}var i=new L.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});Object.defineProperty(i,"state",{value:"new",writable:true});this.transceivers[r].bufferedCandidateEvents=[];this.transceivers[r].bufferCandidates=function(e){var t=!e.candidate||Object.keys(e.candidate).length===0;i.state=t?"completed":"gathering";if(n.transceivers[r].bufferedCandidateEvents!==null){n.transceivers[r].bufferedCandidateEvents.push(e)}};i.addEventListener("localcandidate",this.transceivers[r].bufferCandidates);return i};n.prototype._gather=function(s,c){var f=this;var u=this.transceivers[c].iceGatherer;if(u.onlocalcandidate){return}var e=this.transceivers[c].bufferedCandidateEvents;this.transceivers[c].bufferedCandidateEvents=null;u.removeEventListener("localcandidate",this.transceivers[c].bufferCandidates);u.onlocalcandidate=function(e){if(f.usingBundle&&c>0){return}var t=new Event("icecandidate");t.candidate={sdpMid:s,sdpMLineIndex:c};var r=e.candidate;var n=!r||Object.keys(r).length===0;if(n){if(u.state==="new"||u.state==="gathering"){u.state="completed"}}else{if(u.state==="new"){u.state="gathering"}r.component=1;r.ufrag=u.getLocalParameters().usernameFragment;var i=N.writeCandidate(r);t.candidate=Object.assign(t.candidate,N.parseCandidate(i));t.candidate.candidate=i;t.candidate.toJSON=function(){return{candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex,usernameFragment:t.candidate.usernameFragment}}}var o=N.getMediaSections(f.localDescription.sdp);if(!n){o[t.candidate.sdpMLineIndex]+="a="+t.candidate.candidate+"\r\n"}else{o[t.candidate.sdpMLineIndex]+="a=end-of-candidates\r\n"}f.localDescription.sdp=N.getDescription(f.localDescription.sdp)+o.join("");var a=f.transceivers.every(function(e){return e.iceGatherer&&e.iceGatherer.state==="completed"});if(f.iceGatheringState!=="gathering"){f.iceGatheringState="gathering";f._emitGatheringStateChange()}if(!n){f._dispatchEvent("icecandidate",t)}if(a){f._dispatchEvent("icecandidate",new Event("icecandidate"));f.iceGatheringState="complete";f._emitGatheringStateChange()}};L.setTimeout(function(){e.forEach(function(e){u.onlocalcandidate(e)})},0)};n.prototype._createIceAndDtlsTransports=function(){var e=this;var t=new L.RTCIceTransport(null);t.onicestatechange=function(){e._updateIceConnectionState();e._updateConnectionState()};var r=new L.RTCDtlsTransport(t);r.ondtlsstatechange=function(){e._updateConnectionState()};r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:true});e._updateConnectionState()};return{iceTransport:t,dtlsTransport:r}};n.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;if(t){delete t.onlocalcandidate;delete this.transceivers[e].iceGatherer}var r=this.transceivers[e].iceTransport;if(r){delete r.onicestatechange;delete this.transceivers[e].iceTransport}var n=this.transceivers[e].dtlsTransport;if(n){delete n.ondtlsstatechange;delete n.onerror;delete this.transceivers[e].dtlsTransport}};n.prototype._transceive=function(e,t,r){var n=v(e.localCapabilities,e.remoteCapabilities);if(t&&e.rtpSender){n.encodings=e.sendEncodingParameters;n.rtcp={cname:N.localCName,compound:e.rtcpParameters.compound};if(e.recvEncodingParameters.length){n.rtcp.ssrc=e.recvEncodingParameters[0].ssrc}e.rtpSender.send(n)}if(r&&e.rtpReceiver&&n.codecs.length>0){if(e.kind==="video"&&e.recvEncodingParameters&&D<15019){e.recvEncodingParameters.forEach(function(e){delete e.rtx})}if(e.recvEncodingParameters.length){n.encodings=e.recvEncodingParameters}else{n.encodings=[{}]}n.rtcp={compound:e.rtcpParameters.compound};if(e.rtcpParameters.cname){n.rtcp.cname=e.rtcpParameters.cname}if(e.sendEncodingParameters.length){n.rtcp.ssrc=e.sendEncodingParameters[0].ssrc}e.rtpReceiver.receive(n)}};n.prototype.setLocalDescription=function(e){var d=this;if(["offer","answer"].indexOf(e.type)===-1){return Promise.reject(l("TypeError",'Unsupported type "'+e.type+'"'))}if(!s("setLocalDescription",e.type,d.signalingState)||d._isClosed){return Promise.reject(l("InvalidStateError","Can not set local "+e.type+" in state "+d.signalingState))}var t;var p;if(e.type==="offer"){t=N.splitSections(e.sdp);p=t.shift();t.forEach(function(e,t){var r=N.parseRtpParameters(e);d.transceivers[t].localCapabilities=r});d.transceivers.forEach(function(e,t){d._gather(e.mid,t)})}else if(e.type==="answer"){t=N.splitSections(d.remoteDescription.sdp);p=t.shift();var h=N.matchPrefix(p,"a=ice-lite").length>0;t.forEach(function(e,t){var r=d.transceivers[t];var n=r.iceGatherer;var i=r.iceTransport;var o=r.dtlsTransport;var a=r.localCapabilities;var s=r.remoteCapabilities;var c=N.isRejected(e)&&N.matchPrefix(e,"a=bundle-only").length===0;if(!c&&!r.rejected){var f=N.getIceParameters(e,p);var u=N.getDtlsParameters(e,p);if(h){u.role="server"}if(!d.usingBundle||t===0){d._gather(r.mid,t);if(i.state==="new"){i.start(n,f,h?"controlling":"controlled")}if(o.state==="new"){o.start(u)}}var l=v(a,s);d._transceive(r,l.codecs.length>0,false)}})}d.localDescription={type:e.type,sdp:e.sdp};if(e.type==="offer"){d._updateSignalingState("have-local-offer")}else{d._updateSignalingState("stable")}return Promise.resolve()};n.prototype.setRemoteDescription=function(E){var R=this;if(["offer","answer"].indexOf(E.type)===-1){return Promise.reject(l("TypeError",'Unsupported type "'+E.type+'"'))}if(!s("setRemoteDescription",E.type,R.signalingState)||R._isClosed){return Promise.reject(l("InvalidStateError","Can not set remote "+E.type+" in state "+R.signalingState))}var x={};R.remoteStreams.forEach(function(e){x[e.id]=e});var P=[];var e=N.splitSections(E.sdp);var A=e.shift();var O=N.matchPrefix(A,"a=ice-lite").length>0;var M=N.matchPrefix(A,"a=group:BUNDLE ").length>0;R.usingBundle=M;var t=N.matchPrefix(A,"a=ice-options:")[0];if(t){R.canTrickleIceCandidates=t.substr(14).split(" ").indexOf("trickle")>=0}else{R.canTrickleIceCandidates=false}e.forEach(function(e,t){var r=N.splitLines(e);var n=N.getKind(e);var i=N.isRejected(e)&&N.matchPrefix(e,"a=bundle-only").length===0;var o=r[0].substr(2).split(" ")[2];var a=N.getDirection(e,A);var s=N.parseMsid(e);var c=N.getMid(e)||N.generateIdentifier();if(n==="application"&&o==="DTLS/SCTP"||i){R.transceivers[t]={mid:c,kind:n,rejected:true};return}if(!i&&R.transceivers[t]&&R.transceivers[t].rejected){R.transceivers[t]=R._createTransceiver(n,true)}var f;var u;var l;var d;var p;var h;var v;var m;var g;var y=N.parseRtpParameters(e);var b;var w;if(!i){b=N.getIceParameters(e,A);w=N.getDtlsParameters(e,A);w.role="client"}v=N.parseRtpEncodingParameters(e);var C=N.parseRtcpParameters(e);var _=N.matchPrefix(e,"a=end-of-candidates",A).length>0;var S=N.matchPrefix(e,"a=candidate:").map(function(e){return N.parseCandidate(e)}).filter(function(e){return e.component===1});if((E.type==="offer"||E.type==="answer")&&!i&&M&&t>0&&R.transceivers[t]){R._disposeIceAndDtlsTransports(t);R.transceivers[t].iceGatherer=R.transceivers[0].iceGatherer;R.transceivers[t].iceTransport=R.transceivers[0].iceTransport;R.transceivers[t].dtlsTransport=R.transceivers[0].dtlsTransport;if(R.transceivers[t].rtpSender){R.transceivers[t].rtpSender.setTransport(R.transceivers[0].dtlsTransport)}if(R.transceivers[t].rtpReceiver){R.transceivers[t].rtpReceiver.setTransport(R.transceivers[0].dtlsTransport)}}if(E.type==="offer"&&!i){f=R.transceivers[t]||R._createTransceiver(n);f.mid=c;if(!f.iceGatherer){f.iceGatherer=R._createIceGatherer(t,M)}if(S.length&&f.iceTransport.state==="new"){if(_&&(!M||t===0)){f.iceTransport.setRemoteCandidates(S)}else{S.forEach(function(e){B(f.iceTransport,e)})}}m=L.RTCRtpReceiver.getCapabilities(n);if(D<15019){m.codecs=m.codecs.filter(function(e){return e.name!=="rtx"})}h=f.sendEncodingParameters||[{ssrc:(2*t+2)*1001}];var T=false;if(a==="sendrecv"||a==="sendonly"){T=!f.rtpReceiver;p=f.rtpReceiver||new L.RTCRtpReceiver(f.dtlsTransport,n);if(T){var k;g=p.track;if(s&&s.stream==="-"){}else if(s){if(!x[s.stream]){x[s.stream]=new L.MediaStream;Object.defineProperty(x[s.stream],"id",{get:function(){return s.stream}})}Object.defineProperty(g,"id",{get:function(){return s.track}});k=x[s.stream]}else{if(!x.default){x.default=new L.MediaStream}k=x.default}if(k){I(g,k);f.associatedRemoteMediaStreams.push(k)}P.push([g,p,k])}}else if(f.rtpReceiver&&f.rtpReceiver.track){f.associatedRemoteMediaStreams.forEach(function(e){var t=e.getTracks().find(function(e){return e.id===f.rtpReceiver.track.id});if(t){j(t,e)}});f.associatedRemoteMediaStreams=[]}f.localCapabilities=m;f.remoteCapabilities=y;f.rtpReceiver=p;f.rtcpParameters=C;f.sendEncodingParameters=h;f.recvEncodingParameters=v;R._transceive(R.transceivers[t],false,T)}else if(E.type==="answer"&&!i){f=R.transceivers[t];u=f.iceGatherer;l=f.iceTransport;d=f.dtlsTransport;p=f.rtpReceiver;h=f.sendEncodingParameters;m=f.localCapabilities;R.transceivers[t].recvEncodingParameters=v;R.transceivers[t].remoteCapabilities=y;R.transceivers[t].rtcpParameters=C;if(S.length&&l.state==="new"){if((O||_)&&(!M||t===0)){l.setRemoteCandidates(S)}else{S.forEach(function(e){B(f.iceTransport,e)})}}if(!M||t===0){if(l.state==="new"){l.start(u,b,"controlling")}if(d.state==="new"){d.start(w)}}R._transceive(f,a==="sendrecv"||a==="recvonly",a==="sendrecv"||a==="sendonly");if(p&&(a==="sendrecv"||a==="sendonly")){g=p.track;if(s){if(!x[s.stream]){x[s.stream]=new L.MediaStream}I(g,x[s.stream]);P.push([g,p,x[s.stream]])}else{if(!x.default){x.default=new L.MediaStream}I(g,x.default);P.push([g,p,x.default])}}else{delete f.rtpReceiver}}});if(R._dtlsRole===undefined){R._dtlsRole=E.type==="offer"?"active":"passive"}R.remoteDescription={type:E.type,sdp:E.sdp};if(E.type==="offer"){R._updateSignalingState("have-remote-offer")}else{R._updateSignalingState("stable")}Object.keys(x).forEach(function(e){var n=x[e];if(n.getTracks().length){if(R.remoteStreams.indexOf(n)===-1){R.remoteStreams.push(n);var t=new Event("addstream");t.stream=n;L.setTimeout(function(){R._dispatchEvent("addstream",t)})}P.forEach(function(e){var t=e[0];var r=e[1];if(n.id!==e[2].id){return}i(R,t,r,[n])})}});P.forEach(function(e){if(e[2]){return}i(R,e[0],e[1],[])});L.setTimeout(function(){if(!(R&&R.transceivers)){return}R.transceivers.forEach(function(e){if(e.iceTransport&&e.iceTransport.state==="new"&&e.iceTransport.getRemoteCandidates().length>0){console.warn("Timeout for addRemoteCandidate. Consider sending "+"an end-of-candidates notification");e.iceTransport.addRemoteCandidate({})}})},4e3);return Promise.resolve()};n.prototype.close=function(){this.transceivers.forEach(function(e){if(e.iceTransport){e.iceTransport.stop()}if(e.dtlsTransport){e.dtlsTransport.stop()}if(e.rtpSender){e.rtpSender.stop()}if(e.rtpReceiver){e.rtpReceiver.stop()}});this._isClosed=true;this._updateSignalingState("closed")};n.prototype._updateSignalingState=function(e){this.signalingState=e;var t=new Event("signalingstatechange");this._dispatchEvent("signalingstatechange",t)};n.prototype._maybeFireNegotiationNeeded=function(){var t=this;if(this.signalingState!=="stable"||this.needNegotiation===true){return}this.needNegotiation=true;L.setTimeout(function(){if(t.needNegotiation){t.needNegotiation=false;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}},0)};n.prototype._updateIceConnectionState=function(){var e;var t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++});e="new";if(t.failed>0){e="failed"}else if(t.checking>0){e="checking"}else if(t.disconnected>0){e="disconnected"}else if(t.new>0){e="new"}else if(t.connected>0){e="connected"}else if(t.completed>0){e="completed"}if(e!==this.iceConnectionState){this.iceConnectionState=e;var r=new Event("iceconnectionstatechange");this._dispatchEvent("iceconnectionstatechange",r)}};n.prototype._updateConnectionState=function(){var e;var t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach(function(e){t[e.iceTransport.state]++;t[e.dtlsTransport.state]++});t.connected+=t.completed;e="new";if(t.failed>0){e="failed"}else if(t.connecting>0){e="connecting"}else if(t.disconnected>0){e="disconnected"}else if(t.new>0){e="new"}else if(t.connected>0){e="connected"}if(e!==this.connectionState){this.connectionState=e;var r=new Event("connectionstatechange");this._dispatchEvent("connectionstatechange",r)}};n.prototype.createOffer=function(){var s=this;if(s._isClosed){return Promise.reject(l("InvalidStateError","Can not call createOffer after close"))}var t=s.transceivers.filter(function(e){return e.kind==="audio"}).length;var r=s.transceivers.filter(function(e){return e.kind==="video"}).length;var e=arguments[0];if(e){if(e.mandatory||e.optional){throw new TypeError("Legacy mandatory/optional constraints not supported.")}if(e.offerToReceiveAudio!==undefined){if(e.offerToReceiveAudio===true){t=1}else if(e.offerToReceiveAudio===false){t=0}else{t=e.offerToReceiveAudio}}if(e.offerToReceiveVideo!==undefined){if(e.offerToReceiveVideo===true){r=1}else if(e.offerToReceiveVideo===false){r=0}else{r=e.offerToReceiveVideo}}}s.transceivers.forEach(function(e){if(e.kind==="audio"){t--;if(t<0){e.wantReceive=false}}else if(e.kind==="video"){r--;if(r<0){e.wantReceive=false}}});while(t>0||r>0){if(t>0){s._createTransceiver("audio");t--}if(r>0){s._createTransceiver("video");r--}}var n=N.writeSessionBoilerplate(s._sdpSessionId,s._sdpSessionVersion++);s.transceivers.forEach(function(r,e){var t=r.track;var n=r.kind;var i=r.mid||N.generateIdentifier();r.mid=i;if(!r.iceGatherer){r.iceGatherer=s._createIceGatherer(e,s.usingBundle)}var o=L.RTCRtpSender.getCapabilities(n);if(D<15019){o.codecs=o.codecs.filter(function(e){return e.name!=="rtx"})}o.codecs.forEach(function(t){if(t.name==="H264"&&t.parameters["level-asymmetry-allowed"]===undefined){t.parameters["level-asymmetry-allowed"]="1"}if(r.remoteCapabilities&&r.remoteCapabilities.codecs){r.remoteCapabilities.codecs.forEach(function(e){if(t.name.toLowerCase()===e.name.toLowerCase()&&t.clockRate===e.clockRate){t.preferredPayloadType=e.payloadType}})}});o.headerExtensions.forEach(function(t){var e=r.remoteCapabilities&&r.remoteCapabilities.headerExtensions||[];e.forEach(function(e){if(t.uri===e.uri){t.id=e.id}})});var a=r.sendEncodingParameters||[{ssrc:(2*e+1)*1001}];if(t){if(D>=15019&&n==="video"&&!a[0].rtx){a[0].rtx={ssrc:a[0].ssrc+1}}}if(r.wantReceive){r.rtpReceiver=new L.RTCRtpReceiver(r.dtlsTransport,n)}r.localCapabilities=o;r.sendEncodingParameters=a});if(s._config.bundlePolicy!=="max-compat"){n+="a=group:BUNDLE "+s.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}n+="a=ice-options:trickle\r\n";s.transceivers.forEach(function(e,t){n+=c(e,e.localCapabilities,"offer",e.stream,s._dtlsRole);n+="a=rtcp-rsize\r\n";if(e.iceGatherer&&s.iceGatheringState!=="new"&&(t===0||!s.usingBundle)){e.iceGatherer.getLocalCandidates().forEach(function(e){e.component=1;n+="a="+N.writeCandidate(e)+"\r\n"});if(e.iceGatherer.state==="completed"){n+="a=end-of-candidates\r\n"}}});var i=new L.RTCSessionDescription({type:"offer",sdp:n});return Promise.resolve(i)};n.prototype.createAnswer=function(){var o=this;if(o._isClosed){return Promise.reject(l("InvalidStateError","Can not call createAnswer after close"))}if(!(o.signalingState==="have-remote-offer"||o.signalingState==="have-local-pranswer")){return Promise.reject(l("InvalidStateError","Can not call createAnswer in signalingState "+o.signalingState))}var a=N.writeSessionBoilerplate(o._sdpSessionId,o._sdpSessionVersion++);if(o.usingBundle){a+="a=group:BUNDLE "+o.transceivers.map(function(e){return e.mid}).join(" ")+"\r\n"}var s=N.getMediaSections(o.remoteDescription.sdp).length;o.transceivers.forEach(function(e,t){if(t+1>s){return}if(e.rejected){if(e.kind==="application"){a+="m=application 0 DTLS/SCTP 5000\r\n"}else if(e.kind==="audio"){a+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\n"+"a=rtpmap:0 PCMU/8000\r\n"}else if(e.kind==="video"){a+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\n"+"a=rtpmap:120 VP8/90000\r\n"}a+="c=IN IP4 0.0.0.0\r\n"+"a=inactive\r\n"+"a=mid:"+e.mid+"\r\n";return}if(e.stream){var r;if(e.kind==="audio"){r=e.stream.getAudioTracks()[0]}else if(e.kind==="video"){r=e.stream.getVideoTracks()[0]}if(r){if(D>=15019&&e.kind==="video"&&!e.sendEncodingParameters[0].rtx){e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1}}}}var n=v(e.localCapabilities,e.remoteCapabilities);var i=n.codecs.filter(function(e){return e.name.toLowerCase()==="rtx"}).length;if(!i&&e.sendEncodingParameters[0].rtx){delete e.sendEncodingParameters[0].rtx}a+=c(e,n,"answer",e.stream,o._dtlsRole);if(e.rtcpParameters&&e.rtcpParameters.reducedSize){a+="a=rtcp-rsize\r\n"}});var e=new L.RTCSessionDescription({type:"answer",sdp:a});return Promise.resolve(e)};n.prototype.addIceCandidate=function(c){var f=this;var u;if(c&&!(c.sdpMLineIndex!==undefined||c.sdpMid)){return Promise.reject(new TypeError("sdpMLineIndex or sdpMid required"))}return new Promise(function(e,t){if(!f.remoteDescription){return t(l("InvalidStateError","Can not add ICE candidate without a remote description"))}else if(!c||c.candidate===""){for(var r=0;r<f.transceivers.length;r++){if(f.transceivers[r].rejected){continue}f.transceivers[r].iceTransport.addRemoteCandidate({});u=N.getMediaSections(f.remoteDescription.sdp);u[r]+="a=end-of-candidates\r\n";f.remoteDescription.sdp=N.getDescription(f.remoteDescription.sdp)+u.join("");if(f.usingBundle){break}}}else{var n=c.sdpMLineIndex;if(c.sdpMid){for(var i=0;i<f.transceivers.length;i++){if(f.transceivers[i].mid===c.sdpMid){n=i;break}}}var o=f.transceivers[n];if(o){if(o.rejected){return e()}var a=Object.keys(c.candidate).length>0?N.parseCandidate(c.candidate):{};if(a.protocol==="tcp"&&(a.port===0||a.port===9)){return e()}if(a.component&&a.component!==1){return e()}if(n===0||n>0&&o.iceTransport!==f.transceivers[0].iceTransport){if(!B(o.iceTransport,a)){return t(l("OperationError","Can not add ICE candidate"))}}var s=c.candidate.trim();if(s.indexOf("a=")===0){s=s.substr(2)}u=N.getMediaSections(f.remoteDescription.sdp);u[n]+="a="+(a.type?s:"end-of-candidates")+"\r\n";f.remoteDescription.sdp=N.getDescription(f.remoteDescription.sdp)+u.join("")}else{return t(l("OperationError","Can not add ICE candidate"))}}e()})};n.prototype.getStats=function(t){if(t&&t instanceof L.MediaStreamTrack){var r=null;this.transceivers.forEach(function(e){if(e.rtpSender&&e.rtpSender.track===t){r=e.rtpSender}else if(e.rtpReceiver&&e.rtpReceiver.track===t){r=e.rtpReceiver}});if(!r){throw l("InvalidAccessError","Invalid selector.")}return r.getStats()}var n=[];this.transceivers.forEach(function(t){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach(function(e){if(t[e]){n.push(t[e].getStats())}})});return Promise.all(n).then(function(e){var t=new Map;e.forEach(function(e){e.forEach(function(e){t.set(e.id,e)})});return t})};var e=["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"];e.forEach(function(e){var t=L[e];if(t&&t.prototype&&t.prototype.getStats){var r=t.prototype.getStats;t.prototype.getStats=function(){return r.apply(this).then(function(t){var r=new Map;Object.keys(t).forEach(function(e){t[e].type=o(t[e]);r.set(e,t[e])});return r})}}});var t=["createOffer","createAnswer"];t.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;if(typeof t[0]==="function"||typeof t[1]==="function"){return r.apply(this,[arguments[2]]).then(function(e){if(typeof t[0]==="function"){t[0].apply(null,[e])}},function(e){if(typeof t[1]==="function"){t[1].apply(null,[e])}})}return r.apply(this,arguments)}});t=["setLocalDescription","setRemoteDescription","addIceCandidate"];t.forEach(function(e){var r=n.prototype[e];n.prototype[e]=function(){var t=arguments;if(typeof t[1]==="function"||typeof t[2]==="function"){return r.apply(this,arguments).then(function(){if(typeof t[1]==="function"){t[1].apply(null)}},function(e){if(typeof t[2]==="function"){t[2].apply(null,[e])}})}return r.apply(this,arguments)}});["getStats"].forEach(function(e){var t=n.prototype[e];n.prototype[e]=function(){var e=arguments;if(typeof e[1]==="function"){return t.apply(this,arguments).then(function(){if(typeof e[1]==="function"){e[1].apply(null)}})}return t.apply(this,arguments)}});return n}},{sdp:54}],53:[function(e,t,r){var n=e("buffer");var i=n.Buffer;function o(e,t){for(var r in e){t[r]=e[r]}}if(i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow){t.exports=n}else{o(n,r);r.Buffer=a}function a(e,t,r){return i(e,t,r)}o(i,a);a.from=function(e,t,r){if(typeof e==="number"){throw new TypeError("Argument must not be a number")}return i(e,t,r)};a.alloc=function(e,t,r){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}var n=i(e);if(t!==undefined){if(typeof r==="string"){n.fill(t,r)}else{n.fill(t)}}else{n.fill(0)}return n};a.allocUnsafe=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return i(e)};a.allocUnsafeSlow=function(e){if(typeof e!=="number"){throw new TypeError("Argument must be a number")}return n.SlowBuffer(e)}},{buffer:8}],54:[function(e,t,r){"use strict";var u={};u.generateIdentifier=function(){return Math.random().toString(36).substr(2,10)};u.localCName=u.generateIdentifier();u.splitLines=function(e){return e.trim().split("\n").map(function(e){return e.trim()})};u.splitSections=function(e){var t=e.split("\nm=");return t.map(function(e,t){return(t>0?"m="+e:e).trim()+"\r\n"})};u.getDescription=function(e){var t=u.splitSections(e);return t&&t[0]};u.getMediaSections=function(e){var t=u.splitSections(e);t.shift();return t};u.matchPrefix=function(e,t){return u.splitLines(e).filter(function(e){return e.indexOf(t)===0})};u.parseCandidate=function(e){var t;if(e.indexOf("a=candidate:")===0){t=e.substring(12).split(" ")}else{t=e.substring(10).split(" ")}var r={foundation:t[0],component:parseInt(t[1],10),protocol:t[2].toLowerCase(),priority:parseInt(t[3],10),ip:t[4],port:parseInt(t[5],10),type:t[7]};for(var n=8;n<t.length;n+=2){switch(t[n]){case"raddr":r.relatedAddress=t[n+1];break;case"rport":r.relatedPort=parseInt(t[n+1],10);break;case"tcptype":r.tcpType=t[n+1];break;case"ufrag":r.ufrag=t[n+1];r.usernameFragment=t[n+1];break;default:r[t[n]]=t[n+1];break}}return r};u.writeCandidate=function(e){var t=[];t.push(e.foundation);t.push(e.component);t.push(e.protocol.toUpperCase());t.push(e.priority);t.push(e.ip);t.push(e.port);var r=e.type;t.push("typ");t.push(r);if(r!=="host"&&e.relatedAddress&&e.relatedPort){t.push("raddr");t.push(e.relatedAddress);t.push("rport");t.push(e.relatedPort)}if(e.tcpType&&e.protocol.toLowerCase()==="tcp"){t.push("tcptype");t.push(e.tcpType)}if(e.usernameFragment||e.ufrag){t.push("ufrag");t.push(e.usernameFragment||e.ufrag)}return"candidate:"+t.join(" ")};u.parseIceOptions=function(e){return e.substr(14).split(" ")};u.parseRtpMap=function(e){var t=e.substr(9).split(" ");var r={payloadType:parseInt(t.shift(),10)};t=t[0].split("/");r.name=t[0];r.clockRate=parseInt(t[1],10);r.numChannels=t.length===3?parseInt(t[2],10):1;return r};u.writeRtpMap=function(e){var t=e.payloadType;if(e.preferredPayloadType!==undefined){t=e.preferredPayloadType}return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(e.numChannels!==1?"/"+e.numChannels:"")+"\r\n"};u.parseExtmap=function(e){var t=e.substr(9).split(" ");return{id:parseInt(t[0],10),direction:t[0].indexOf("/")>0?t[0].split("/")[1]:"sendrecv",uri:t[1]}};u.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&e.direction!=="sendrecv"?"/"+e.direction:"")+" "+e.uri+"\r\n"};u.parseFmtp=function(e){var t={};var r;var n=e.substr(e.indexOf(" ")+1).split(";");for(var i=0;i<n.length;i++){r=n[i].trim().split("=");t[r[0].trim()]=r[1]}return t};u.writeFmtp=function(t){var e="";var r=t.payloadType;if(t.preferredPayloadType!==undefined){r=t.preferredPayloadType}if(t.parameters&&Object.keys(t.parameters).length){var n=[];Object.keys(t.parameters).forEach(function(e){if(t.parameters[e]){n.push(e+"="+t.parameters[e])}else{n.push(e)}});e+="a=fmtp:"+r+" "+n.join(";")+"\r\n"}return e};u.parseRtcpFb=function(e){var t=e.substr(e.indexOf(" ")+1).split(" ");return{type:t.shift(),parameter:t.join(" ")}};u.writeRtcpFb=function(e){var t="";var r=e.payloadType;if(e.preferredPayloadType!==undefined){r=e.preferredPayloadType}if(e.rtcpFeedback&&e.rtcpFeedback.length){e.rtcpFeedback.forEach(function(e){t+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})}return t};u.parseSsrcMedia=function(e){var t=e.indexOf(" ");var r={ssrc:parseInt(e.substr(7,t-7),10)};var n=e.indexOf(":",t);if(n>-1){r.attribute=e.substr(t+1,n-t-1);r.value=e.substr(n+1)}else{r.attribute=e.substr(t+1)}return r};u.getMid=function(e){var t=u.matchPrefix(e,"a=mid:")[0];if(t){return t.substr(6)}};u.parseFingerprint=function(e){var t=e.substr(14).split(" ");return{algorithm:t[0].toLowerCase(),value:t[1]}};u.getDtlsParameters=function(e,t){var r=u.matchPrefix(e+t,"a=fingerprint:");return{role:"auto",fingerprints:r.map(u.parseFingerprint)}};u.writeDtlsParameters=function(e,t){var r="a=setup:"+t+"\r\n";e.fingerprints.forEach(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"});return r};u.getIceParameters=function(e,t){var r=u.splitLines(e);r=r.concat(u.splitLines(t));var n={usernameFragment:r.filter(function(e){return e.indexOf("a=ice-ufrag:")===0})[0].substr(12),password:r.filter(function(e){return e.indexOf("a=ice-pwd:")===0})[0].substr(10)};return n};u.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\n"+"a=ice-pwd:"+e.password+"\r\n"};u.parseRtpParameters=function(e){var t={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]};var r=u.splitLines(e);var n=r[0].split(" ");for(var i=3;i<n.length;i++){var o=n[i];var a=u.matchPrefix(e,"a=rtpmap:"+o+" ")[0];if(a){var s=u.parseRtpMap(a);var c=u.matchPrefix(e,"a=fmtp:"+o+" ");s.parameters=c.length?u.parseFmtp(c[0]):{};s.rtcpFeedback=u.matchPrefix(e,"a=rtcp-fb:"+o+" ").map(u.parseRtcpFb);t.codecs.push(s);switch(s.name.toUpperCase()){case"RED":case"ULPFEC":t.fecMechanisms.push(s.name.toUpperCase());break;default:break}}}u.matchPrefix(e,"a=extmap:").forEach(function(e){t.headerExtensions.push(u.parseExtmap(e))});return t};u.writeRtpDescription=function(e,t){var r="";r+="m="+e+" ";r+=t.codecs.length>0?"9":"0";r+=" UDP/TLS/RTP/SAVPF ";r+=t.codecs.map(function(e){if(e.preferredPayloadType!==undefined){return e.preferredPayloadType}return e.payloadType}).join(" ")+"\r\n";r+="c=IN IP4 0.0.0.0\r\n";r+="a=rtcp:9 IN IP4 0.0.0.0\r\n";t.codecs.forEach(function(e){r+=u.writeRtpMap(e);r+=u.writeFmtp(e);r+=u.writeRtcpFb(e)});var n=0;t.codecs.forEach(function(e){if(e.maxptime>n){n=e.maxptime}});if(n>0){r+="a=maxptime:"+n+"\r\n"}r+="a=rtcp-mux\r\n";t.headerExtensions.forEach(function(e){r+=u.writeExtmap(e)});return r};u.parseRtpEncodingParameters=function(e){var r=[];var t=u.parseRtpParameters(e);var n=t.fecMechanisms.indexOf("RED")!==-1;var i=t.fecMechanisms.indexOf("ULPFEC")!==-1;var o=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"});var a=o.length>0&&o[0].ssrc;var s;var c=u.matchPrefix(e,"a=ssrc-group:FID").map(function(e){var t=e.substr(17).split(" ");return t.map(function(e){return parseInt(e,10)})});if(c.length>0&&c[0].length>1&&c[0][0]===a){s=c[0][1]}t.codecs.forEach(function(e){if(e.name.toUpperCase()==="RTX"&&e.parameters.apt){var t={ssrc:a,codecPayloadType:parseInt(e.parameters.apt,10),rtx:{ssrc:s}};r.push(t);if(n){t=JSON.parse(JSON.stringify(t));t.fec={ssrc:s,mechanism:i?"red+ulpfec":"red"};r.push(t)}}});if(r.length===0&&a){r.push({ssrc:a})}var f=u.matchPrefix(e,"b=");if(f.length){if(f[0].indexOf("b=TIAS:")===0){f=parseInt(f[0].substr(7),10)}else if(f[0].indexOf("b=AS:")===0){f=parseInt(f[0].substr(5),10)*1e3*.95-50*40*8}else{f=undefined}r.forEach(function(e){e.maxBitrate=f})}return r};u.parseRtcpParameters=function(e){var t={};var r;var n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="cname"})[0];if(n){t.cname=n.value;t.ssrc=n.ssrc}var i=u.matchPrefix(e,"a=rtcp-rsize");t.reducedSize=i.length>0;t.compound=i.length===0;var o=u.matchPrefix(e,"a=rtcp-mux");t.mux=o.length>0;return t};u.parseMsid=function(e){var t;var r=u.matchPrefix(e,"a=msid:");if(r.length===1){t=r[0].substr(7).split(" ");return{stream:t[0],track:t[1]}}var n=u.matchPrefix(e,"a=ssrc:").map(function(e){return u.parseSsrcMedia(e)}).filter(function(e){return e.attribute==="msid"});if(n.length>0){t=n[0].value.split(" ");return{stream:t[0],track:t[1]}}};u.generateSessionId=function(){return Math.random().toString().substr(2,21)};u.writeSessionBoilerplate=function(e,t){var r;var n=t!==undefined?t:2;if(e){r=e}else{r=u.generateSessionId()}return"v=0\r\n"+"o=thisisadapterortc "+r+" "+n+" IN IP4 127.0.0.1\r\n"+"s=-\r\n"+"t=0 0\r\n"};u.writeMediaSection=function(e,t,r,n){var i=u.writeRtpDescription(e.kind,t);i+=u.writeIceParameters(e.iceGatherer.getLocalParameters());i+=u.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),r==="offer"?"actpass":"active");i+="a=mid:"+e.mid+"\r\n";if(e.direction){i+="a="+e.direction+"\r\n"}else if(e.rtpSender&&e.rtpReceiver){i+="a=sendrecv\r\n"}else if(e.rtpSender){i+="a=sendonly\r\n"}else if(e.rtpReceiver){i+="a=recvonly\r\n"}else{i+="a=inactive\r\n"}if(e.rtpSender){var o="msid:"+n.id+" "+e.rtpSender.track.id+"\r\n";i+="a="+o;i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+o;if(e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+o;i+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n"}}i+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+u.localCName+"\r\n";if(e.rtpSender&&e.sendEncodingParameters[0].rtx){i+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+u.localCName+"\r\n"}return i};u.getDirection=function(e,t){var r=u.splitLines(e);for(var n=0;n<r.length;n++){switch(r[n]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[n].substr(2);default:}}if(t){return u.getDirection(t)}return"sendrecv"};u.getKind=function(e){var t=u.splitLines(e);var r=t[0].split(" ");return r[0].substr(2)};u.isRejected=function(e){return e.split(" ",2)[1]==="0"};u.parseMLine=function(e){var t=u.splitLines(e);var r=t[0].substr(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}};u.parseOLine=function(e){var t=u.matchPrefix(e,"o=")[0];var r=t.substr(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}};if(typeof t==="object"){t.exports=u}},{}],55:[function(t,l,e){(function(n){l.exports=c;var r=t("debug")("simple-peer");var i=t("get-browser-rtc");var e=t("inherits");var o=t("randombytes");var a=t("readable-stream");var s=64*1024;e(c,a.Duplex);function c(e){var t=this;if(!(t instanceof c))return new c(e);t._id=o(4).toString("hex").slice(0,7);t._debug("new peer %o",e);e=Object.assign({allowHalfOpen:false},e);a.Duplex.call(t,e);t.channelName=e.initiator?e.channelName||o(20).toString("hex"):null;t._isChromium=typeof window!=="undefined"&&!!window.webkitRTCPeerConnection;t.initiator=e.initiator||false;t.channelConfig=e.channelConfig||c.channelConfig;t.config=e.config||c.config;t.constraints=t._transformConstraints(e.constraints||c.constraints);t.offerConstraints=t._transformConstraints(e.offerConstraints||{});t.answerConstraints=t._transformConstraints(e.answerConstraints||{});t.reconnectTimer=e.reconnectTimer||false;t.sdpTransform=e.sdpTransform||function(e){return e};t.streams=e.streams||(e.stream?[e.stream]:[]);t.trickle=e.trickle!==undefined?e.trickle:true;t.destroyed=false;t.connected=false;t.remoteAddress=undefined;t.remoteFamily=undefined;t.remotePort=undefined;t.localAddress=undefined;t.localPort=undefined;t._wrtc=e.wrtc&&typeof e.wrtc==="object"?e.wrtc:i();if(!t._wrtc){if(typeof window==="undefined"){throw u("No WebRTC support: Specify `opts.wrtc` option in this environment","ERR_WEBRTC_SUPPORT")}else{throw u("No WebRTC support: Not a supported browser","ERR_WEBRTC_SUPPORT")}}t._pcReady=false;t._channelReady=false;t._iceComplete=false;t._channel=null;t._pendingCandidates=[];t._isNegotiating=false;t._batchedNegotiation=false;t._queuedNegotiation=false;t._sendersAwaitingStable=[];t._senderMap=new WeakMap;t._remoteTracks=[];t._remoteStreams=[];t._chunk=null;t._cb=null;t._interval=null;t._reconnectTimeout=null;t._pc=new t._wrtc.RTCPeerConnection(t.config,t.constraints);t._isReactNativeWebrtc=typeof t._pc._peerConnectionId==="number";t._pc.oniceconnectionstatechange=function(){t._onIceStateChange()};t._pc.onicegatheringstatechange=function(){t._onIceStateChange()};t._pc.onsignalingstatechange=function(){t._onSignalingStateChange()};t._pc.onicecandidate=function(e){t._onIceCandidate(e)};if(t.initiator){t._setupData({channel:t._pc.createDataChannel(t.channelName,t.channelConfig)})}else{t._pc.ondatachannel=function(e){t._setupData(e)}}if("addTrack"in t._pc){if(t.streams){t.streams.forEach(function(e){t.addStream(e)})}t._pc.ontrack=function(e){t._onTrack(e)}}if(t.initiator){t._needsNegotiation()}t._onFinishBound=function(){t._onFinish()};t.once("finish",t._onFinishBound)}c.WEBRTC_SUPPORT=!!i();c.config={iceServers:[{urls:"stun:stun.l.google.com:19302"},{urls:"stun:global.stun.twilio.com:3478?transport=udp"}]};c.constraints={};c.channelConfig={};Object.defineProperty(c.prototype,"bufferSize",{get:function(){var e=this;return e._channel&&e._channel.bufferedAmount||0}});c.prototype.address=function(){var e=this;return{port:e.localPort,family:"IPv4",address:e.localAddress}};c.prototype.signal=function(t){var r=this;if(r.destroyed)throw u("cannot signal after peer is destroyed","ERR_SIGNALING");if(typeof t==="string"){try{t=JSON.parse(t)}catch(e){t={}}}r._debug("signal()");if(t.renegotiate){r._debug("got request to renegotiate");r._needsNegotiation()}if(t.candidate){if(r._pc.remoteDescription&&r._pc.remoteDescription.type)r._addIceCandidate(t.candidate);else r._pendingCandidates.push(t.candidate)}if(t.sdp){r._pc.setRemoteDescription(new r._wrtc.RTCSessionDescription(t),function(){if(r.destroyed)return;r._pendingCandidates.forEach(function(e){r._addIceCandidate(e)});r._pendingCandidates=[];if(r._pc.remoteDescription.type==="offer")r._createAnswer()},function(e){r.destroy(u(e,"ERR_SET_REMOTE_DESCRIPTION"))})}if(!t.sdp&&!t.candidate&&!t.renegotiate){r.destroy(u("signal() called with invalid signal data","ERR_SIGNALING"))}};c.prototype._addIceCandidate=function(e){var t=this;try{t._pc.addIceCandidate(new t._wrtc.RTCIceCandidate(e),f,function(e){t.destroy(u(e,"ERR_ADD_ICE_CANDIDATE"))})}catch(e){t.destroy(u("error adding candidate: "+e.message,"ERR_ADD_ICE_CANDIDATE"))}};c.prototype.send=function(e){var t=this;t._channel.send(e)};c.prototype.addStream=function(t){var r=this;r._debug("addStream()");t.getTracks().forEach(function(e){r.addTrack(e,t)})};c.prototype.addTrack=function(e,t){var r=this;r._debug("addTrack()");var n=r._pc.addTrack(e,t);var i=r._senderMap.get(e)||new WeakMap;i.set(t,n);r._senderMap.set(e,i);r._needsNegotiation()};c.prototype.removeTrack=function(e,t){var r=this;r._debug("removeSender()");var n=r._senderMap.get(e);var i=n?n.get(t):null;if(!i){r.destroy(new Error("Cannot remove track that was never added."))}try{r._pc.removeTrack(i)}catch(e){if(e.name==="NS_ERROR_UNEXPECTED"){r._sendersAwaitingStable.push(i)}else{r.destroy(e)}}};c.prototype.removeStream=function(t){var r=this;r._debug("removeSenders()");t.getTracks().forEach(function(e){r.removeTrack(e,t)})};c.prototype._needsNegotiation=function(){var e=this;e._debug("_needsNegotiation");if(e._batchedNegotiation)return;e._batchedNegotiation=true;setTimeout(function(){e._batchedNegotiation=false;e._debug("starting batched negotiation");e.negotiate()},0)};c.prototype.negotiate=function(){var e=this;if(e.initiator){if(e._isNegotiating){e._queuedNegotiation=true;e._debug("already negotiating, queueing")}else{e._debug("start negotiation");e._createOffer()}}else{e._debug("requesting negotiation from initiator");e.emit("signal",{renegotiate:true})}e._isNegotiating=true};c.prototype.destroy=function(e){var t=this;t._destroy(e,function(){})};c.prototype._destroy=function(e,t){var r=this;if(r.destroyed)return;r._debug("destroy (error: %s)",e&&(e.message||e));r.readable=r.writable=false;if(!r._readableState.ended)r.push(null);if(!r._writableState.finished)r.end();r.destroyed=true;r.connected=false;r._pcReady=false;r._channelReady=false;r._remoteTracks=null;r._remoteStreams=null;r._senderMap=null;clearInterval(r._interval);clearTimeout(r._reconnectTimeout);r._interval=null;r._reconnectTimeout=null;r._chunk=null;r._cb=null;if(r._onFinishBound)r.removeListener("finish",r._onFinishBound);r._onFinishBound=null;if(r._channel){try{r._channel.close()}catch(e){}r._channel.onmessage=null;r._channel.onopen=null;r._channel.onclose=null;r._channel.onerror=null}if(r._pc){try{r._pc.close()}catch(e){}r._pc.oniceconnectionstatechange=null;r._pc.onicegatheringstatechange=null;r._pc.onsignalingstatechange=null;r._pc.onicecandidate=null;if("addTrack"in r._pc){r._pc.ontrack=null}r._pc.ondatachannel=null}r._pc=null;r._channel=null;if(e)r.emit("error",e);r.emit("close");t()};c.prototype._setupData=function(e){var t=this;if(!e.channel){return t.destroy(u("Data channel event is missing `channel` property","ERR_DATA_CHANNEL"))}t._channel=e.channel;t._channel.binaryType="arraybuffer";if(typeof t._channel.bufferedAmountLowThreshold==="number"){t._channel.bufferedAmountLowThreshold=s}t.channelName=t._channel.label;t._channel.onmessage=function(e){t._onChannelMessage(e)};t._channel.onbufferedamountlow=function(){t._onChannelBufferedAmountLow()};t._channel.onopen=function(){t._onChannelOpen()};t._channel.onclose=function(){t._onChannelClose()};t._channel.onerror=function(e){t.destroy(u(e,"ERR_DATA_CHANNEL"))}};c.prototype._read=function(){};c.prototype._write=function(e,t,r){var n=this;if(n.destroyed)return r(u("cannot write after peer is destroyed","ERR_DATA_CHANNEL"));if(n.connected){try{n.send(e)}catch(e){return n.destroy(u(e,"ERR_DATA_CHANNEL"))}if(n._channel.bufferedAmount>s){n._debug("start backpressure: bufferedAmount %d",n._channel.bufferedAmount);n._cb=r}else{r(null)}}else{n._debug("write before connect");n._chunk=e;n._cb=r}};c.prototype._onFinish=function(){var e=this;if(e.destroyed)return;if(e.connected){t()}else{e.once("connect",t)}function t(){setTimeout(function(){e.destroy()},1e3)}};c.prototype._createOffer=function(){var i=this;if(i.destroyed)return;i._pc.createOffer(function(t){if(i.destroyed)return;t.sdp=i.sdpTransform(t.sdp);i._pc.setLocalDescription(t,e,r);function e(){i._debug("createOffer success");if(i.destroyed)return;if(i.trickle||i._iceComplete)n();else i.once("_iceComplete",n)}function r(e){i.destroy(u(e,"ERR_SET_LOCAL_DESCRIPTION"))}function n(){var e=i._pc.localDescription||t;i._debug("signal");i.emit("signal",{type:e.type,sdp:e.sdp})}},function(e){i.destroy(u(e,"ERR_CREATE_OFFER"))},i.offerConstraints)};c.prototype._createAnswer=function(){var i=this;if(i.destroyed)return;i._pc.createAnswer(function(t){if(i.destroyed)return;t.sdp=i.sdpTransform(t.sdp);i._pc.setLocalDescription(t,e,r);function e(){if(i.destroyed)return;if(i.trickle||i._iceComplete)n();else i.once("_iceComplete",n)}function r(e){i.destroy(u(e,"ERR_SET_LOCAL_DESCRIPTION"))}function n(){var e=i._pc.localDescription||t;i._debug("signal");i.emit("signal",{type:e.type,sdp:e.sdp})}},function(e){i.destroy(u(e,"ERR_CREATE_ANSWER"))},i.answerConstraints)};c.prototype._onIceStateChange=function(){var e=this;if(e.destroyed)return;var t=e._pc.iceConnectionState;var r=e._pc.iceGatheringState;e._debug("iceStateChange (connection: %s) (gathering: %s)",t,r);e.emit("iceStateChange",t,r);if(t==="connected"||t==="completed"){clearTimeout(e._reconnectTimeout);e._pcReady=true;e._maybeReady()}if(t==="failed"){e.destroy(u("Ice connection failed.","ERR_ICE_CONNECTION_FAILURE"))}if(t==="closed"){e.destroy(new Error("Ice connection closed."))}};c.prototype.getStats=function(r){var t=this;if(t._pc.getStats.length===0){t._pc.getStats().then(function(e){var t=[];e.forEach(function(e){t.push(e)});r(null,t)},function(e){r(e)})}else if(t._isReactNativeWebrtc){t._pc.getStats(null,function(e){var t=[];e.forEach(function(e){t.push(e)});r(null,t)},function(e){r(e)})}else if(t._pc.getStats.length>0){t._pc.getStats(function(e){if(t.destroyed)return;var n=[];e.result().forEach(function(t){var r={};t.names().forEach(function(e){r[e]=t.stat(e)});r.id=t.id;r.type=t.type;r.timestamp=t.timestamp;n.push(r)});r(null,n)},function(e){r(e)})}else{r(null,[])}};c.prototype._maybeReady=function(){var c=this;c._debug("maybeReady pc %s channel %s",c._pcReady,c._channelReady);if(c.connected||c._connecting||!c._pcReady||!c._channelReady)return;c._connecting=true;function f(){if(c.destroyed)return;c.getStats(function(e,t){if(c.destroyed)return;if(e)t=[];var n={};var i={};var r={};var o=false;t.forEach(function(e){if(e.type==="remotecandidate"||e.type==="remote-candidate"){n[e.id]=e}if(e.type==="localcandidate"||e.type==="local-candidate"){i[e.id]=e}if(e.type==="candidatepair"||e.type==="candidate-pair"){r[e.id]=e}});t.forEach(function(e){if(e.type==="transport"&&e.selectedCandidatePairId){a(r[e.selectedCandidatePairId])}if(e.type==="googCandidatePair"&&e.googActiveConnection==="true"||(e.type==="candidatepair"||e.type==="candidate-pair")&&e.selected){a(e)}});function a(e){o=true;var t=i[e.localCandidateId];if(t&&t.ip){c.localAddress=t.ip;c.localPort=Number(t.port)}else if(t&&t.ipAddress){c.localAddress=t.ipAddress;c.localPort=Number(t.portNumber)}else if(typeof e.googLocalAddress==="string"){t=e.googLocalAddress.split(":");c.localAddress=t[0];c.localPort=Number(t[1])}var r=n[e.remoteCandidateId];if(r&&r.ip){c.remoteAddress=r.ip;c.remotePort=Number(r.port)}else if(r&&r.ipAddress){c.remoteAddress=r.ipAddress;c.remotePort=Number(r.portNumber)}else if(typeof e.googRemoteAddress==="string"){r=e.googRemoteAddress.split(":");c.remoteAddress=r[0];c.remotePort=Number(r[1])}c.remoteFamily="IPv4";c._debug("connect local: %s:%s remote: %s:%s",c.localAddress,c.localPort,c.remoteAddress,c.remotePort)}if(!o&&(!Object.keys(r).length||Object.keys(i).length)){setTimeout(f,100);return}else{c._connecting=false;c.connected=true}if(c._chunk){try{c.send(c._chunk)}catch(e){return c.destroy(u(e,"ERR_DATA_CHANNEL"))}c._chunk=null;c._debug('sent chunk from "write before connect"');var s=c._cb;c._cb=null;s(null)}if(typeof c._channel.bufferedAmountLowThreshold!=="number"){c._interval=setInterval(function(){c._onInterval()},150);if(c._interval.unref)c._interval.unref()}c._debug("connect");c.emit("connect")})}f()};c.prototype._onInterval=function(){var e=this;if(!e._cb||!e._channel||e._channel.bufferedAmount>s){return}e._onChannelBufferedAmountLow()};c.prototype._onSignalingStateChange=function(){var t=this;if(t.destroyed)return;if(t._pc.signalingState==="stable"){t._isNegotiating=false;t._debug("flushing sender queue",t._sendersAwaitingStable);t._sendersAwaitingStable.forEach(function(e){t.removeTrack(e);t._queuedNegotiation=true});t._sendersAwaitingStable=[];if(t._queuedNegotiation){t._debug("flushing negotiation queue");t._queuedNegotiation=false;t._needsNegotiation()}t._debug("negotiate");t.emit("negotiate")}t._debug("signalingStateChange %s",t._pc.signalingState);t.emit("signalingStateChange",t._pc.signalingState)};c.prototype._onIceCandidate=function(e){var t=this;if(t.destroyed)return;if(e.candidate&&t.trickle){t.emit("signal",{candidate:{candidate:e.candidate.candidate,sdpMLineIndex:e.candidate.sdpMLineIndex,sdpMid:e.candidate.sdpMid}})}else if(!e.candidate){t._iceComplete=true;t.emit("_iceComplete")}};c.prototype._onChannelMessage=function(e){var t=this;if(t.destroyed)return;var r=e.data;if(r instanceof ArrayBuffer)r=n.from(r);t.push(r)};c.prototype._onChannelBufferedAmountLow=function(){var e=this;if(e.destroyed||!e._cb)return;e._debug("ending backpressure: bufferedAmount %d",e._channel.bufferedAmount);var t=e._cb;e._cb=null;t(null)};c.prototype._onChannelOpen=function(){var e=this;if(e.connected||e.destroyed)return;e._debug("on channel open");e._channelReady=true;e._maybeReady()};c.prototype._onChannelClose=function(){var e=this;if(e.destroyed)return;e._debug("on channel close");e.destroy()};c.prototype._onTrack=function(e){var r=this;if(r.destroyed)return;e.streams.forEach(function(t){r._debug("on track");r.emit("track",e.track,t);r._remoteTracks.push({track:e.track,stream:t});if(r._remoteStreams.some(function(e){return e.id===t.id}))return;r._remoteStreams.push(t);setTimeout(function(){r.emit("stream",t)},0)})};c.prototype._debug=function(){var e=this;var t=[].slice.call(arguments);t[0]="["+e._id+"] "+t[0];r.apply(null,t)};c.prototype._transformConstraints=function(e){var t=this;if(Object.keys(e).length===0){return e}if((e.mandatory||e.optional)&&!t._isChromium){var r=Object.assign({},e.optional,e.mandatory);if(r.OfferToReceiveVideo!==undefined){r.offerToReceiveVideo=r.OfferToReceiveVideo;delete r["OfferToReceiveVideo"]}if(r.OfferToReceiveAudio!==undefined){r.offerToReceiveAudio=r.OfferToReceiveAudio;delete r["OfferToReceiveAudio"]}return r}else if(!e.mandatory&&!e.optional&&t._isChromium){if(e.offerToReceiveVideo!==undefined){e.OfferToReceiveVideo=e.offerToReceiveVideo;delete e["offerToReceiveVideo"]}if(e.offerToReceiveAudio!==undefined){e.OfferToReceiveAudio=e.offerToReceiveAudio;delete e["offerToReceiveAudio"]}return{mandatory:e}}return e};function u(e,t){var r=new Error(e);r.code=t;return r}function f(){}}).call(this,t("buffer").Buffer)},{buffer:8,debug:13,"get-browser-rtc":28,inherits:34,randombytes:42,"readable-stream":51}],56:[function(e,t,r){var f=e("./url");var n=e("socket.io-parser");var u=e("./manager");var l=e("debug")("socket.io-client");t.exports=r=i;var d=r.managers={};function i(e,t){if(typeof e==="object"){t=e;e=undefined}t=t||{};var r=f(e);var n=r.source;var i=r.id;var o=r.path;var a=d[i]&&o in d[i].nsps;var s=t.forceNew||t["force new connection"]||false===t.multiplex||a;var c;if(s){l("ignoring socket cache for %s",n);c=u(n,t)}else{if(!d[i]){l("new io instance for %s",n);d[i]=u(n,t)}c=d[i]}if(r.query&&!t.query){t.query=r.query}return c.socket(r.path,t)}r.protocol=n.protocol;r.connect=i;r.Manager=e("./manager");r.Socket=e("./socket")},{"./manager":57,"./socket":59,"./url":60,debug:13,"socket.io-parser":62}],57:[function(e,t,r){var c=e("engine.io-client");var o=e("./socket");var n=e("component-emitter");var i=e("socket.io-parser");var f=e("./on");var a=e("component-bind");var u=e("debug")("socket.io-client:manager");var s=e("indexof");var l=e("backo2");var d=Object.prototype.hasOwnProperty;t.exports=p;function p(e,t){if(!(this instanceof p))return new p(e,t);if(e&&"object"===typeof e){t=e;e=undefined}t=t||{};t.path=t.path||"/socket.io";this.nsps={};this.subs=[];this.opts=t;this.reconnection(t.reconnection!==false);this.reconnectionAttempts(t.reconnectionAttempts||Infinity);this.reconnectionDelay(t.reconnectionDelay||1e3);this.reconnectionDelayMax(t.reconnectionDelayMax||5e3);this.randomizationFactor(t.randomizationFactor||.5);this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()});this.timeout(null==t.timeout?2e4:t.timeout);this.readyState="closed";this.uri=e;this.connecting=[];this.lastPing=null;this.encoding=false;this.packetBuffer=[];var r=t.parser||i;this.encoder=new r.Encoder;this.decoder=new r.Decoder;this.autoConnect=t.autoConnect!==false;if(this.autoConnect)this.open()}p.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var e in this.nsps){if(d.call(this.nsps,e)){this.nsps[e].emit.apply(this.nsps[e],arguments)}}};p.prototype.updateSocketIds=function(){for(var e in this.nsps){if(d.call(this.nsps,e)){this.nsps[e].id=this.generateId(e)}}};p.prototype.generateId=function(e){return(e==="/"?"":e+"#")+this.engine.id};n(p.prototype);p.prototype.reconnection=function(e){if(!arguments.length)return this._reconnection;this._reconnection=!!e;return this};p.prototype.reconnectionAttempts=function(e){if(!arguments.length)return this._reconnectionAttempts;this._reconnectionAttempts=e;return this};p.prototype.reconnectionDelay=function(e){if(!arguments.length)return this._reconnectionDelay;this._reconnectionDelay=e;this.backoff&&this.backoff.setMin(e);return this};p.prototype.randomizationFactor=function(e){if(!arguments.length)return this._randomizationFactor;this._randomizationFactor=e;this.backoff&&this.backoff.setJitter(e);return this};p.prototype.reconnectionDelayMax=function(e){if(!arguments.length)return this._reconnectionDelayMax;this._reconnectionDelayMax=e;this.backoff&&this.backoff.setMax(e);return this};p.prototype.timeout=function(e){if(!arguments.length)return this._timeout;this._timeout=e;return this};p.prototype.maybeReconnectOnOpen=function(){if(!this.reconnecting&&this._reconnection&&this.backoff.attempts===0){this.reconnect()}};p.prototype.open=p.prototype.connect=function(r,e){u("readyState %s",this.readyState);if(~this.readyState.indexOf("open"))return this;u("opening %s",this.uri);this.engine=c(this.uri,this.opts);var t=this.engine;var n=this;this.readyState="opening";this.skipReconnect=false;var i=f(t,"open",function(){n.onopen();r&&r()});var o=f(t,"error",function(e){u("connect_error");n.cleanup();n.readyState="closed";n.emitAll("connect_error",e);if(r){var t=new Error("Connection error");t.data=e;r(t)}else{n.maybeReconnectOnOpen()}});if(false!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var s=setTimeout(function(){u("connect attempt timed out after %d",a);i.destroy();t.close();t.emit("error","timeout");n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(s)}})}this.subs.push(i);this.subs.push(o);return this};p.prototype.onopen=function(){u("open");this.cleanup();this.readyState="open";this.emit("open");var e=this.engine;this.subs.push(f(e,"data",a(this,"ondata")));this.subs.push(f(e,"ping",a(this,"onping")));this.subs.push(f(e,"pong",a(this,"onpong")));this.subs.push(f(e,"error",a(this,"onerror")));this.subs.push(f(e,"close",a(this,"onclose")));this.subs.push(f(this.decoder,"decoded",a(this,"ondecoded")))};p.prototype.onping=function(){this.lastPing=new Date;this.emitAll("ping")};p.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)};p.prototype.ondata=function(e){this.decoder.add(e)};p.prototype.ondecoded=function(e){this.emit("packet",e)};p.prototype.onerror=function(e){u("error",e);this.emitAll("error",e)};p.prototype.socket=function(e,t){var r=this.nsps[e];if(!r){r=new o(this,e,t);this.nsps[e]=r;var n=this;r.on("connecting",i);r.on("connect",function(){r.id=n.generateId(e)});if(this.autoConnect){i()}}function i(){if(!~s(n.connecting,r)){n.connecting.push(r)}}return r};p.prototype.destroy=function(e){var t=s(this.connecting,e);if(~t)this.connecting.splice(t,1);if(this.connecting.length)return;this.close()};p.prototype.packet=function(r){u("writing packet %j",r);var n=this;if(r.query&&r.type===0)r.nsp+="?"+r.query;if(!n.encoding){n.encoding=true;this.encoder.encode(r,function(e){for(var t=0;t<e.length;t++){n.engine.write(e[t],r.options)}n.encoding=false;n.processPacketQueue()})}else{n.packetBuffer.push(r)}};p.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}};p.prototype.cleanup=function(){u("cleanup");var e=this.subs.length;for(var t=0;t<e;t++){var r=this.subs.shift();r.destroy()}this.packetBuffer=[];this.encoding=false;this.lastPing=null;this.decoder.destroy()};p.prototype.close=p.prototype.disconnect=function(){u("disconnect");this.skipReconnect=true;this.reconnecting=false;if("opening"===this.readyState){this.cleanup()}this.backoff.reset();this.readyState="closed";if(this.engine)this.engine.close()};p.prototype.onclose=function(e){u("onclose");this.cleanup();this.backoff.reset();this.readyState="closed";this.emit("close",e);if(this._reconnection&&!this.skipReconnect){this.reconnect()}};p.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts){u("reconnect failed");this.backoff.reset();this.emitAll("reconnect_failed");this.reconnecting=false}else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e);this.reconnecting=true;var r=setTimeout(function(){if(t.skipReconnect)return;u("attempting reconnect");t.emitAll("reconnect_attempt",t.backoff.attempts);t.emitAll("reconnecting",t.backoff.attempts);if(t.skipReconnect)return;t.open(function(e){if(e){u("reconnect attempt error");t.reconnecting=false;t.reconnect();t.emitAll("reconnect_error",e.data)}else{u("reconnect success");t.onreconnect()}})},e);this.subs.push({destroy:function(){clearTimeout(r)}})}};p.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=false;this.backoff.reset();this.updateSocketIds();this.emitAll("reconnect",e)}},{"./on":58,"./socket":59,backo2:3,"component-bind":9,"component-emitter":10,debug:13,"engine.io-client":15,indexof:33,"socket.io-parser":62}],58:[function(e,t,r){t.exports=n;function n(e,t,r){e.on(t,r);return{destroy:function(){e.removeListener(t,r)}}}},{}],59:[function(e,t,r){var i=e("socket.io-parser");var n=e("component-emitter");var o=e("to-array");var a=e("./on");var s=e("component-bind");var c=e("debug")("socket.io-client:socket");var f=e("parseqs");var u=e("has-binary2");t.exports=r=p;var l={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1};var d=n.prototype.emit;function p(e,t,r){this.io=e;this.nsp=t;this.json=this;this.ids=0;this.acks={};this.receiveBuffer=[];this.sendBuffer=[];this.connected=false;this.disconnected=true;this.flags={};if(r&&r.query){this.query=r.query}if(this.io.autoConnect)this.open()}n(p.prototype);p.prototype.subEvents=function(){if(this.subs)return;var e=this.io;this.subs=[a(e,"open",s(this,"onopen")),a(e,"packet",s(this,"onpacket")),a(e,"close",s(this,"onclose"))]};p.prototype.open=p.prototype.connect=function(){if(this.connected)return this;this.subEvents();this.io.open();if("open"===this.io.readyState)this.onopen();this.emit("connecting");return this};p.prototype.send=function(){var e=o(arguments);e.unshift("message");this.emit.apply(this,e);return this};p.prototype.emit=function(e){if(l.hasOwnProperty(e)){d.apply(this,arguments);return this}var t=o(arguments);var r={type:(this.flags.binary!==undefined?this.flags.binary:u(t))?i.BINARY_EVENT:i.EVENT,data:t};r.options={};r.options.compress=!this.flags||false!==this.flags.compress;if("function"===typeof t[t.length-1]){c("emitting packet with ack id %d",this.ids);this.acks[this.ids]=t.pop();r.id=this.ids++}if(this.connected){this.packet(r)}else{this.sendBuffer.push(r)}this.flags={};return this};p.prototype.packet=function(e){e.nsp=this.nsp;this.io.packet(e)};p.prototype.onopen=function(){c("transport is open - connecting");if("/"!==this.nsp){if(this.query){var e=typeof this.query==="object"?f.encode(this.query):this.query;c("sending connect packet with query %s",e);this.packet({type:i.CONNECT,query:e})}else{this.packet({type:i.CONNECT})}}};p.prototype.onclose=function(e){c("close (%s)",e);this.connected=false;this.disconnected=true;delete this.id;this.emit("disconnect",e)};p.prototype.onpacket=function(e){var t=e.nsp===this.nsp;var r=e.type===i.ERROR&&e.nsp==="/";if(!t&&!r)return;switch(e.type){case i.CONNECT:this.onconnect();break;case i.EVENT:this.onevent(e);break;case i.BINARY_EVENT:this.onevent(e);break;case i.ACK:this.onack(e);break;case i.BINARY_ACK:this.onack(e);break;case i.DISCONNECT:this.ondisconnect();break;case i.ERROR:this.emit("error",e.data);break}};p.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t);if(null!=e.id){c("attaching ack callback to event");t.push(this.ack(e.id))}if(this.connected){d.apply(this,t)}else{this.receiveBuffer.push(t)}};p.prototype.ack=function(t){var r=this;var n=false;return function(){if(n)return;n=true;var e=o(arguments);c("sending ack %j",e);r.packet({type:u(e)?i.BINARY_ACK:i.ACK,id:t,data:e})}};p.prototype.onack=function(e){var t=this.acks[e.id];if("function"===typeof t){c("calling ack %s with %j",e.id,e.data);t.apply(this,e.data);delete this.acks[e.id]}else{c("bad ack %s",e.id)}};p.prototype.onconnect=function(){this.connected=true;this.disconnected=false;this.emit("connect");this.emitBuffered()};p.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++){d.apply(this,this.receiveBuffer[e])}this.receiveBuffer=[];for(e=0;e<this.sendBuffer.length;e++){this.packet(this.sendBuffer[e])}this.sendBuffer=[]};p.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp);this.destroy();this.onclose("io server disconnect")};p.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++){this.subs[e].destroy()}this.subs=null}this.io.destroy(this)};p.prototype.close=p.prototype.disconnect=function(){if(this.connected){c("performing disconnect (%s)",this.nsp);this.packet({type:i.DISCONNECT})}this.destroy();if(this.connected){this.onclose("io client disconnect")}return this};p.prototype.compress=function(e){this.flags.compress=e;return this};p.prototype.binary=function(e){this.flags.binary=e;return this}},{"./on":58,"component-bind":9,"component-emitter":10,debug:13,"has-binary2":29,parseqs:38,"socket.io-parser":62,"to-array":66}],60:[function(t,r,e){(function(o){var a=t("parseuri");var s=t("debug")("socket.io-client:url");r.exports=e;function e(e,t){var r=e;t=t||o.location;if(null==e)e=t.protocol+"//"+t.host;if("string"===typeof e){if("/"===e.charAt(0)){if("/"===e.charAt(1)){e=t.protocol+e}else{e=t.host+e}}if(!/^(https?|wss?):\/\//.test(e)){s("protocol-less url %s",e);if("undefined"!==typeof t){e=t.protocol+"//"+e}else{e="https://"+e}}s("parse %s",e);r=a(e)}if(!r.port){if(/^(http|ws)$/.test(r.protocol)){r.port="80"}else if(/^(http|ws)s$/.test(r.protocol)){r.port="443"}}r.path=r.path||"/";var n=r.host.indexOf(":")!==-1;var i=n?"["+r.host+"]":r.host;r.id=r.protocol+"://"+i+":"+r.port;r.href=r.protocol+"://"+i+(t&&t.port===r.port?"":":"+r.port);return r}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{debug:13,parseuri:39}],61:[function(r,e,n){(function(e){var u=r("isarray");var l=r("./is-buffer");var t=Object.prototype.toString;var d=typeof e.Blob==="function"||t.call(e.Blob)==="[object BlobConstructor]";var p=typeof e.File==="function"||t.call(e.File)==="[object FileConstructor]";n.deconstructPacket=function(e){var t=[];var r=e.data;var n=e;n.data=a(r,t);n.attachments=t.length;return{packet:n,buffers:t}};function a(e,t){if(!e)return e;if(l(e)){var r={_placeholder:true,num:t.length};t.push(e);return r}else if(u(e)){var n=new Array(e.length);for(var i=0;i<e.length;i++){n[i]=a(e[i],t)}return n}else if(typeof e==="object"&&!(e instanceof Date)){var n={};for(var o in e){n[o]=a(e[o],t)}return n}return e}n.reconstructPacket=function(e,t){e.data=i(e.data,t);e.attachments=undefined;return e};function i(e,t){if(!e)return e;if(e&&e._placeholder){return t[e.num]}else if(u(e)){for(var r=0;r<e.length;r++){e[r]=i(e[r],t)}}else if(typeof e==="object"){for(var n in e){e[n]=i(e[n],t)}}return e}n.removeBlobs=function(e,a){function s(e,t,r){if(!e)return e;if(d&&e instanceof Blob||p&&e instanceof File){c++;var n=new FileReader;n.onload=function(){if(r){r[t]=this.result}else{f=this.result}if(!--c){a(f)}};n.readAsArrayBuffer(e)}else if(u(e)){for(var i=0;i<e.length;i++){s(e[i],i,e)}}else if(typeof e==="object"&&!l(e)){for(var o in e){s(e[o],o,e)}}}var c=0;var f=e;s(f);if(!c){a(f)}}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./is-buffer":63,isarray:64}],62:[function(e,t,c){var f=e("debug")("socket.io-parser");var r=e("component-emitter");var o=e("./binary");var u=e("isarray");var n=e("./is-buffer");c.protocol=4;c.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"];c.CONNECT=0;c.DISCONNECT=1;c.EVENT=2;c.ACK=3;c.ERROR=4;c.BINARY_EVENT=5;c.BINARY_ACK=6;c.Encoder=i;c.Decoder=p;function i(){}var a=c.ERROR+'"encode error"';i.prototype.encode=function(e,t){f("encoding packet %j",e);if(c.BINARY_EVENT===e.type||c.BINARY_ACK===e.type){d(e,t)}else{var r=s(e);t([r])}};function s(e){var t=""+e.type;if(c.BINARY_EVENT===e.type||c.BINARY_ACK===e.type){t+=e.attachments+"-"}if(e.nsp&&"/"!==e.nsp){t+=e.nsp+","}if(null!=e.id){t+=e.id}if(null!=e.data){var r=l(e.data);if(r!==false){t+=r}else{return a}}f("encoded %j as %s",e,t);return t}function l(e){try{return JSON.stringify(e)}catch(e){return false}}function d(e,i){function t(e){var t=o.deconstructPacket(e);var r=s(t.packet);var n=t.buffers;n.unshift(r);i(n)}o.removeBlobs(e,t)}function p(){this.reconstructor=null}r(p.prototype);p.prototype.add=function(e){var t;if(typeof e==="string"){t=h(e);if(c.BINARY_EVENT===t.type||c.BINARY_ACK===t.type){this.reconstructor=new m(t);if(this.reconstructor.reconPack.attachments===0){this.emit("decoded",t)}}else{this.emit("decoded",t)}}else if(n(e)||e.base64){if(!this.reconstructor){throw new Error("got binary data when not reconstructing a packet")}else{t=this.reconstructor.takeBinaryData(e);if(t){this.reconstructor=null;this.emit("decoded",t)}}}else{throw new Error("Unknown type: "+e)}};function h(e){var t=0;var r={type:Number(e.charAt(0))};if(null==c.types[r.type]){return g("unknown packet type "+r.type)}if(c.BINARY_EVENT===r.type||c.BINARY_ACK===r.type){var n="";while(e.charAt(++t)!=="-"){n+=e.charAt(t);if(t==e.length)break}if(n!=Number(n)||e.charAt(t)!=="-"){throw new Error("Illegal attachments")}r.attachments=Number(n)}if("/"===e.charAt(t+1)){r.nsp="";while(++t){var i=e.charAt(t);if(","===i)break;r.nsp+=i;if(t===e.length)break}}else{r.nsp="/"}var o=e.charAt(t+1);if(""!==o&&Number(o)==o){r.id="";while(++t){var i=e.charAt(t);if(null==i||Number(i)!=i){--t;break}r.id+=e.charAt(t);if(t===e.length)break}r.id=Number(r.id)}if(e.charAt(++t)){var a=v(e.substr(t));var s=a!==false&&(r.type===c.ERROR||u(a));if(s){r.data=a}else{return g("invalid payload")}}f("decoded %s as %j",e,r);return r}function v(e){try{return JSON.parse(e)}catch(e){return false}}p.prototype.destroy=function(){if(this.reconstructor){this.reconstructor.finishedReconstruction()}};function m(e){this.reconPack=e;this.buffers=[]}m.prototype.takeBinaryData=function(e){this.buffers.push(e);if(this.buffers.length===this.reconPack.attachments){var t=o.reconstructPacket(this.reconPack,this.buffers);this.finishedReconstruction();return t}return null};m.prototype.finishedReconstruction=function(){this.reconPack=null;this.buffers=[]};function g(e){return{type:c.ERROR,data:"parser error: "+e}}},{"./binary":61,"./is-buffer":63,"component-emitter":10,debug:13,isarray:64}],63:[function(e,o,t){(function(t){o.exports=e;var r=typeof t.Buffer==="function"&&typeof t.Buffer.isBuffer==="function";var n=typeof t.ArrayBuffer==="function";var i=function(){if(n&&typeof t.ArrayBuffer.isView==="function"){return t.ArrayBuffer.isView}else{return function(e){return e.buffer instanceof t.ArrayBuffer}}}();function e(e){return r&&t.Buffer.isBuffer(e)||n&&(e instanceof t.ArrayBuffer||i(e))}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],64:[function(e,t,r){arguments[4][30][0].apply(r,arguments)},{dup:30}],65:[function(e,t,r){"use strict";var n=e("safe-buffer").Buffer;var i=n.isEncoding||function(e){e=""+e;switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return true;default:return false}};function o(e){if(!e)return"utf8";var t;while(true){switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase();t=true}}}function a(e){var t=o(e);if(typeof t!=="string"&&(n.isEncoding===i||!i(e)))throw new Error("Unknown encoding: "+e);return t||e}r.StringDecoder=s;function s(e){this.encoding=a(e);var t;switch(this.encoding){case"utf16le":this.text=h;this.end=v;t=4;break;case"utf8":this.fillLast=l;t=4;break;case"base64":this.text=m;this.end=g;t=3;break;default:this.write=y;this.end=b;return}this.lastNeed=0;this.lastTotal=0;this.lastChar=n.allocUnsafe(t)}s.prototype.write=function(e){if(e.length===0)return"";var t;var r;if(this.lastNeed){t=this.fillLast(e);if(t===undefined)return"";r=this.lastNeed;this.lastNeed=0}else{r=0}if(r<e.length)return t?t+this.text(e,r):this.text(e,r);return t||""};s.prototype.end=p;s.prototype.text=d;s.prototype.fillLast=function(e){if(this.lastNeed<=e.length){e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length);this.lastNeed-=e.length};function c(e){if(e<=127)return 0;else if(e>>5===6)return 2;else if(e>>4===14)return 3;else if(e>>3===30)return 4;return e>>6===2?-1:-2}function f(e,t,r){var n=t.length-1;if(n<r)return 0;var i=c(t[n]);if(i>=0){if(i>0)e.lastNeed=i-1;return i}if(--n<r||i===-2)return 0;i=c(t[n]);if(i>=0){if(i>0)e.lastNeed=i-2;return i}if(--n<r||i===-2)return 0;i=c(t[n]);if(i>=0){if(i>0){if(i===2)i=0;else e.lastNeed=i-3}return i}return 0}function u(e,t,r){if((t[0]&192)!==128){e.lastNeed=0;return"�"}if(e.lastNeed>1&&t.length>1){if((t[1]&192)!==128){e.lastNeed=1;return"�"}if(e.lastNeed>2&&t.length>2){if((t[2]&192)!==128){e.lastNeed=2;return"�"}}}}function l(e){var t=this.lastTotal-this.lastNeed;var r=u(this,e,t);if(r!==undefined)return r;if(this.lastNeed<=e.length){e.copy(this.lastChar,t,0,this.lastNeed);return this.lastChar.toString(this.encoding,0,this.lastTotal)}e.copy(this.lastChar,t,0,e.length);this.lastNeed-=e.length}function d(e,t){var r=f(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);e.copy(this.lastChar,0,n);return e.toString("utf8",t,n)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+"�";return t}function h(e,t){if((e.length-t)%2===0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319){this.lastNeed=2;this.lastTotal=4;this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1];return r.slice(0,-1)}}return r}this.lastNeed=1;this.lastTotal=2;this.lastChar[0]=e[e.length-1];return e.toString("utf16le",t,e.length-1)}function v(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function m(e,t){var r=(e.length-t)%3;if(r===0)return e.toString("base64",t);this.lastNeed=3-r;this.lastTotal=3;if(r===1){this.lastChar[0]=e[e.length-1]}else{this.lastChar[0]=e[e.length-2];this.lastChar[1]=e[e.length-1]}return e.toString("base64",t,e.length-r)}function g(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed)return t+this.lastChar.toString("base64",0,3-this.lastNeed);return t}function y(e){return e.toString(this.encoding)}function b(e){return e&&e.length?this.write(e):""}},{"safe-buffer":53}],66:[function(e,t,r){t.exports=n;function n(e,t){var r=[];t=t||0;for(var n=t||0;n<e.length;n++){r[n-t]=e[n]}return r}},{}],67:[function(e,t,r){(function(r){t.exports=e;function e(e,t){if(i("noDeprecation")){return e}var r=false;function n(){if(!r){if(i("throwDeprecation")){throw new Error(t)}else if(i("traceDeprecation")){console.trace(t)}else{console.warn(t)}r=true}return e.apply(this,arguments)}return n}function i(e){try{if(!r.localStorage)return false}catch(e){return false}var t=r.localStorage[e];if(null==t)return false;return String(t).toLowerCase()==="true"}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{}],68:[function(r,n,e){(function(e){"use strict";var t=r("./adapter_factory.js");n.exports=t({window:e.window})}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./adapter_factory.js":69}],69:[function(p,e,t){"use strict";var h=p("./utils");e.exports=function(e,t){var r=e&&e.window;var n={shimChrome:true,shimFirefox:true,shimEdge:true,shimSafari:true};for(var i in t){if(hasOwnProperty.call(t,i)){n[i]=t[i]}}var o=h.log;var a=h.detectBrowser(r);var s=p("./chrome/chrome_shim")||null;var c=p("./edge/edge_shim")||null;var f=p("./firefox/firefox_shim")||null;var u=p("./safari/safari_shim")||null;var l=p("./common_shim")||null;var d={browserDetails:a,commonShim:l,extractVersion:h.extractVersion,disableLog:h.disableLog,disableWarnings:h.disableWarnings};switch(a.browser){case"chrome":if(!s||!s.shimPeerConnection||!n.shimChrome){o("Chrome shim is not included in this adapter release.");return d}o("adapter.js shimming chrome.");d.browserShim=s;l.shimCreateObjectURL(r);s.shimGetUserMedia(r);s.shimMediaStream(r);s.shimSourceObject(r);s.shimPeerConnection(r);s.shimOnTrack(r);s.shimAddTrackRemoveTrack(r);s.shimGetSendersWithDtmf(r);l.shimRTCIceCandidate(r);l.shimMaxMessageSize(r);l.shimSendThrowTypeError(r);break;case"firefox":if(!f||!f.shimPeerConnection||!n.shimFirefox){o("Firefox shim is not included in this adapter release.");return d}o("adapter.js shimming firefox.");d.browserShim=f;l.shimCreateObjectURL(r);f.shimGetUserMedia(r);f.shimSourceObject(r);f.shimPeerConnection(r);f.shimOnTrack(r);f.shimRemoveStream(r);l.shimRTCIceCandidate(r);l.shimMaxMessageSize(r);l.shimSendThrowTypeError(r);break;case"edge":if(!c||!c.shimPeerConnection||!n.shimEdge){o("MS edge shim is not included in this adapter release.");return d}o("adapter.js shimming edge.");d.browserShim=c;l.shimCreateObjectURL(r);c.shimGetUserMedia(r);c.shimPeerConnection(r);c.shimReplaceTrack(r);l.shimMaxMessageSize(r);l.shimSendThrowTypeError(r);break;case"safari":if(!u||!n.shimSafari){o("Safari shim is not included in this adapter release.");return d}o("adapter.js shimming safari.");d.browserShim=u;l.shimCreateObjectURL(r);u.shimRTCIceServerUrls(r);u.shimCallbacksAPI(r);u.shimLocalStreamsAPI(r);u.shimRemoteStreamsAPI(r);u.shimTrackEventTransceiver(r);u.shimGetUserMedia(r);u.shimCreateOfferLegacy(r);l.shimRTCIceCandidate(r);l.shimMaxMessageSize(r);l.shimSendThrowTypeError(r);break;default:o("Unsupported browser!");break}return d}},{"./chrome/chrome_shim":70,"./common_shim":72,"./edge/edge_shim":73,"./firefox/firefox_shim":75,"./safari/safari_shim":77,"./utils":78}],70:[function(e,t,r){"use strict";var f=e("../utils.js");var n=f.log;t.exports={shimGetUserMedia:e("./getusermedia"),shimMediaStream:function(e){e.MediaStream=e.MediaStream||e.webkitMediaStream},shimOnTrack:function(o){if(typeof o==="object"&&o.RTCPeerConnection&&!("ontrack"in o.RTCPeerConnection.prototype)){Object.defineProperty(o.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack)}this.addEventListener("track",this._ontrack=e)}});var e=o.RTCPeerConnection.prototype.setRemoteDescription;o.RTCPeerConnection.prototype.setRemoteDescription=function(){var i=this;if(!i._ontrackpoly){i._ontrackpoly=function(n){n.stream.addEventListener("addtrack",function(t){var e;if(o.RTCPeerConnection.prototype.getReceivers){e=i.getReceivers().find(function(e){return e.track&&e.track.id===t.track.id})}else{e={track:t.track}}var r=new Event("track");r.track=t.track;r.receiver=e;r.transceiver={receiver:e};r.streams=[n.stream];i.dispatchEvent(r)});n.stream.getTracks().forEach(function(t){var e;if(o.RTCPeerConnection.prototype.getReceivers){e=i.getReceivers().find(function(e){return e.track&&e.track.id===t.id})}else{e={track:t}}var r=new Event("track");r.track=t;r.receiver=e;r.transceiver={receiver:e};r.streams=[n.stream];i.dispatchEvent(r)})};i.addEventListener("addstream",i._ontrackpoly)}return e.apply(i,arguments)}}else if(!("RTCRtpTransceiver"in o)){f.wrapPeerConnectionEvent(o,"track",function(e){if(!e.transceiver){e.transceiver={receiver:e.receiver}}return e})}},shimGetSendersWithDtmf:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var i=function(e,t){return{track:t,get dtmf(){if(this._dtmf===undefined){if(t.kind==="audio"){this._dtmf=e.createDTMFSender(t)}else{this._dtmf=null}}return this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){this._senders=this._senders||[];return this._senders.slice()};var o=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){var r=this;var n=o.apply(r,arguments);if(!n){n=i(r,e);r._senders.push(n)}return n};var n=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t=this;n.apply(t,arguments);var r=t._senders.indexOf(e);if(r!==-1){t._senders.splice(r,1)}}}var r=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t=this;t._senders=t._senders||[];r.apply(t,[e]);e.getTracks().forEach(function(e){t._senders.push(i(t,e))})};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var r=this;r._senders=r._senders||[];t.apply(r,[e]);e.getTracks().forEach(function(t){var e=r._senders.find(function(e){return e.track===t});if(e){r._senders.splice(r._senders.indexOf(e),1)}})}}else if(typeof e==="object"&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var t=this;var e=a.apply(t,[]);e.forEach(function(e){e._pc=t});return e};Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===undefined){if(this.track.kind==="audio"){this._dtmf=this._pc.createDTMFSender(this.track)}else{this._dtmf=null}}return this._dtmf}})}},shimSourceObject:function(e){var r=e&&e.URL;if(typeof e==="object"){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this._srcObject},set:function(e){var t=this;this._srcObject=e;if(this.src){r.revokeObjectURL(this.src)}if(!e){this.src="";return undefined}this.src=r.createObjectURL(e);e.addEventListener("addtrack",function(){if(t.src){r.revokeObjectURL(t.src)}t.src=r.createObjectURL(e)});e.addEventListener("removetrack",function(){if(t.src){r.revokeObjectURL(t.src)}t.src=r.createObjectURL(e)})}})}}},shimAddTrackRemoveTrackWithNative:function(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};return Object.keys(this._shimmedLocalStreams).map(function(e){return t._shimmedLocalStreams[e][0]})};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,t){if(!t){return n.apply(this,arguments)}this._shimmedLocalStreams=this._shimmedLocalStreams||{};var r=n.apply(this,arguments);if(!this._shimmedLocalStreams[t.id]){this._shimmedLocalStreams[t.id]=[t,r]}else if(this._shimmedLocalStreams[t.id].indexOf(r)===-1){this._shimmedLocalStreams[t.id].push(r)}return r};var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var r=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){throw new DOMException("Track already exists.","InvalidAccessError")}});var t=r.getSenders();i.apply(this,arguments);var n=r.getSenders().filter(function(e){return t.indexOf(e)===-1});this._shimmedLocalStreams[e.id]=[e].concat(n)};var t=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._shimmedLocalStreams=this._shimmedLocalStreams||{};delete this._shimmedLocalStreams[e.id];return t.apply(this,arguments)};var o=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{};if(r){Object.keys(this._shimmedLocalStreams).forEach(function(e){var t=n._shimmedLocalStreams[e].indexOf(r);if(t!==-1){n._shimmedLocalStreams[e].splice(t,1)}if(n._shimmedLocalStreams[e].length===1){delete n._shimmedLocalStreams[e]}})}return o.apply(this,arguments)}},shimAddTrackRemoveTrack:function(s){var e=f.detectBrowser(s);if(s.RTCPeerConnection.prototype.addTrack&&e.version>=65){return this.shimAddTrackRemoveTrackWithNative(s)}var r=s.RTCPeerConnection.prototype.getLocalStreams;s.RTCPeerConnection.prototype.getLocalStreams=function(){var t=this;var e=r.apply(this);t._reverseStreams=t._reverseStreams||{};return e.map(function(e){return t._reverseStreams[e.id]})};var n=s.RTCPeerConnection.prototype.addStream;s.RTCPeerConnection.prototype.addStream=function(e){var r=this;r._streams=r._streams||{};r._reverseStreams=r._reverseStreams||{};e.getTracks().forEach(function(t){var e=r.getSenders().find(function(e){return e.track===t});if(e){throw new DOMException("Track already exists.","InvalidAccessError")}});if(!r._reverseStreams[e.id]){var t=new s.MediaStream(e.getTracks());r._streams[e.id]=t;r._reverseStreams[t.id]=e;e=t}n.apply(r,[e])};var i=s.RTCPeerConnection.prototype.removeStream;s.RTCPeerConnection.prototype.removeStream=function(e){var t=this;t._streams=t._streams||{};t._reverseStreams=t._reverseStreams||{};i.apply(t,[t._streams[e.id]||e]);delete t._reverseStreams[t._streams[e.id]?t._streams[e.id].id:e.id];delete t._streams[e.id]};s.RTCPeerConnection.prototype.addTrack=function(t,e){var r=this;if(r.signalingState==="closed"){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}var n=[].slice.call(arguments,1);if(n.length!==1||!n[0].getTracks().find(function(e){return e===t})){throw new DOMException("The adapter.js addTrack polyfill only supports a single "+" stream which is associated with the specified track.","NotSupportedError")}var i=r.getSenders().find(function(e){return e.track===t});if(i){throw new DOMException("Track already exists.","InvalidAccessError")}r._streams=r._streams||{};r._reverseStreams=r._reverseStreams||{};var o=r._streams[e.id];if(o){o.addTrack(t);Promise.resolve().then(function(){r.dispatchEvent(new Event("negotiationneeded"))})}else{var a=new s.MediaStream([t]);r._streams[e.id]=a;r._reverseStreams[a.id]=e;r.addStream(a)}return r.getSenders().find(function(e){return e.track===t})};function o(n,e){var i=e.sdp;Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e];var r=n._streams[t.id];i=i.replace(new RegExp(r.id,"g"),t.id)});return new RTCSessionDescription({type:e.type,sdp:i})}function t(n,e){var i=e.sdp;Object.keys(n._reverseStreams||[]).forEach(function(e){var t=n._reverseStreams[e];var r=n._streams[t.id];i=i.replace(new RegExp(t.id,"g"),r.id)});return new RTCSessionDescription({type:e.type,sdp:i})}["createOffer","createAnswer"].forEach(function(e){var t=s.RTCPeerConnection.prototype[e];s.RTCPeerConnection.prototype[e]=function(){var r=this;var n=arguments;var e=arguments.length&&typeof arguments[0]==="function";if(e){return t.apply(r,[function(e){var t=o(r,e);n[0].apply(null,[t])},function(e){if(n[1]){n[1].apply(null,e)}},arguments[2]])}return t.apply(r,arguments).then(function(e){return o(r,e)})}});var a=s.RTCPeerConnection.prototype.setLocalDescription;s.RTCPeerConnection.prototype.setLocalDescription=function(){var e=this;if(!arguments.length||!arguments[0].type){return a.apply(e,arguments)}arguments[0]=t(e,arguments[0]);return a.apply(e,arguments)};var c=Object.getOwnPropertyDescriptor(s.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(s.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=this;var t=c.get.apply(this);if(t.type===""){return t}return o(e,t)}});s.RTCPeerConnection.prototype.removeTrack=function(r){var n=this;if(n.signalingState==="closed"){throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError")}if(!r._pc){throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack "+"does not implement interface RTCRtpSender.","TypeError")}var e=r._pc===n;if(!e){throw new DOMException("Sender was not created by this connection.","InvalidAccessError")}n._streams=n._streams||{};var i;Object.keys(n._streams).forEach(function(e){var t=n._streams[e].getTracks().find(function(e){return r.track===e});if(t){i=n._streams[e]}});if(i){if(i.getTracks().length===1){n.removeStream(n._reverseStreams[i.id])}else{i.removeTrack(r.track)}n.dispatchEvent(new Event("negotiationneeded"))}}},shimPeerConnection:function(r){var e=f.detectBrowser(r);if(!r.RTCPeerConnection&&r.webkitRTCPeerConnection){r.RTCPeerConnection=function(e,t){n("PeerConnection");if(e&&e.iceTransportPolicy){e.iceTransports=e.iceTransportPolicy}return new r.webkitRTCPeerConnection(e,t)};r.RTCPeerConnection.prototype=r.webkitRTCPeerConnection.prototype;if(r.webkitRTCPeerConnection.generateCertificate){Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:function(){return r.webkitRTCPeerConnection.generateCertificate}})}}else{var o=r.RTCPeerConnection;r.RTCPeerConnection=function(e,t){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")){f.deprecated("RTCIceServer.url","RTCIceServer.urls");i=JSON.parse(JSON.stringify(i));i.urls=i.url;r.push(i)}else{r.push(e.iceServers[n])}}e.iceServers=r}return new o(e,t)};r.RTCPeerConnection.prototype=o.prototype;Object.defineProperty(r.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}})}var c=r.RTCPeerConnection.prototype.getStats;r.RTCPeerConnection.prototype.getStats=function(e,t,r){var n=this;var i=arguments;if(arguments.length>0&&typeof e==="function"){return c.apply(this,arguments)}if(c.length===0&&(arguments.length===0||typeof arguments[0]!=="function")){return c.apply(this,[])}var o=function(e){var n={};var t=e.result();t.forEach(function(t){var r={id:t.id,timestamp:t.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[t.type]||t.type};t.names().forEach(function(e){r[e]=t.stat(e)});n[r.id]=r});return n};var a=function(t){return new Map(Object.keys(t).map(function(e){return[e,t[e]]}))};if(arguments.length>=2){var s=function(e){i[1](a(o(e)))};return c.apply(this,[s,arguments[0]])}return new Promise(function(t,e){c.apply(n,[function(e){t(a(o(e)))},e])}).then(t,r)};if(e.version<51){["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){var r=arguments;var n=this;var e=new Promise(function(e,t){i.apply(n,[r[0],e,t])});if(r.length<2){return e}return e.then(function(){r[1].apply(null,[])},function(e){if(r.length>=3){r[2].apply(null,[e])}})}})}if(e.version<52){["createOffer","createAnswer"].forEach(function(e){var i=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){var r=this;if(arguments.length<1||arguments.length===1&&typeof arguments[0]==="object"){var n=arguments.length===1?arguments[0]:undefined;return new Promise(function(e,t){i.apply(r,[e,t,n])})}return i.apply(this,arguments)}})}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=r.RTCPeerConnection.prototype[e];r.RTCPeerConnection.prototype[e]=function(){arguments[0]=new(e==="addIceCandidate"?r.RTCIceCandidate:r.RTCSessionDescription)(arguments[0]);return t.apply(this,arguments)}});var t=r.RTCPeerConnection.prototype.addIceCandidate;r.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return t.apply(this,arguments)}}}},{"../utils.js":78,"./getusermedia":71}],71:[function(e,t,r){"use strict";var f=e("../utils.js");var u=f.log;t.exports=function(e){var a=f.detectBrowser(e);var s=e&&e.navigator;var c=function(i){if(typeof i!=="object"||i.mandatory||i.optional){return i}var o={};Object.keys(i).forEach(function(t){if(t==="require"||t==="advanced"||t==="mediaSource"){return}var r=typeof i[t]==="object"?i[t]:{ideal:i[t]};if(r.exact!==undefined&&typeof r.exact==="number"){r.min=r.max=r.exact}var n=function(e,t){if(e){return e+t.charAt(0).toUpperCase()+t.slice(1)}return t==="deviceId"?"sourceId":t};if(r.ideal!==undefined){o.optional=o.optional||[];var e={};if(typeof r.ideal==="number"){e[n("min",t)]=r.ideal;o.optional.push(e);e={};e[n("max",t)]=r.ideal;o.optional.push(e)}else{e[n("",t)]=r.ideal;o.optional.push(e)}}if(r.exact!==undefined&&typeof r.exact!=="number"){o.mandatory=o.mandatory||{};o.mandatory[n("",t)]=r.exact}else{["min","max"].forEach(function(e){if(r[e]!==undefined){o.mandatory=o.mandatory||{};o.mandatory[n(e,t)]=r[e]}})}});if(i.advanced){o.optional=(o.optional||[]).concat(i.advanced)}return o};var n=function(r,n){if(a.version>=61){return n(r)}r=JSON.parse(JSON.stringify(r));if(r&&typeof r.audio==="object"){var e=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};r=JSON.parse(JSON.stringify(r));e(r.audio,"autoGainControl","googAutoGainControl");e(r.audio,"noiseSuppression","googNoiseSuppression");r.audio=c(r.audio)}if(r&&typeof r.video==="object"){var i=r.video.facingMode;i=i&&(typeof i==="object"?i:{ideal:i});var t=a.version<66;if(i&&(i.exact==="user"||i.exact==="environment"||i.ideal==="user"||i.ideal==="environment")&&!(s.mediaDevices.getSupportedConstraints&&s.mediaDevices.getSupportedConstraints().facingMode&&!t)){delete r.video.facingMode;var o;if(i.exact==="environment"||i.ideal==="environment"){o=["back","rear"]}else if(i.exact==="user"||i.ideal==="user"){o=["front"]}if(o){return s.mediaDevices.enumerateDevices().then(function(e){e=e.filter(function(e){return e.kind==="videoinput"});var t=e.find(function(t){return o.some(function(e){return t.label.toLowerCase().indexOf(e)!==-1})});if(!t&&e.length&&o.indexOf("back")!==-1){t=e[e.length-1]}if(t){r.video.deviceId=i.exact?{exact:t.deviceId}:{ideal:t.deviceId}}r.video=c(r.video);u("chrome: "+JSON.stringify(r));return n(r)})}}r.video=c(r.video)}u("chrome: "+JSON.stringify(r));return n(r)};var i=function(e){return{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};var t=function(e,t,r){n(e,function(e){s.webkitGetUserMedia(e,t,function(e){if(r){r(i(e))}})})};s.getUserMedia=t;var r=function(r){return new Promise(function(e,t){s.getUserMedia(r,e,t)})};if(!s.mediaDevices){s.mediaDevices={getUserMedia:r,enumerateDevices:function(){return new Promise(function(t){var r={audio:"audioinput",video:"videoinput"};return e.MediaStreamTrack.getSources(function(e){t(e.map(function(e){return{label:e.label,kind:r[e.kind],deviceId:e.id,groupId:""}}))})})},getSupportedConstraints:function(){return{deviceId:true,echoCancellation:true,facingMode:true,frameRate:true,height:true,width:true}}}}if(!s.mediaDevices.getUserMedia){s.mediaDevices.getUserMedia=function(e){return r(e)}}else{var o=s.mediaDevices.getUserMedia.bind(s.mediaDevices);s.mediaDevices.getUserMedia=function(e){return n(e,function(t){return o(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length){e.getTracks().forEach(function(e){e.stop()});throw new DOMException("","NotFoundError")}return e},function(e){return Promise.reject(i(e))})})}}if(typeof s.mediaDevices.addEventListener==="undefined"){s.mediaDevices.addEventListener=function(){u("Dummy mediaDevices.addEventListener called.")}}if(typeof s.mediaDevices.removeEventListener==="undefined"){s.mediaDevices.removeEventListener=function(){u("Dummy mediaDevices.removeEventListener called.")}}}},{"../utils.js":78}],72:[function(e,t,r){"use strict";var o=e("sdp");var l=e("./utils");t.exports={shimRTCIceCandidate:function(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype){return}var i=t.RTCIceCandidate;t.RTCIceCandidate=function(e){if(typeof e==="object"&&e.candidate&&e.candidate.indexOf("a=")===0){e=JSON.parse(JSON.stringify(e));e.candidate=e.candidate.substr(2)}if(e.candidate&&e.candidate.length){var t=new i(e);var r=o.parseCandidate(e.candidate);var n=Object.assign(t,r);n.toJSON=function(){return{candidate:n.candidate,sdpMid:n.sdpMid,sdpMLineIndex:n.sdpMLineIndex,usernameFragment:n.usernameFragment}};return n}return new i(e)};t.RTCIceCandidate.prototype=i.prototype;l.wrapPeerConnectionEvent(t,"icecandidate",function(e){if(e.candidate){Object.defineProperty(e,"candidate",{value:new t.RTCIceCandidate(e.candidate),writable:"false"})}return e})},shimCreateObjectURL:function(e){var t=e&&e.URL;if(!(typeof e==="object"&&e.HTMLMediaElement&&"srcObject"in e.HTMLMediaElement.prototype&&t.createObjectURL&&t.revokeObjectURL)){return undefined}var r=t.createObjectURL.bind(t);var n=t.revokeObjectURL.bind(t);var i=new Map,o=0;t.createObjectURL=function(e){if("getTracks"in e){var t="polyblob:"+ ++o;i.set(t,e);l.deprecated("URL.createObjectURL(stream)","elem.srcObject = stream");return t}return r(e)};t.revokeObjectURL=function(e){n(e);i.delete(e)};var a=Object.getOwnPropertyDescriptor(e.HTMLMediaElement.prototype,"src");Object.defineProperty(e.HTMLMediaElement.prototype,"src",{get:function(){return a.get.apply(this)},set:function(e){this.srcObject=i.get(e)||null;return a.set.apply(this,[e])}});var s=e.HTMLMediaElement.prototype.setAttribute;e.HTMLMediaElement.prototype.setAttribute=function(){if(arguments.length===2&&(""+arguments[0]).toLowerCase()==="src"){this.srcObject=i.get(arguments[1])||null}return s.apply(this,arguments)}},shimMaxMessageSize:function(e){if(e.RTCSctpTransport||!e.RTCPeerConnection){return}var i=l.detectBrowser(e);if(!("sctp"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"sctp",{get:function(){return typeof this._sctp==="undefined"?null:this._sctp}})}var a=function(e){var t=o.splitSections(e.sdp);t.shift();return t.some(function(e){var t=o.parseMLine(e);return t&&t.kind==="application"&&t.protocol.indexOf("SCTP")!==-1})};var s=function(e){var t=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(t===null||t.length<2){return-1}var r=parseInt(t[1],10);return r!==r?-1:r};var c=function(e){var t=65536;if(i.browser==="firefox"){if(i.version<57){if(e===-1){t=16384}else{t=2147483637}}else{t=i.version===57?65535:65536}}return t};var f=function(e,t){var r=65536;if(i.browser==="firefox"&&i.version===57){r=65535}var n=o.matchPrefix(e.sdp,"a=max-message-size:");if(n.length>0){r=parseInt(n[0].substr(19),10)}else if(i.browser==="firefox"&&t!==-1){r=2147483637}return r};var u=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;e._sctp=null;if(a(arguments[0])){var t=s(arguments[0]);var r=c(t);var n=f(arguments[0],t);var i;if(r===0&&n===0){i=Number.POSITIVE_INFINITY}else if(r===0||n===0){i=Math.max(r,n)}else{i=Math.min(r,n)}var o={};Object.defineProperty(o,"maxMessageSize",{get:function(){return i}});e._sctp=o}return u.apply(e,arguments)}},shimSendThrowTypeError:function(e){if(!(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype)){return}var t=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var n=this;var e=t.apply(n,arguments);var i=e.send;e.send=function(){var e=this;var t=arguments[0];var r=t.length||t.size||t.byteLength;if(r>n.sctp.maxMessageSize){throw new DOMException("Message too large (can send a maximum of "+n.sctp.maxMessageSize+" bytes)","TypeError")}return i.apply(e,arguments)};return e}}}},{"./utils":78,sdp:54}],73:[function(e,t,r){"use strict";var n=e("../utils");var i=e("rtcpeerconnection-shim");t.exports={shimGetUserMedia:e("./getusermedia"),shimPeerConnection:function(e){var t=n.detectBrowser(e);if(e.RTCIceGatherer){if(!e.RTCIceCandidate){e.RTCIceCandidate=function(e){return e}}if(!e.RTCSessionDescription){e.RTCSessionDescription=function(e){return e}}if(t.version<15025){var r=Object.getOwnPropertyDescriptor(e.MediaStreamTrack.prototype,"enabled");Object.defineProperty(e.MediaStreamTrack.prototype,"enabled",{set:function(e){r.set.call(this,e);var t=new Event("enabled");t.enabled=e;this.dispatchEvent(t)}})}}if(e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){Object.defineProperty(e.RTCRtpSender.prototype,"dtmf",{get:function(){if(this._dtmf===undefined){if(this.track.kind==="audio"){this._dtmf=new e.RTCDtmfSender(this)}else if(this.track.kind==="video"){this._dtmf=null}}return this._dtmf}})}if(e.RTCDtmfSender&&!e.RTCDTMFSender){e.RTCDTMFSender=e.RTCDtmfSender}e.RTCPeerConnection=i(e,t.version)},shimReplaceTrack:function(e){if(e.RTCRtpSender&&!("replaceTrack"in e.RTCRtpSender.prototype)){e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack}}}},{"../utils":78,"./getusermedia":74,"rtcpeerconnection-shim":52}],74:[function(e,t,r){"use strict";t.exports=function(e){var t=e&&e.navigator;var r=function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}};var n=t.mediaDevices.getUserMedia.bind(t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return n(e).catch(function(e){return Promise.reject(r(e))})}}},{}],75:[function(e,t,r){"use strict";var a=e("../utils");t.exports={shimGetUserMedia:e("./getusermedia"),shimOnTrack:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&!("ontrack"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){if(this._ontrack){this.removeEventListener("track",this._ontrack);this.removeEventListener("addstream",this._ontrackpoly)}this.addEventListener("track",this._ontrack=e);this.addEventListener("addstream",this._ontrackpoly=function(r){r.stream.getTracks().forEach(function(e){var t=new Event("track");t.track=e;t.receiver={track:e};t.transceiver={receiver:t.receiver};t.streams=[r.stream];this.dispatchEvent(t)}.bind(this))}.bind(this))}})}if(typeof e==="object"&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}},shimSourceObject:function(e){if(typeof e==="object"){if(e.HTMLMediaElement&&!("srcObject"in e.HTMLMediaElement.prototype)){Object.defineProperty(e.HTMLMediaElement.prototype,"srcObject",{get:function(){return this.mozSrcObject},set:function(e){this.mozSrcObject=e}})}}},shimPeerConnection:function(s){var c=a.detectBrowser(s);if(typeof s!=="object"||!(s.RTCPeerConnection||s.mozRTCPeerConnection)){return}if(!s.RTCPeerConnection){s.RTCPeerConnection=function(e,t){if(c.version<38){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(i.hasOwnProperty("urls")){for(var o=0;o<i.urls.length;o++){var a={url:i.urls[o]};if(i.urls[o].indexOf("turn")===0){a.username=i.username;a.credential=i.credential}r.push(a)}}else{r.push(e.iceServers[n])}}e.iceServers=r}}return new s.mozRTCPeerConnection(e,t)};s.RTCPeerConnection.prototype=s.mozRTCPeerConnection.prototype;if(s.mozRTCPeerConnection.generateCertificate){Object.defineProperty(s.RTCPeerConnection,"generateCertificate",{get:function(){return s.mozRTCPeerConnection.generateCertificate}})}s.RTCSessionDescription=s.mozRTCSessionDescription;s.RTCIceCandidate=s.mozRTCIceCandidate}["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(e){var t=s.RTCPeerConnection.prototype[e];s.RTCPeerConnection.prototype[e]=function(){arguments[0]=new(e==="addIceCandidate"?s.RTCIceCandidate:s.RTCSessionDescription)(arguments[0]);return t.apply(this,arguments)}});var e=s.RTCPeerConnection.prototype.addIceCandidate;s.RTCPeerConnection.prototype.addIceCandidate=function(){if(!arguments[0]){if(arguments[1]){arguments[1].apply(null)}return Promise.resolve()}return e.apply(this,arguments)};var n=function(t){var r=new Map;Object.keys(t).forEach(function(e){r.set(e,t[e]);r[e]=t[e]});return r};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"};var o=s.RTCPeerConnection.prototype.getStats;s.RTCPeerConnection.prototype.getStats=function(e,t,r){return o.apply(this,[e||null]).then(function(r){if(c.version<48){r=n(r)}if(c.version<53&&!t){try{r.forEach(function(e){e.type=i[e.type]||e.type})}catch(e){if(e.name!=="TypeError"){throw e}r.forEach(function(e,t){r.set(t,Object.assign({},e,{type:i[e.type]||e.type}))})}}return r}).then(t,r)}},shimRemoveStream:function(e){if(!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype){return}e.RTCPeerConnection.prototype.removeStream=function(t){var r=this;a.deprecated("removeStream","removeTrack");this.getSenders().forEach(function(e){if(e.track&&t.getTracks().indexOf(e.track)!==-1){r.removeTrack(e)}})}}}},{"../utils":78,"./getusermedia":76}],76:[function(e,t,r){"use strict";var p=e("../utils");var h=p.log;t.exports=function(e){var i=p.detectBrowser(e);var o=e&&e.navigator;var t=e&&e.MediaStreamTrack;var a=function(e){return{name:{InternalError:"NotReadableError",NotSupportedError:"TypeError",PermissionDeniedError:"NotAllowedError",SecurityError:"NotAllowedError"}[e.name]||e.name,message:{"The operation is insecure.":"The request is not allowed by the "+"user agent or the platform in the current context."}[e.message]||e.message,constraint:e.constraint,toString:function(){return this.name+(this.message&&": ")+this.message}}};var n=function(e,t,r){var n=function(n){if(typeof n!=="object"||n.require){return n}var i=[];Object.keys(n).forEach(function(e){if(e==="require"||e==="advanced"||e==="mediaSource"){return}var t=n[e]=typeof n[e]==="object"?n[e]:{ideal:n[e]};if(t.min!==undefined||t.max!==undefined||t.exact!==undefined){i.push(e)}if(t.exact!==undefined){if(typeof t.exact==="number"){t.min=t.max=t.exact}else{n[e]=t.exact}delete t.exact}if(t.ideal!==undefined){n.advanced=n.advanced||[];var r={};if(typeof t.ideal==="number"){r[e]={min:t.ideal,max:t.ideal}}else{r[e]=t.ideal}n.advanced.push(r);delete t.ideal;if(!Object.keys(t).length){delete n[e]}}});if(i.length){n.require=i}return n};e=JSON.parse(JSON.stringify(e));if(i.version<38){h("spec: "+JSON.stringify(e));if(e.audio){e.audio=n(e.audio)}if(e.video){e.video=n(e.video)}h("ff37: "+JSON.stringify(e))}return o.mozGetUserMedia(e,t,function(e){r(a(e))})};var r=function(r){return new Promise(function(e,t){n(r,e,t)})};if(!o.mediaDevices){o.mediaDevices={getUserMedia:r,addEventListener:function(){},removeEventListener:function(){}}}o.mediaDevices.enumerateDevices=o.mediaDevices.enumerateDevices||function(){return new Promise(function(e){var t=[{kind:"audioinput",deviceId:"default",label:"",groupId:""},{kind:"videoinput",deviceId:"default",label:"",groupId:""}];e(t)})};if(i.version<41){var s=o.mediaDevices.enumerateDevices.bind(o.mediaDevices);o.mediaDevices.enumerateDevices=function(){return s().then(undefined,function(e){if(e.name==="NotFoundError"){return[]}throw e})}}if(i.version<49){var c=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(t){return c(t).then(function(e){if(t.audio&&!e.getAudioTracks().length||t.video&&!e.getVideoTracks().length){e.getTracks().forEach(function(e){e.stop()});throw new DOMException("The object can not be found here.","NotFoundError")}return e},function(e){return Promise.reject(a(e))})}}if(!(i.version>55&&"autoGainControl"in o.mediaDevices.getSupportedConstraints())){var f=function(e,t,r){if(t in e&&!(r in e)){e[r]=e[t];delete e[t]}};var u=o.mediaDevices.getUserMedia.bind(o.mediaDevices);o.mediaDevices.getUserMedia=function(e){if(typeof e==="object"&&typeof e.audio==="object"){e=JSON.parse(JSON.stringify(e));f(e.audio,"autoGainControl","mozAutoGainControl");f(e.audio,"noiseSuppression","mozNoiseSuppression")}return u(e)};if(t&&t.prototype.getSettings){var l=t.prototype.getSettings;t.prototype.getSettings=function(){var e=l.apply(this,arguments);f(e,"mozAutoGainControl","autoGainControl");f(e,"mozNoiseSuppression","noiseSuppression");return e}}if(t&&t.prototype.applyConstraints){var d=t.prototype.applyConstraints;t.prototype.applyConstraints=function(e){if(this.kind==="audio"&&typeof e==="object"){e=JSON.parse(JSON.stringify(e));f(e,"autoGainControl","mozAutoGainControl");f(e,"noiseSuppression","mozNoiseSuppression")}return d.apply(this,[e])}}}o.getUserMedia=function(e,t,r){if(i.version<44){return n(e,t,r)}p.deprecated("navigator.getUserMedia","navigator.mediaDevices.getUserMedia");o.mediaDevices.getUserMedia(e).then(t,r)}}},{"../utils":78}],77:[function(e,t,r){"use strict";var a=e("../utils");t.exports={shimLocalStreamsAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}if(!("getLocalStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getLocalStreams=function(){if(!this._localStreams){this._localStreams=[]}return this._localStreams}}if(!("getStreamById"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getStreamById=function(t){var r=null;if(this._localStreams){this._localStreams.forEach(function(e){if(e.id===t){r=e}})}if(this._remoteStreams){this._remoteStreams.forEach(function(e){if(e.id===t){r=e}})}return r}}if(!("addStream"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(t){if(!this._localStreams){this._localStreams=[]}if(this._localStreams.indexOf(t)===-1){this._localStreams.push(t)}var r=this;t.getTracks().forEach(function(e){n.call(r,e,t)})};e.RTCPeerConnection.prototype.addTrack=function(e,t){if(t){if(!this._localStreams){this._localStreams=[t]}else if(this._localStreams.indexOf(t)===-1){this._localStreams.push(t)}}return n.call(this,e,t)}}if(!("removeStream"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.removeStream=function(e){if(!this._localStreams){this._localStreams=[]}var t=this._localStreams.indexOf(e);if(t===-1){return}this._localStreams.splice(t,1);var r=this;var n=e.getTracks();this.getSenders().forEach(function(e){if(n.indexOf(e.track)!==-1){r.removeTrack(e)}})}}},shimRemoteStreamsAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}if(!("getRemoteStreams"in e.RTCPeerConnection.prototype)){e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}}if(!("onaddstream"in e.RTCPeerConnection.prototype)){Object.defineProperty(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var r=this;if(this._onaddstream){this.removeEventListener("addstream",this._onaddstream);this.removeEventListener("track",this._onaddstreampoly)}this.addEventListener("addstream",this._onaddstream=e);this.addEventListener("track",this._onaddstreampoly=function(e){e.streams.forEach(function(e){if(!r._remoteStreams){r._remoteStreams=[]}if(r._remoteStreams.indexOf(e)>=0){return}r._remoteStreams.push(e);var t=new Event("addstream");t.stream=e;r.dispatchEvent(t)})})}})}},shimCallbacksAPI:function(e){if(typeof e!=="object"||!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype;var i=t.createOffer;var o=t.createAnswer;var a=t.setLocalDescription;var s=t.setRemoteDescription;var c=t.addIceCandidate;t.createOffer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0];var n=i.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};t.createAnswer=function(e,t){var r=arguments.length>=2?arguments[2]:arguments[0];var n=o.apply(this,[r]);if(!t){return n}n.then(e,t);return Promise.resolve()};var r=function(e,t,r){var n=a.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setLocalDescription=r;r=function(e,t,r){var n=s.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.setRemoteDescription=r;r=function(e,t,r){var n=c.apply(this,[e]);if(!r){return n}n.then(t,r);return Promise.resolve()};t.addIceCandidate=r},shimGetUserMedia:function(e){var n=e&&e.navigator;if(!n.getUserMedia){if(n.webkitGetUserMedia){n.getUserMedia=n.webkitGetUserMedia.bind(n)}else if(n.mediaDevices&&n.mediaDevices.getUserMedia){n.getUserMedia=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}.bind(n)}}},shimRTCIceServerUrls:function(e){var o=e.RTCPeerConnection;e.RTCPeerConnection=function(e,t){if(e&&e.iceServers){var r=[];for(var n=0;n<e.iceServers.length;n++){var i=e.iceServers[n];if(!i.hasOwnProperty("urls")&&i.hasOwnProperty("url")){a.deprecated("RTCIceServer.url","RTCIceServer.urls");i=JSON.parse(JSON.stringify(i));i.urls=i.url;delete i.url;r.push(i)}else{r.push(e.iceServers[n])}}e.iceServers=r}return new o(e,t)};e.RTCPeerConnection.prototype=o.prototype;if("generateCertificate"in e.RTCPeerConnection){Object.defineProperty(e.RTCPeerConnection,"generateCertificate",{get:function(){return o.generateCertificate}})}},shimTrackEventTransceiver:function(e){if(typeof e==="object"&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver){Object.defineProperty(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}},shimCreateOfferLegacy:function(e){var i=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){var t=this;if(e){if(typeof e.offerToReceiveAudio!=="undefined"){e.offerToReceiveAudio=!!e.offerToReceiveAudio}var r=t.getTransceivers().find(function(e){return e.sender.track&&e.sender.track.kind==="audio"});if(e.offerToReceiveAudio===false&&r){if(r.direction==="sendrecv"){if(r.setDirection){r.setDirection("sendonly")}else{r.direction="sendonly"}}else if(r.direction==="recvonly"){if(r.setDirection){r.setDirection("inactive")}else{r.direction="inactive"}}}else if(e.offerToReceiveAudio===true&&!r){t.addTransceiver("audio")}if(typeof e.offerToReceiveAudio!=="undefined"){e.offerToReceiveVideo=!!e.offerToReceiveVideo}var n=t.getTransceivers().find(function(e){return e.sender.track&&e.sender.track.kind==="video"});if(e.offerToReceiveVideo===false&&n){if(n.direction==="sendrecv"){n.setDirection("sendonly")}else if(n.direction==="recvonly"){n.setDirection("inactive")}}else if(e.offerToReceiveVideo===true&&!n){t.addTransceiver("video")}}return i.apply(t,arguments)}}}},{"../utils":78}],78:[function(e,t,r){"use strict";var n=true;var i=true;function o(e,t,r){var n=e.match(t);return n&&n.length>=r&&parseInt(n[r],10)}function a(e,n,i){if(!e.RTCPeerConnection){return}var t=e.RTCPeerConnection.prototype;var o=t.addEventListener;t.addEventListener=function(e,t){if(e!==n){return o.apply(this,arguments)}var r=function(e){t(i(e))};this._eventMap=this._eventMap||{};this._eventMap[t]=r;return o.apply(this,[e,r])};var a=t.removeEventListener;t.removeEventListener=function(e,t){if(e!==n||!this._eventMap||!this._eventMap[t]){return a.apply(this,arguments)}var r=this._eventMap[t];delete this._eventMap[t];return a.apply(this,[e,r])};Object.defineProperty(t,"on"+n,{get:function(){return this["_on"+n]},set:function(e){if(this["_on"+n]){this.removeEventListener(n,this["_on"+n]);delete this["_on"+n]}if(e){this.addEventListener(n,this["_on"+n]=e)}}})}t.exports={extractVersion:o,wrapPeerConnectionEvent:a,disableLog:function(e){if(typeof e!=="boolean"){return new Error("Argument type: "+typeof e+". Please use a boolean.")}n=e;return e?"adapter.js logging disabled":"adapter.js logging enabled"},disableWarnings:function(e){if(typeof e!=="boolean"){return new Error("Argument type: "+typeof e+". Please use a boolean.")}i=!e;return"adapter.js deprecation warnings "+(e?"disabled":"enabled")},log:function(){if(typeof window==="object"){if(n){return}if(typeof console!=="undefined"&&typeof console.log==="function"){console.log.apply(console,arguments)}}},deprecated:function(e,t){if(!i){return}console.warn(e+" is deprecated, please use "+t+" instead.")},detectBrowser:function(e){var t=e&&e.navigator;var r={};r.browser=null;r.version=null;if(typeof e==="undefined"||!e.navigator){r.browser="Not a browser.";return r}if(t.mozGetUserMedia){r.browser="firefox";r.version=o(t.userAgent,/Firefox\/(\d+)\./,1)}else if(t.webkitGetUserMedia){r.browser="chrome";r.version=o(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2)}else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/)){r.browser="edge";r.version=o(t.userAgent,/Edge\/(\d+).(\d+)$/,2)}else if(e.RTCPeerConnection&&t.userAgent.match(/AppleWebKit\/(\d+)\./)){r.browser="safari";r.version=o(t.userAgent,/AppleWebKit\/(\d+)\./,1)}else{r.browser="Not a supported browser.";return r}return r}}},{}],79:[function(e,t,r){"use strict";var n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),i=64,o={},a=0,s=0,c;function f(e){var t="";do{t=n[e%i]+t;e=Math.floor(e/i)}while(e>0);return t}function u(e){var t=0;for(s=0;s<e.length;s++){t=t*i+o[e.charAt(s)]}return t}function l(){var e=f(+new Date);if(e!==c)return a=0,c=e;return e+"."+f(a++)}for(;s<i;s++)o[n[s]]=s;l.encode=f;l.decode=u;t.exports=l},{}],80:[function(e,t,r){"use strict";t.exports=o;e("webrtc-adapter");var n=e("socket.io-client");var i=e("simple-peer");function o(e,t){var n=this;n.ws=null;n.room=null;n.devices=null;n.clientId=null;n.audioOnly=false;n.initiator=false;n.autoAccept=false;n.multiparty=false;n.clientStream=null;n.roomFeeds=[];n.appId=e;n.appToken=t;n.appSecret=null;n.videoQuality={QVGA:{width:{exact:320},height:{exact:240}},VGA:{width:{exact:640},height:{exact:480}},HD:{width:{exact:1280},height:{exact:720}},FULLHD:{width:{exact:1920},height:{exact:1080}},"4K":{width:{exact:4096},height:{exact:2160}},"8K":{width:{exact:7680},height:{exact:4320}}};n.selectedQuality=n.videoQuality.QVGA;r();function r(){n.devices={microphones:[],cameras:[],speakers:[]};navigator.mediaDevices.enumerateDevices().then(function(e){for(var t=0;t!=e.length;++t){var r=e[t];if(r.kind=="audioinput"){n.devices.microphones.push(r)}else if(r.kind=="videoinput"){n.devices.cameras.push(r)}else if(r.kind=="audiooutput"){n.devices.speakers.push(r)}}}).catch(function(e){n.onError(e)})}}o.prototype.setAudioOnly=function(e){var t=this;t.audioOnly=e};o.prototype.setVideoQuality=function(e){var t=this;t.selectedQuality=e};o.prototype.initCall=function(e,t,r,n,i){var o=this;o.clientId=e;o.room=t;o.clientStream=r;o.initiator=n===true;o.autoAccept=i===true;o.connectWebSocket()};o.prototype.initConf=function(e,t,r,n,i){var o=this;o.clientId=e;o.room=t;o.clientStream=r;o.initiator=n===true;o.autoAccept=i===true;o.multiparty=true;o.connectWebSocket()};o.prototype.connectWebSocket=function(){var a=this;a.ws=new WebSocket("wss://rtc.qiscus.com/signal");a.ws.onopen=function(){console.log("Socket connection established");e()};a.ws.onmessage=function(e){var t=JSON.parse(e.data);var r=JSON.parse(t.data);if(t.response=="register"){if(r.success){a.appSecret=r.token;if(a.clientStream==null){s()}else{if(a.initiator){c()}else{f()}}}else{a.onError(r.message)}}else if(t.response=="room_join"){if(r.success){var n=JSON.parse(r.message);n=n.users;for(var i=0;i<n.length;i++){if(n[i]!=a.clientId){a.roomFeeds[n[i]]={id:n[i],status:0,pc:null};if(a.autoAccept){u(n[i])}}}}else{a.onError(r.message)}}else{}if(t.event=="user_new"){a.roomFeeds[r.user]={id:r.user,status:0,pc:null}}else if(t.event=="user_leave"){setTimeout(function(){if(a.roomFeeds[r.user]){if(a.roomFeeds[r.user]!=null){p(r.user)}}},2e3)}else if(t.event=="room_data"){a.onMessage(t.sender,r)}else if(t.event=="room_data_private"){if(r.event=="call_sync"){}else if(r.event=="call_ack"){}else if(r.event=="call_accept"){l(t.sender,true)}if(r.type=="offer"){if(a.roomFeeds[t.sender]){l(t.sender,false);a.roomFeeds[t.sender].pc.signal(r)}else if(a.roomFeeds[t.sender].pc!=null){d(t.sender);l(t.sender,false);a.roomFeeds[t.sender].pc.signal(r)}else{a.roomFeeds[t.sender]={id:t.sender,status:0,pc:null};l(t.sender,false);a.roomFeeds[t.sender].pc.signal(r)}}else if(r.type=="answer"){a.roomFeeds[t.sender].pc.signal(r)}else if(r.candidate){if(r.type){delete r.type;var o={candidate:r}}else{var o=r}a.roomFeeds[t.sender].pc.signal(o)}}else{}};a.ws.onclose=function(){a.onError("Disconnected from server")};function s(){navigator.mediaDevices.getUserMedia({audio:true,video:a.audioOnly?false:a.selectedQuality}).then(function(e){a.clientStream=e;a.onLocalStream(e);if(a.initiator){c()}else{f()}}).catch(function(e){var t="";if(e.name=="OverconstrainedError"&&e.constraint){t="Camera resolution is not supported."}if(t){a.onError(t)}else{a.onError(e.name+": "+e.constraint)}})}function e(){var e={request:"register",data:JSON.stringify({username:a.clientId,app_id:a.appId,app_secret:a.appToken})};a.ws.send(JSON.stringify(e))}function c(){if(a.multiparty){var e=5}else{var e=2}var t={request:"room_create",room:a.room,data:JSON.stringify({token:a.appSecret,max_participant:e})};a.ws.send(JSON.stringify(t))}function f(){var e={request:"room_join",room:a.room,data:JSON.stringify({token:a.appSecret})};a.ws.send(JSON.stringify(e))}function u(e){var t={request:"room_data",room:a.room,recipient:e,data:JSON.stringify({event:"call_accept"})};a.ws.send(JSON.stringify(t))}function l(r,e){var t=new i({initiator:e,stream:a.clientStream,trickle:false,config:{iceServers:[{urls:"stun:139.59.110.14:3478"},{urls:"turn:139.59.110.14:3478",credential:"qiscuslova",username:"sangkil"}]}});a.roomFeeds[r].pc=t;a.roomFeeds[r].pc.on("signal",function(e){var t={request:"room_data",room:a.room,recipient:r,data:JSON.stringify(e)};a.ws.send(JSON.stringify(t))});a.roomFeeds[r].pc.on("stream",function(e){a.onRemoteStream(r,e)});a.roomFeeds[r].pc.on("close",function(){a.onPeerClosed(r);p(r)})}function d(e){if(a.roomFeeds[e].pc){a.roomFeeds[e].pc.destroy()}a.roomFeeds[e]=null}function p(e){if(a.roomFeeds[e]){if(a.roomFeeds[e]!=null){d(e);delete a.roomFeeds[e]}}}};o.prototype.startCall=function(e,t){var r=this;r.appId=e;r.appSecret=t};o.prototype.endCall=function(e){var t=this;if(e){for(var r=0;r<t.clientStream.getVideoTracks().length;r++){t.clientStream.getVideoTracks()[r].stop()}for(var r=0;r<t.clientStream.getAudioTracks().length;r++){t.clientStream.getAudioTracks()[r].stop()}t.clientStream=null}for(var n in t.roomFeeds){t.roomFeeds[n].pc.destroy();t.roomFeeds[n].pc=null}};o.prototype.muteMic=function(e){var t=this;for(var r=0;r<t.clientStream.getAudioTracks().length;r++){t.clientStream.getAudioTracks()[r].enabled=!e}};o.prototype.disableCamera=function(e){var t=this;for(var r=0;r<t.clientStream.getVideoTracks().length;r++){t.clientStream.getVideoTracks()[r].enabled=!e}};o.prototype.onMessage=function(e,t){};o.prototype.onLocalStream=function(e){};o.prototype.onRemoteStream=function(e,t){};o.prototype.onPeerConnected=function(e){};o.prototype.onPeerClosed=function(e){};o.prototype.onClosed=function(){};o.prototype.onError=function(e){}},{"simple-peer":55,"socket.io-client":56,"webrtc-adapter":68}]},{},[80])(80)});
